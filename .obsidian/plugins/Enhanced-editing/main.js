'use strict';

var obsidian = require('obsidian');

/* *****************************************************************************
ä½¿ç”¨å£°æ˜
ZHå¢å¼ºç¼–è¾‘æ’ä»¶å€Ÿé‰´å¤šæ¬¾ç¤¾åŒºæ’ä»¶å¼€å‘è€Œæˆï¼Œèš•å­æ°´å¹³æœ‰é™ï¼Œä»£ç æˆ–æœ‰ç¼ºé™·ï¼Œä¸èƒ½ä¿è¯ä»»ä½•æ“ä½œå‡ä¼šæ­£å¸¸ï¼Œè¯·åœ¨ä½¿ç”¨ä¹‹å‰å¤‡ä»½åº“ç¬”è®°ï¼Œè°¢è°¢é…åˆã€‚
å¼€å‘ï¼šèš•å­ QQï¼š312815311 æ›´æ–°æ—¶é—´ï¼š2022-5-17
***************************************************************************** */

var en = {
    loadThisPlugin: 'loading Enhanced Editing plugin',
    thisPluginName: 'ZH Enhanced Editing V',
    helloWorld: '<b>Welcome to the Enhanced Editing!</b>',
    qq: 'View <a href="https://github.com/obsidian-canzi/Enhanced-editing/releases">Github page</a>,Link <a href="http://wpa.qq.com/msgrd?v=3&uin=312815311&site=qq&menu=yes">CanZi (QQ:312815311)</a>',
    close: 'Click here to close the window !',
    FunctionUpdate: 'This Version adds a bilingual interface between Chinese and English, abolition of the "Smart line" function, the conversion of English and Chinese punctuation features optimized for the "Repair error Punctuation" ...',
    setInterTab: 'ğŸ“£ Insert tab [ Tab ]: Inserts the tab effect in the text line',
    whenEnabledTab: 'When enabled, pressing Tab in a line of text inserts four spaces instead of indenting the entire line.',
    convertInternalLink: 'ğŸ“£ Convert the internal link [ Alt + Z ]: Add or remove the [[]] symbol at both ends of the selection',
    SupportBatchConversion: 'Support batch conversion of multi-line text (separated by a newline character) or multiple text (separated by a dot sign).',
    ConvertSynonymousLink: 'Convert synonymous link [ Alt + Q ]: Convert selected text to [[|selectedText]] style before selecting document',
    setSmartPaste: 'ğŸ“£ Smart paste [ Ctrl + Alt + V ]: paste the copied content into MD syntax style',
    isPasteTableURL: 'Paste the table, URL, local path, or code directly into a MD table, hyperlink, or code block format, depending on the type of copied content.',
    setSmartSyntax: 'ğŸ“£ Smart syntax [ Alt + ; ]: Automatically convert, match, or skip various types of parenthesis or code block syntax',
    isYouCanCombine: 'You can combine [( (< ([ "[ \'[ to ã€–ã€ˆã€”ã€ã€Œ, or convert common program language names such as dv, qy, mm, CSS, js, ja, ty names (strings) to code block syntax.',
    ConvertCursorMove: 'ğŸ“£ Control the cursor movement with the key button [ Alt+I, +J, +K, +L ]',
    isConvertCursorMove: 'Press Alt+I up, +J up, +K Down, +L right, +U begin, +N end, Shortcut to control the movement of the cursor.',
    ConvertCursorJump: 'ğŸ“£ Control the cursor goto with the key button [ Alt+Shift +J, +L ]',
    isConvertCursorJump: 'Control the cursor to jump back and forth between the text lines such as title, list item, to-do item, code block and reference, or markdown syntax such as bold, highlight, comment, delete and link',
};

var zhCN = {
    loadThisPlugin: 'åŠ è½½å¢å¼ºç¼–è¾‘æ’ä»¶',
    thisPluginName: 'ZHå¢å¼ºç¼–è¾‘ V',
    helloWorld: '<b>æ¬¢è¿ä½¿ç”¨å¢å¼ºç¼–è¾‘æ’ä»¶ï¼</b>',
    qq: 'æŸ¥çœ‹ <a href="https://github.com/obsidian-canzi/Enhanced-editing/releases">Github é¡µé¢</a>ï¼Œè”ç³»<a href="http://wpa.qq.com/msgrd?v=3&uin=312815311&site=qq&menu=yes">èš•å­</a>',
    close: 'ç‚¹å‡»æ­¤å¤„ å¯å…³é—­æç¤ºçª—å£......',
    FunctionUpdate: 'å½“å‰ç‰ˆæœ¬\n- å¢åŠ ã€Œå·¦çª—å‘ä¸‹\ä¸Šæ»šåŠ¨ã€åŠŸèƒ½ \n- å¢åŠ ã€Œä¿®æ”¹å†…éƒ¨é“¾æ¥çš„æ˜¾ç¤ºåç§° åŠŸèƒ½  \n- å¢åŠ ã€ŒæŠ˜å æŒ‡å®šå±‚çº§æ ‡é¢˜ Shift+F*ã€åŠŸèƒ½  \n- å¢åŠ ã€Œè½¬æ¢æ ‡ç­¾ Alt+Shift+3ã€åŠŸèƒ½ \n- å¢åŠ ã€Œè·å–å½“å‰å­—ç¬¦æ•°ã€åŠŸèƒ½ \n- å¢åŠ ã€Œæ’å…¥æœ‰æ•ˆç©ºè¡Œã€åŠŸèƒ½ \n- å¢åŠ ã€Œç©ºæ ¼è½¬ä¸ºç©ºè¡Œã€åŠŸèƒ½ \n- çŠ¶æ€æ æ˜¾ç¤ºMarkdownåŠHtmlè¯­æ³•æ ¼å¼åˆ·  \n- çŠ¶æ€æ æ˜¾ç¤ºå®ç”¨åŠŸèƒ½èœå• \n- å¢åŠ ã€Œè·å–æœç´¢ç»“æœï¼ˆåˆ—è¡¨ï¼‰ã€åŠŸèƒ½ \n- å®Œå–„è¡Œå†…æ’å…¥åˆ¶è¡¨ç¬¦åŠŸèƒ½ \n- ä¿®å¤è¡Œé¦–ç¼©è¿›ä¸¤å­—ç¬¦åŠŸèƒ½ \n- ...',
    setInterTab: 'ğŸ“£ æ’å…¥åˆ¶è¡¨ç¬¦ã€ŒTabã€ åœ¨æ™®é€šæ–‡æœ¬è¡Œä¸­æ’å…¥åˆ¶è¡¨ç¬¦æ•ˆæœ',
    whenEnabledTab: 'å¯ç”¨æ­¤é¡¹åï¼Œåœ¨æ™®é€šæ–‡æœ¬è¡Œä¸­æŒ‰ä¸‹ Tab é”®ä¼šæ’å…¥4ä¸ªç©ºæ ¼ï¼Œä¸å†æ•´è¡Œç¼©è¿›ã€‚',
    convertInternalLink: 'ğŸ“£ è½¬æ¢å†…éƒ¨é“¾æ¥ã€ŒAlt+Zã€ï¼šåœ¨é€‰æ–‡ä¸¤ç«¯æ·»åŠ æˆ–å»é™¤ [[ ]] ç¬¦å·',
    SupportBatchConversion: 'æ”¯æŒæ‰¹é‡è½¬æ¢å¤šè¡Œæ–‡æœ¬ï¼ˆéœ€ç”¨æ¢è¡Œç¬¦åˆ†éš”ï¼‰æˆ–å¤šå¥æ–‡æœ¬ï¼ˆéœ€ç”¨é¡¿å·åˆ†éš”ï¼‰ã€‚',
    ConvertSynonymousLink: 'è½¬æ¢åŒä¹‰é“¾æ¥ã€ŒAlt+Qã€ï¼šå°†é€‰æ–‡è½¬æ¢ä¸º [[|é€‰æ–‡]] æ ·å¼åå†é€‰æ‹©æ–‡æ¡£',
    setSmartPaste: 'ğŸ“£ æ™ºèƒ½ç²˜è´´ã€ŒCtrl+Alt+Vã€âˆ¶å°†å¤åˆ¶çš„å†…å®¹ç²˜è´´ä¸ºMdè¯­æ³•æ ·å¼',
    isPasteTableURL: 'ä¾æ®å¤åˆ¶å†…å®¹çš„ç±»å‹ï¼Œå°†è¡¨æ ¼ã€ç½‘å€ã€æœ¬åœ°è·¯å¾„æˆ–ä»£ç ç›´æ¥ç²˜è´´ä¸ºMDè¡¨æ ¼ã€è¶…é“¾æ¥æˆ–ä»£ç å—æ ¼å¼ã€‚',
    setSmartSyntax: 'ğŸ“£ æ™ºèƒ½è¯­æ³•ã€ŒAlt+;ã€ï¼šè‡ªåŠ¨è½¬æ¢ã€åŒ¹é…æˆ–è·³è¿‡å„ç§ç±»å‹çš„æ‹¬å·æˆ–ä»£ç å—è¯­æ³•',
    isYouCanCombine: 'å¯å°†[( (< ([ "[ \'[ç­‰ç»„åˆè½¬ä¸ºã€–ã€ˆã€”ã€ã€Œï¼Œæˆ–å°†dvã€qyã€mmã€CSSã€jsã€jaã€tyç­‰ç¨‹åºè¯­è¨€åè½¬ä¸ºä»£ç å—ã€ç±»å‹è¯è¯­è½¬ä¸ºCalloutå¼•ç”¨è¯­æ³•ã€‚',
    ConvertCursorMove: 'ğŸ“£ é”®æ§å…‰æ ‡ç§»åŠ¨ã€ŒAlt+I, +J, +K, +Lã€',
    isConvertCursorMove: 'æŒ‰ä¸‹Alt +Iå‘ä¸Š +Jå‘å·¦ +Kå‘ä¸‹ +Lå‘å³ +Uæ–‡é¦– +Næ–‡æœ« å¿«æ·é”®ï¼Œæ§åˆ¶å…‰æ ‡ç§»åŠ¨ä½ç½®ã€‚',
    ConvertCursorJump: 'ğŸ“£ é”®æ§å…‰æ ‡è·³è½¬ã€ŒAlt+Shift +I, +Kã€',
    isConvertCursorJump: 'æ§åˆ¶å…‰æ ‡åœ¨æ ‡é¢˜ã€åˆ—è¡¨é¡¹ã€å¾…åŠäº‹é¡¹ã€ä»£ç å—å’Œå¼•ç”¨ç­‰æ–‡æœ¬è¡Œä¹‹é—´æ¥å›è·³è½¬ï¼Œæˆ–åœ¨ç²—ä½“ã€çªå‡ºæ˜¾ç¤ºã€æ³¨é‡Šã€åˆ é™¤å’Œé“¾æ¥ç­‰Markdownè¯­æ³•ä¹‹é—´æ¥å›è·³è½¬',
};

const ä¸Šæ ‡å›¾æ ‡ ='<svg xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path fill="currentColor"d="M16 7.41L11.41 12L16 16.59L14.59 18L10 13.41L5.41 18L4 16.59L8.59 12L4 7.41L5.41 6L10 10.59L14.59 6L16 7.41M21.85 9h-4.88V8l.89-.82c.76-.64 1.32-1.18 1.7-1.63c.37-.44.56-.85.57-1.23a.884.884 0 0 0-.27-.7c-.18-.19-.47-.28-.86-.29c-.31.01-.58.07-.84.17l-.66.39l-.45-1.17c.27-.22.59-.39.98-.53S18.85 2 19.32 2c.78 0 1.38.2 1.78.61c.4.39.62.93.62 1.57c-.01.56-.19 1.08-.54 1.55c-.34.48-.76.93-1.27 1.36l-.64.52v.02h2.58V9z"/></svg>';
const ä¸‹æ ‡å›¾æ ‡ = '<svg xmlns="http://www.w3.org/2000/svg" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path fill="currentColor" d="M16 7.41L11.41 12L16 16.59L14.59 18L10 13.41L5.41 18L4 16.59L8.59 12L4 7.41L5.41 6L10 10.59L14.59 6L16 7.41m5.85 13.62h-4.88v-1l.89-.8c.76-.65 1.32-1.19 1.7-1.63c.37-.44.56-.85.57-1.24a.898.898 0 0 0-.27-.7c-.18-.16-.47-.28-.86-.28c-.31 0-.58.06-.84.18l-.66.38l-.45-1.17c.27-.21.59-.39.98-.53s.82-.24 1.29-.24c.78.04 1.38.25 1.78.66c.4.41.62.93.62 1.57c-.01.56-.19 1.08-.54 1.55c-.34.47-.76.92-1.27 1.36l-.64.52v.02h2.58v1.35z"/></svg>';
const æ ¼å¼åˆ·å›¾æ ‡ ='<svg t="1650117667147" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12959" width="120" height="120"><path d="M409.856 331.9296l103.1936-103.168 307.712 307.712-103.168 103.168z" fill="#777677" p-id="12960"></path><path d="M384 358.4s-153.6 128-256 99.84c23.04 38.4 53.76 76.8 51.2 79.36 79.36 17.92 204.8-51.2 204.8-51.2l25.6 25.6s-133.12 102.4-204.8 76.8c66.56 99.84 212.48 225.28 256 256 97.28 0 230.4-179.2 230.4-179.2L384 358.4z" fill="#FCAF6D" p-id="12961"></path><path d="M641.3568 306.9952l153.856-153.856 103.1936 103.168-153.856 153.856z" fill="#777677" p-id="12962"></path></svg>';
const mdè¯­æ³•å›¾æ ‡ = '<svg t="1650122437266" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5178" width="120" height="120"><path d="M96 672v-341.333333h85.333333l128 128 128-128h85.333334v341.333333h-85.333334v-220.586667l-128 128-128-128v220.586667h-85.333333m597.333333-341.333333h128v170.666666h106.666667l-170.666667 192-170.666666-192h106.666666z" fill="#42A5F5" p-id="5179"></path></svg>';
const æ™®é€šæ ¼å¼åˆ· ='<svg t="1650117667147" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12959" width="120" height="120"><path d="M409.856 331.9296l103.1936-103.168 307.712 307.712-103.168 103.168z" fill="#777677" p-id="12960"></path><path d="M384 358.4s-153.6 128-256 99.84c23.04 38.4 53.76 76.8 51.2 79.36 79.36 17.92 204.8-51.2 204.8-51.2l25.6 25.6s-133.12 102.4-204.8 76.8c66.56 99.84 212.48 225.28 256 256 97.28 0 230.4-179.2 230.4-179.2L384 358.4z" fill="#777677" p-id="12961"></path><path d="M641.3568 306.9952l153.856-153.856 103.1936 103.168-153.856 153.856z" fill="#777677" p-id="12962"></path></svg>';
const å…¨å±€å‘½ä»¤å›¾æ ‡ = '<svg t="1650192738325" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="70946" width="110" height="110"><path d="M129.9 755.5625c-34.025 0-64.5 28.625-64.5 62.6875 0 34.0625 30.4625 64.5 64.5 64.5 34 0 62.6875-30.4375 62.6875-64.5C192.5875 784.1875 163.9 755.5625 129.9 755.5625zM129.9 447.4c-34.025 0-64.5 28.65-64.5 62.6875s30.4625 62.8125 64.5 62.8125c34 0 62.6875-28.775 62.6875-62.8125S163.9 447.4 129.9 447.4zM359.1875 259.3375 901.875 259.3375c32.25 0 59.125-25.0875 59.125-57.3125 0-32.25-26.875-59.125-59.125-59.125L359.1875 142.9c-32.275 0-59.125 26.875-59.125 59.125C300.0625 234.25 326.9 259.3375 359.1875 259.3375zM129.9 137.525c-34.025 0-64.5 30.4625-64.5 64.5 0 34 30.4625 62.6875 64.5 62.6875 34 0 62.6875-28.6875 62.6875-62.6875C192.5875 168 163.9 137.525 129.9 137.525zM901.875 451 359.1875 451c-32.275 0-59.125 26.8375-59.125 59.0875s26.8375 59.15 59.125 59.15L901.875 569.2375c32.25 0 59.125-26.9 59.125-59.15S934.125 451 901.875 451zM901.875 759.125 359.1875 759.125c-32.275 0-59.125 26.875-59.125 59.125 0 32.25 26.8375 59.125 59.125 59.125L901.875 877.375c32.25 0 59.125-26.875 59.125-59.125C961 786 934.125 759.125 901.875 759.125z" fill="#1290f8" p-id="70947"></path></svg>';


// Code from https://github.com/valentine195/obsidian-admonition/blob/master/src/lang/helpers.ts
const localeMap = {
    en,
    'zh-cn': zhCN,
};
const locale = localeMap[obsidian.moment.locale()];
function t(_str) {
    return (locale && locale[_str]) || en[_str];
};

//t('å­—æ®µåç§°')
//ä»¥ä¸Šä¸º å¤šè¯­è¨€å­—æ®µå-è°ƒç”¨è¯­æ³•

const DEFAULT_SETTINGS = {
    isTab: false,
    isBT: false,
    isShowNum: false,
    //maxTry:600,
    maxScroll:50,
    version: "0.4.5",
    hColor: "",
    bColor: "",
    hColor1: "#F36208",
    hColor2: "#81B300",
    hColor3: "#2485E3",
    hColor4: "#C32E94",
    hColor5: "#13C6C3",

    bColor1: "#FFB78B",
    bColor2: "#CDF469",
    bColor3: "#A0CCF6",
    bColor4: "#F0A7D8",
    bColor5: "#ADEFEF"
};

var å½“å‰ç‰ˆæœ¬ = '0.5.4';
var åŠŸèƒ½æ›´æ–° = t('FunctionUpdate');
var ç®€ä½“å­—è¡¨ = "çš‘è”¼ç¢çˆ±è‚®ç¿±è¢„å¥¥åç½¢æ‘†è´¥é¢åŠç»Šå¸®ç»‘é•‘è°¤å‰¥é¥±å®æŠ¥é²è¾ˆè´é’¡ç‹ˆå¤‡æƒ«ç»·ç¬”æ¯•æ¯™å¸é—­è¾¹ç¼–è´¬å˜è¾©è¾«æ ‡é³–åˆ«ç˜ªæ¿’æ»¨å®¾æ‘ˆé¥¼å¹¶æ‹¨é’µé“‚é©³åœè¡¥è´¢å‚èš•æ®‹æƒ­æƒ¨ç¿è‹èˆ±ä»“æ²§å•ä¾§å†Œæµ‹å±‚è¯§æ€æºè‰é¦‹è°—ç¼ é“²äº§é˜é¢¤åœºå°é•¿å¿è‚ å‚ç•…é’è½¦å½»å°˜æ²‰é™ˆè¡¬æ’‘ç§°æƒ©è¯šéª‹ç—´è¿Ÿé©°è€»é½¿ç‚½å†²è™«å® ç•´è¸Œç­¹ç»¸ä¸‘æ©±å¨é”„é›ç¡€å‚¨è§¦å¤„ä¼ ç–®é—¯åˆ›é”¤çº¯ç»°è¾è¯èµèªè‘±å›±ä»ä¸›å‡‘è¹¿çªœé”™è¾¾å¸¦è´·æ‹…å•éƒ¸æ¸èƒ†æƒ®è¯å¼¹å½“æŒ¡å…šè¡æ¡£æ£å²›ç¥·å¯¼ç›—ç¯é‚“æ•Œæ¶¤é€’ç¼”é¢ ç‚¹å«ç”µæ·€å‡‹é’“è°ƒè¿­è°å é’‰é¡¶é”­è®¢ä¸¢ä¸œåŠ¨æ ‹å†»æ–—çŠŠç‹¬è¯»èµŒé•€é”»æ–­ç¼å…‘é˜Ÿå¯¹å¨é¡¿é’å¤ºå •é¹…é¢è®¹æ¶é¥¿å„¿å°”é¥µè´°å‘ç½šé˜€ççŸ¾é’’çƒ¦èŒƒè´©é¥­è®¿çººé£è¯½åºŸè´¹çº·åŸå¥‹æ„¤ç²ªä¸°æ«é”‹é£ç–¯å†¯ç¼è®½å‡¤è‚¤è¾æŠšè¾…èµ‹å¤è´Ÿè®£å¦‡ç¼šè¯¥é’™ç›–å¹²æ†èµ¶ç§†èµ£å†ˆåˆšé’¢çº²å²—çš‹é•æé¸½é˜é“¬ä¸ªç»™é¾šå®«å·©è´¡é’©æ²Ÿè‹Ÿæ„è´­å¤Ÿè›Šé¡¾å‰æŒ‚å…³è§‚é¦†æƒ¯è´¯å¹¿è§„ç¡…å½’é¾Ÿé—ºè½¨è¯¡æŸœè´µåˆ½è¾Šæ»šé”…å›½è¿‡éª‡éŸ©æ±‰å·é˜‚é¹¤è´ºæ¨ªè½°é¸¿çº¢åå£¶æŠ¤æ²ªæˆ·å“—åç”»åˆ’è¯æ€€åæ¬¢ç¯è¿˜ç¼“æ¢å”¤ç—ªç„•æ¶£é»„è°æŒ¥è¾‰æ¯è´¿ç§½ä¼šçƒ©æ±‡è®³è¯²ç»˜è¤æµ‘ä¼™è·è´§ç¥¸å‡»æœºç§¯é¥¥è¿¹è®¥é¸¡ç»©ç¼‰æè¾‘çº§æŒ¤å‡ è“Ÿå‰‚æµè®¡è®°é™…ç»§çºªå¤¹èšé¢Šè´¾é’¾ä»·é©¾æ­¼ç›‘åšç¬ºé—´è‰°ç¼„èŒ§æ£€ç¢±ç¡·æ‹£æ¡ç®€ä¿­å‡èæ§›é‰´è·µè´±è§é”®èˆ°å‰‘é¥¯æ¸æº…æ¶§å°†æµ†è’‹æ¡¨å¥–è®²é…±èƒ¶æµ‡éª„å¨‡æ…é“°çŸ«ä¾¥è„šé¥ºç¼´ç»è½¿è¾ƒç§¸é˜¶èŠ‚èŒé²¸æƒŠç»é¢ˆé™é•œå¾„ç—‰ç«å‡€çº å©æ—§é©¹ä¸¾æ®é”¯æƒ§å‰§é¹ƒç»¢æ°æ´ç»“è¯«å±Šç´§é”¦ä»…è°¨è¿›æ™‹çƒ¬å°½åŠ²è†è§‰å†³è¯€ç»é’§å†›éªå¼€å‡¯é¢—å£³è¯¾å¦æ³æŠ åº“è£¤å¤¸å—ä¾©å®½çŸ¿æ—·å†µäºå²¿çª¥é¦ˆæºƒæ‰©é˜”èœ¡è…Šè±æ¥èµ–è“æ æ‹¦ç¯®é˜‘å…°æ¾œè°°æ½è§ˆæ‡’ç¼†çƒ‚æ»¥ç…æåŠ³æ¶ä¹é•­å’ç±»æ³ªç¯±ç‹¸ç¦»é‡Œé²¤ç¤¼ä¸½å‰åŠ±ç ¾å†æ²¥éš¶ä¿©è”è²è¿é•°æ€œæ¶Ÿå¸˜æ•›è„¸é“¾æ‹ç‚¼ç»ƒç²®å‡‰ä¸¤è¾†è°…ç–—è¾½é•£çŒä¸´é‚»é³å‡›èµé¾„é“ƒå‡Œçµå²­é¢†é¦åˆ˜é¾™è‹å’™ç¬¼å„æ‹¢é™‡æ¥¼å¨„æ‚ç¯“èŠ¦å¢é¢…åºç‚‰æ³å¤è™é²èµ‚ç¦„å½•é™†é©´å•é“ä¾£å±¡ç¼•è™‘æ»¤ç»¿å³¦æŒ›å­ªæ»¦ä¹±æŠ¡è½®ä¼¦ä»‘æ²¦çº¶è®ºèç½—é€»é”£ç®©éª¡éª†ç»œå¦ˆç›ç èš‚é©¬éª‚å—ä¹°éº¦å–è¿ˆè„‰ç’é¦’è›®æ»¡è°©çŒ«é”šé“†è´¸ä¹ˆéœ‰æ²¡é•é—¨é—·ä»¬é”°æ¢¦çœ¯è°œå¼¥è§…å¹‚ç»µç¼…åº™ç­æ‚¯é—½é¸£é“­è°¬è°‹äº©å‘é’ çº³éš¾æŒ è„‘æ¼é—¹é¦å†…æ‹Ÿä½ è…»æ’µæ»é…¿é¸Ÿè‚å•®é•Šé•æŸ ç‹å®æ‹§æ³é’®çº½è„“æµ“å†œç–Ÿè¯ºæ¬§é¸¥æ®´å‘•æ²¤ç›˜åºæŠ›èµ”å–·é¹éª—é£˜é¢‘è´«è‹¹å‡­è¯„æ³¼é¢‡æ‰‘é“ºæœ´è°±æ –å‡„è„é½éª‘å²‚å¯æ°”å¼ƒè®«ç‰µæ‰¦é’é“…è¿ç­¾è°¦é’±é’³æ½œæµ…è°´å ‘æªå‘›å¢™è”·å¼ºæŠ¢é”¹æ¡¥ä¹”ä¾¨ç¿˜çªçªƒé’¦äº²å¯è½»æ°¢å€¾é¡·è¯·åº†ç¼ç©·è¶‹åŒºèº¯é©±é¾‹é¢§æƒåŠå´é¹Šç¡®è®©é¥¶æ‰°ç»•çƒ­éŸ§è®¤çº«è£ç»’è½¯é”é—°æ¶¦æ´’è¨é³ƒèµ›åä¼ä¸§éªšæ‰«æ¶©æ€åˆ¹çº±ç­›æ™’åˆ é—ªé™•èµ¡ç¼®å¢’ä¼¤èµçƒ§ç»èµŠæ‘„æ…‘è®¾ç»…å®¡å©¶è‚¾æ¸—å£°ç»³èƒœåœ£å¸ˆç‹®æ¹¿è¯—å°¸æ—¶èš€å®è¯†é©¶åŠ¿é€‚é‡Šé¥°è§†è¯•å¯¿å…½æ¢è¾“ä¹¦èµå±æœ¯æ ‘ç«–æ•°å¸…åŒè°ç¨é¡ºè¯´ç¡•çƒä¸é¥²è€¸æ€‚é¢‚è®¼è¯µæ“è‹è¯‰è‚ƒè™½éšç»¥å²å­™æŸç¬‹ç¼©çé”ç­æŒæŠ¬å°æ€æ‘Šè´ªç˜«æ»©å›è°­è°ˆå¹æ±¤çƒ«æ¶›ç»¦è®¨è…¾èªŠé”‘é¢˜ä½“å±‰æ¡è´´é“å…å¬çƒƒé“œç»Ÿå¤´ç§ƒå›¾æ¶‚å›¢é¢“èœ•è„±é¸µé©®é©¼æ¤­æ´¼è¢œå¼¯æ¹¾é¡½ä¸‡ç½‘éŸ¦è¿å›´ä¸ºæ½ç»´è‹‡ä¼Ÿä¼ªçº¬å–‚è°“å«æ¸©é—»çº¹ç¨³é—®ç“®æŒèœ—æ¶¡çªå§å‘œé’¨ä¹Œæ±¡è¯¬æ— èŠœå´åé›¾åŠ¡è¯¯é”¡ç‰ºè¢­ä¹ é“£æˆç»†è™¾è¾–å³¡ä¾ ç‹­å¦å“é”¨é²œçº¤å’¸è´¤è¡”é—²æ˜¾é™©ç°çŒ®å¿é¦…ç¾¡å®ªçº¿å¢é•¶ä¹¡è¯¦å“é¡¹è§åš£é”€æ™“å•¸èåæŒŸæºèƒè°å†™æ³»è°¢é”Œè¡…å…´å‡¶æ±¹é”ˆç»£è™šå˜˜é¡»è®¸å™ç»ªç»­è½©æ‚¬é€‰ç™£ç»šå­¦å‹‹è¯¢å¯»é©¯è®­è®¯é€Šå‹é¸¦é¸­å“‘äºšè®¶é˜‰çƒŸç›ä¸¥å²©é¢œé˜è‰³åŒç šå½¦è°šéªŒé¸¯æ¨æ‰¬ç–¡é˜³ç—’å…»æ ·ç‘¶æ‘‡å°§é¥çª‘è°£è¯çˆ·é¡µä¸šå¶ä¸€åŒ»é“±é¢é—ä»ªå½èšè‰ºäº¿å¿†ä¹‰è¯£è®®è°Šè¯‘å¼‚ç»è«é˜´é“¶é¥®éšæ¨±å©´é¹°åº”ç¼¨è¹è¤è¥è§è‡èµ¢é¢–å“Ÿæ‹¥ä½£ç—ˆè¸Šå’æ¶Œä¼˜å¿§é‚®é“€çŠ¹æ¸¸è¯±äºèˆ†é±¼æ¸”å¨±ä¸å±¿è¯­åå¾¡ç‹±èª‰é¢„é©­é¸³æ¸Šè¾•å›­å‘˜åœ†ç¼˜è¿œæ„¿çº¦è·ƒé’¥å²³ç²¤æ‚¦é˜…äº‘éƒ§åŒ€é™¨è¿è•´é…æ™•éŸµæ‚ç¾è½½æ”’æš‚èµèµƒè„å‡¿æ£ç¶è´£æ‹©åˆ™æ³½è´¼èµ æ‰æœ­è½§é“¡é—¸æ …è¯ˆæ–‹å€ºæ¯¡ç›æ–©è¾—å´­æ ˆæˆ˜ç»½å¼ æ¶¨å¸è´¦èƒ€èµµè›°è¾™é”—è¿™è´é’ˆä¾¦è¯Šé•‡é˜µæŒ£çç‹°äº‰å¸§ç—‡éƒ‘è¯ç»‡èŒæ‰§çº¸å¿—æŒšæ·å¸œè´¨æ»é’Ÿç»ˆç§è‚¿ä¼—è¯Œè½´çš±æ˜¼éª¤çŒªè¯¸è¯›çƒ›ç©å˜±è´®é“¸ç­‘æ³¨é©»ä¸“ç –è½¬èµšæ¡©åº„è£…å¦†å£®çŠ¶é”¥èµ˜å ç¼€è°†å‡†ç€æµŠå…¹èµ„æ¸è¸ªç»¼æ€»çºµé‚¹è¯…ç»„é’»é”•å—³å«’ç‘·æš§éœ­è°™é“µé¹Œåªªéªœé³Œé’¯å‘—é’£é¸¨é¾…é¹è´²é”›èœå“”æ»—é“‹ç­šè·¸è‹„ç¼ç¬¾éª é£‘é£™é•–é•³é³”å‚§ç¼¤æ§Ÿæ®¡è†‘é•”é«Œé¬“ç¦€é¥½é’¹é¹é’¸éª–é»ªæ»é”¸ä¾ªé’—å†è°„è°¶è’‡å¿å©µéª£è§‡ç¦…é•¡ä¼¥è‹Œæ€…é˜Šé²³ç —ä¼§è°Œæ¦‡ç¢œé¾€æ¨æŸ½é“–é“›é¥¬é¸±é“³ä¿¦å¸±é› åˆç»Œè¹°é’æ€†ç¼é¹‘è¾é¾Šé¹šè‹éª¢æè¾æ’ºé”‰é¹¾å“’é‘éª€ç»æ®šèµ•ç˜…ç®ªè° ç €è£†ç„˜é•«ç±´è¯‹è°›ç»¨è§Œé•å·…é’¿ç™«é“«é²·é²½é“¤é“¥å²½é¸«çª¦æ¸æ¤Ÿç‰ç¬ƒé»©ç°–æ€¼é•¦ç‚–è¶¸é“è°”å©é˜è½­é”‡é”·é¹—é¢šé¢›é³„è¯¶è¿©é“’é¸¸é²•é’«é²‚ç»¯é•„é²±å¾æ²£å‡«é©¸ç»‚ç»‹èµ™éº¸é²‹é³†é’†èµ…å°´æ“€ç»€æˆ†ç¾è¯°ç¼Ÿé”†çº¥é•‰é¢äº˜èµ“ç» é² è¯Ÿç¼‘è§è¯‚æ¯‚é’´é”¢é¸ªé¹„é¹˜é¸¹æ´è¯–æ¼é¹³é³çŠ·åŒ¦åˆ¿å¦«æ¡§é²‘é³œè¡®ç»²é²§åŸšå‘™å¸¼æ¤èˆé“ªé˜šç»—é¢‰çé¢¢è¯ƒé˜–è›é»‰è®§è­é—³é²æµ’é¹•éª…æ¡¦é“§å¥‚ç¼³é”¾é²©é³‡è¯™èŸå“•æµç¼‹ç²æ™–è¯¨é¦„é˜é’¬é•¬è®¦è¯˜è å½å“œéª¥ç‘è§Šé½‘çŸ¶ç¾è™¿è·»éœé²šé²«éƒæµƒé“—é•“è›²è°ç¼£æˆ‹æˆ¬ç‘é¹£ç¬•é²£é¯ç»›ç¼°æŒ¢å³¤é¹ªé²›ç––é¢Œé²’åºè©é¦‘ç¼™èµ†è§åˆ­æ³¾è¿³å¼ªèƒ«é“é˜„é¸ é¹«è®µå±¦æ¦‰é£“é’œé””çª­é¾ƒé”©é•Œéš½è°²ççš²å‰€å²å¿¾æºé“ é”´é¾›é—¶é’ªé“éª’ç¼‚è½²é’¶é”é¢”é¾ˆé“¿å–¾éƒå“™è„ç‹¯é«‹è¯“è¯³é‚åœ¹çº©è´¶åŒ®è’‰æ„¦è©ç¯‘é˜ƒé”Ÿé²²è›´å´ƒå¾•æ¶æ¿‘èµ‰çé“¼ç™ç±å²šæ¦„æ–“é•§è¤´é˜†é”’å” å´‚é“‘é“¹ç—¨é³“è¯”ç¼§ä¿ªéƒ¦åœè‹ˆè…è“ å‘–é€¦éªŠç¼¡æ¥æ è½¹ç ºé”‚é¹‚ç– ç²è·é›³é²¡é³¢è”¹å¥æ½‹çæ®“è£¢è££é²¢é­‰ç¼­é’Œé¹©è”ºå»ªæª©è¾šèºç»«æ£‚è›é²®æµéªç»ºé•é¹¨èŒæ³·ç‘æ Šèƒ§ç »å»è’Œå–½åµé•‚ç˜˜è€§è¼é«…å†æ’¸å™œé—¾æ³¸æ¸Œæ Œæ©¹è½³è¾‚è¾˜æ°‡èƒªé¸¬é¹­èˆ»é²ˆè„”å¨ˆæ ¾é¸¾éŠ®å›µè¦çŒ¡æ³ºæ¤¤è„¶é•™æ¦ˆè¤›é”Šå‘’å”›å¬·æ©åŠ¢ç¼¦é•˜é¢¡é³—éº½æ‰ªç„–æ‡‘é’”èŠˆè°§çŒ•ç¥¢æ¸‘è…¼é»¾ç¼ˆç¼ªé—µç¼—è°Ÿè“¦é¦æ®é•†é’¼é“™è®·é“Œé²µè¾‡é²¶èŒ‘è¢…é™§è˜–å—«é¢Ÿè¹‘è‹å’›èä¾¬å“é©½é’•å‚©è®´æ€„ç“¯è¹’ç–±è¾”çº°ç½´é“è°éªˆç¼¥å«”é’‹é•¤é•¨è•²éªç»®æ¡¤ç¢›é¢€é¢ƒé³ä½¥è¨æ‚­éªç¼±æ¤ é’¤å«±æ¨¯æˆ—ç‚é”–é”µé•ªç¾Ÿè·„è¯®è°¯èç¼²ç¡—è··æƒ¬é”²ç®§é”“æ¿é²­èŒ•è›±å·¯èµ‡è™®é³…è¯å²–é˜’è§‘é¸²è¯ ç»»è¾é“¨é˜•é˜™æ‚«è›å¨†æ¡¡é¥ªè½«åµ˜è¾ç¼›é“·é¢¦èš¬é£’æ¯µç³ç¼«å•¬é“¯ç©‘é“©é²¨é…¾è®ªå§—éªŸé’é³å§æ®‡è§åæ» ç•²è¯œè°‚æ¸–è°¥åŸ˜è³å¼‘è½¼è´³é“ˆé²¥ç»¶æ‘…çº¾é—©é“„å®é©·ç¼Œé”¶é¸¶è–®é¦Šé£•é”¼è°¡ç¨£è°‡èªç‹²å”¢çƒé—¼é“Šé³é’›é²æ˜™é’½é”¬é¡¸å‚¥é¥§é“´é•—éŸ¬é“½ç¼‡é¹ˆé˜—ç²œé¾†é²¦æ¸é’­é’æŠŸé¥¨ç®¨é¼å¨²è…½çº¨ç»¾è¾‹è¯¿å¸é—±æ²©æ¶ ç®éŸªç‚œé²”é˜Œè´é¾Œé‚¬åº‘æ€ƒå¦©éª›é¹‰é¹œé¥©é˜‹çºè§‹ç¡–è‹‹è¶è—“å²˜çŒƒå¨´é¹‡ç—«èšç±¼è·¹èŠ—é¥·éª§ç¼ƒé£¨å““æ½‡éªç»¡æ­ç®«äºµæ’·ç»ç¼¬é™‰è¥é¦é¸ºè¯©é¡¼è°–é“‰é•Ÿè°‘æ³¶é³•åŸ™æµ”é²Ÿå­å¨…æ¡ æ°©å£èµä¿¨å…–è°³æ¹é—«é…½é­‡é¤é¼¹ç‚€è½ºé¹é³é¥è°’é‚ºæ™”çƒ¨è¯’å‘“å³„é¥´æ€¿é©¿ç¼¢è½¶è´»é’‡é•’é•±ç˜—èˆ£é“Ÿç˜¾èŒ”èºè¦è“¥æ’„å˜¤æ»¢æ½†ç’é¹¦ç˜¿é¢ç½‚é•›è¸é“•é±¿ä¼›ä¿£è°€è°•è“£åµ›é¥«é˜ˆå¦ªçº¡è§æ¬¤é’°é¹†é¹¬é¾‰æ©¼é¸¢é¼‹é’ºéƒ“èŠ¸æ½æ„ çº­éŸ«æ®’æ°²ç“’è¶±éŒ¾é©µèµœå•§å¸»ç®¦è°®ç¼¯è°µè¯é’Šè°ªè¾„é¹§æµˆç¼œæ¡¢è½¸èµˆç¥¯é¸©è¯¤å³¥é’²é“®ç­éª˜æ ‰æ €è½µè½¾è´½é¸·è›³çµ·è¸¬è¸¯è§¯é”ºçº£ç»‰ä¼«æ§ é“¢å•­é¦”é¢éª“ç¼’è¯¼é•¯è°˜ç¼è¾èµ€çœ¦é”±é¾‡é²»å¬è¯¹é©ºé²°é•ç¼µèºœé³Ÿè® è°«éƒ„å‹å‡¼å‚å…å´åŸ¯åŸè‹˜è¬è®èœè¼è°è—æ¸å’å£å’”å’å’´å™˜å™¼åš¯å¹å²™åµ´å½·å¾¼çŠ¸ç‹é¦€é¦‡é¦“é¦•æ„£æ†·æ‡”ä¸¬æº†æ»Ÿæº·æ¼¤æ½´æ¾¹ç”¯çºŸç»”ç»±ç‰æ§æ¡Šæ¡‰æ§”æ©¥è½±è½·èµè‚·èƒ¨é£šç…³ç……ç†˜æ„æ·¼ç œç£™çœé’šé’·é“˜é“é”ƒé”é”é”é”˜é”é”ªé”«é”¿é•…é•é•¢é•¥é•©é•²ç¨†é¹‹é¹›é¹±ç–¬ç–´ç—–ç™¯è£¥è¥è€¢é¢¥è¨éº´é²…é²†é²‡é²é²´é²ºé²¼é³Šé³‹é³˜é³™é’é´é½„";
var ç¹ä½“å­—è¡¨ = "çššè—¹ç¤™æ„›éª¯ç¿ºè¥–å¥§å£©ç½·æ“ºæ•—é ’è¾¦çµ†å¹«ç¶éŠè¬—å‰é£½å¯¶å ±é®‘è¼©è²é‹‡ç‹½å‚™æ†Šç¹ƒç­†ç•¢æ–ƒå¹£é–‰é‚Šç·¨è²¶è®Šè¾¯è¾®æ¨™é±‰åˆ¥ç™Ÿç€•æ¿±è³“æ“¯é¤…ä¸¦æ’¥ç¼½é‰‘é§è””è£œè²¡åƒè ¶æ®˜æ…šæ…˜ç‡¦è’¼è‰™å€‰æ»„å»å´å†Šæ¸¬å±¤è©«æ”™æ‘»èŸ¬é¥è®’çºéŸç”¢é—¡é¡«å ´å˜—é•·å„Ÿè…¸å» æš¢éˆ”è»Šå¾¹å¡µæ²ˆé™³è¥¯æ’ç¨±æ‡²èª é¨ç™¡é²é¦³æ¥é½’ç†¾æ²–èŸ²å¯µç–‡èºŠç±Œç¶¢é†œæ«¥å»šé‹¤é››ç¤å„²è§¸è™•å‚³ç˜¡é—–å‰µéŒ˜ç´”ç¶½è¾­è©è³œè°è”¥å›ªå¾å¢æ¹Šèº¥ç«„éŒ¯é”å¸¶è²¸æ“”å–®é„²æ’£è†½æ†šèª•å½ˆç•¶æ“‹é»¨è•©æª”æ—å³¶ç¦±å°ç›œç‡ˆé„§æ•µæ»Œéç· é¡›é»å¢Šé›»æ¾±é›•é‡£èª¿å è«œç–Šé‡˜é ‚éŒ è¨‚ä¸Ÿæ±å‹•æ£Ÿå‡é¬¥çŠ¢ç¨è®€è³­éé›æ–·ç·å…ŒéšŠå°å™¸é “éˆå¥ªå¢®éµé¡è¨›æƒ¡é¤“å…’çˆ¾é¤Œè²³ç™¼ç½°é–¥çºç¤¬é‡©ç…©ç¯„è²©é£¯è¨ªç´¡é£›èª¹å»¢è²»ç´›å¢³å¥®æ†¤ç³è±æ¥“é‹’é¢¨ç˜‹é¦®ç¸«è«·é³³è†šè¼»æ’«è¼”è³¦å¾©è² è¨ƒå©¦ç¸›è©²éˆ£è“‹å¹¹æ¡¿è¶•ç¨ˆè´›å²¡å‰›é‹¼ç¶±å´—è‡¯é¬æ“±é´¿é–£é‰»å€‹çµ¦é¾”å®®éè²¢é‰¤æºèŒæ§‹è³¼å¤ è ±é¡§å‰®æ›é—œè§€é¤¨æ…£è²«å»£è¦çŸ½æ­¸é¾œé–¨è»Œè©­æ«ƒè²´åŠŠè¼¥æ»¾é‹åœ‹éé§­éŸ“æ¼¢è™Ÿé–¡é¶´è³€æ©«è½Ÿé´»ç´…å¾Œå£ºè­·æ»¬æˆ¶å˜©è¯ç•«åŠƒè©±æ‡·å£æ­¡ç’°é‚„ç·©æ›å–šç˜“ç…¥æ¸™é»ƒè¬Šæ®è¼æ¯€è³„ç©¢æœƒç‡´åŒ¯è«±èª¨ç¹ªè‘·æ¸¾å¤¥ç²è²¨ç¦æ“Šæ©Ÿç©é¥‘è·¡è­é›ç¸¾ç·æ¥µè¼¯ç´šæ“ å¹¾è–ŠåŠ‘æ¿Ÿè¨ˆè¨˜éš›ç¹¼ç´€å¤¾è¢é °è³ˆé‰€åƒ¹é§•æ®²ç›£å …ç®‹é–“è‰±ç·˜ç¹­æª¢å ¿é¹¼æ€æ’¿ç°¡å„‰æ¸›è–¦æª»é‘’è¸è³¤è¦‹éµè‰¦åŠé¤æ¼¸æ¿ºæ¾—å°‡æ¼¿è”£æ§³çè¬›é†¬è† æ¾†é©•å¬Œæ”ªé‰¸çŸ¯åƒ¥è…³é¤ƒç¹³çµè½è¼ƒç¨­éšç¯€è–é¯¨é©šç¶“é ¸éœé¡å¾‘ç—™ç«¶å‡ˆç³¾å»„èˆŠé§’èˆ‰æ“šé‹¸æ‡¼åŠ‡éµ‘çµ¹å‚‘æ½”çµèª¡å±†ç·ŠéŒ¦åƒ…è¬¹é€²æ™‰ç‡¼ç›¡å‹èŠè¦ºæ±ºè¨£çµ•éˆè»é§¿é–‹å‡±é¡†æ®¼èª²å¢¾æ‡‡æ‘³åº«è¤²èª‡å¡Šå„ˆå¯¬ç¤¦æ› æ³è™§å·‹çªºé¥‹æ½°æ“´é—Šè Ÿè‡˜èŠä¾†è³´è—æ¬„æ””ç±ƒé—Œè˜­ç€¾è®•æ”¬è¦½æ‡¶çºœçˆ›æ¿«ç‘¯æ’ˆå‹æ¾‡æ¨‚é³å£˜é¡æ·šç±¬è²é›¢è£é¯‰ç¦®éº—å²å‹µç¤«æ­·ç€éš¸å€†è¯è“®é€£é®æ†æ¼£ç°¾æ–‚è‡‰éˆæˆ€ç…‰ç·´ç³§æ¶¼å…©è¼›è«’ç™‚é¼éçµè‡¨é„°é±—å‡œè³ƒé½¡éˆ´æ·©éˆå¶ºé ˜é¤¾åŠ‰é¾è¾åš¨ç± å£Ÿæ”éš´æ¨“å©æ‘Ÿç°è˜†ç›§é¡±å»¬çˆæ“„é¹µè™œé­¯è³‚ç¥¿éŒ„é™¸é©¢å‘‚é‹ä¾¶å±¢ç¸·æ…®æ¿¾ç¶ å·’æ”£å­¿ç¤äº‚æ„è¼ªå€«ä¾–æ·ªç¶¸è«–è˜¿ç¾…é‚é‘¼ç±®é¨¾é§±çµ¡åª½ç‘ªç¢¼èé¦¬ç½µå—è²·éº¥è³£é‚è„ˆçé¥…è »æ»¿è¬¾è²“éŒ¨é‰šè²¿éº½é»´æ²’é‚é–€æ‚¶å€‘éŒ³å¤¢ç‡è¬å½Œè¦“å†ªç¶¿ç·¬å»Ÿæ»…æ†«é–©é³´éŠ˜è¬¬è¬€ç•å¶éˆ‰ç´é›£æ’“è…¦æƒ±é¬§é¤’å…§æ“¬å¦³è†©æ”†æ’šé‡€é³¥è¶åš™é‘·é³æª¸ç°å¯§æ“°æ¿˜éˆ•ç´è†¿æ¿ƒè¾²ç˜§è«¾æ­é·—æ¯†å˜”æ¼šç›¤é¾æ‹‹è³ å™´éµ¬é¨™é£„é »è²§è˜‹æ†‘è©•æ½‘é —æ’²é‹ªæ¨¸è­œæ£²æ·’è‡é½Šé¨è±ˆå•Ÿæ°£æ£„è¨–ç‰½æ‰¡é‡¬é‰›é·ç°½è¬™éŒ¢é‰—æ½›æ·ºè­´å¡¹æ§å—†å¢»è–”å¼·æ¶é¬æ©‹å–¬åƒ‘ç¿¹ç«…ç«Šæ¬½è¦ªå¯¢è¼•æ°«å‚¾é ƒè«‹æ…¶ç“Šçª®è¶¨å€è»€é©…é½²é¡´æ¬Šå‹¸å»éµ²ç¢ºè®“é¥’æ“¾ç¹ç†±éŸŒèªç´‰æ¦®çµ¨è»ŸéŠ³é–æ½¤ç‘è–©é°“è³½ä¸‰å‚˜å–ªé¨·æƒæ¾€æ®ºå‰ç´—ç¯©æ›¬åˆªé–ƒé™œè´ç¹•å¢‘å‚·è³ç‡’ç´¹è³’æ”æ‡¾è¨­ç´³å¯©å¬¸è…æ»²è²ç¹©å‹è–å¸«ç…æ¿•è©©å±æ™‚è•å¯¦è­˜é§›å‹¢é©é‡‹é£¾è¦–è©¦å£½ç¸æ¨è¼¸æ›¸è´–å±¬è¡“æ¨¹è±æ•¸å¸¥é›™èª°ç¨…é †èªªç¢©çˆçµ²é£¼è³æ…«é Œè¨Ÿèª¦æ“»è˜‡è¨´è‚…é›–éš¨ç¶æ­²å­«æç­ç¸®ç‘£é–çºæ’»æ“¡è‡ºæ…‹æ”¤è²ªç™±ç˜å£‡è­šè«‡å˜†æ¹¯ç‡™æ¿¤çµ³è¨é¨°è¬„éŠ»é¡Œé«”å±œæ¢è²¼éµå»³è½çƒ´éŠ…çµ±é ­ç¦¿åœ–å¡—åœ˜é ¹è›»è„«é´•é¦±é§æ©¢çªªè¥ªå½ç£é ‘è¬ç¶²éŸ‹é•åœç‚ºæ¿°ç¶­è‘¦å‰å½ç·¯é¤µè¬‚è¡›æº«èç´‹ç©©å•ç”•æ’¾è¸æ¸¦çª©è‡¥å—šé¢çƒæ±™èª£ç„¡è•ªå³å¡¢éœ§å‹™èª¤éŒ«çŠ§è¥²ç¿’éŠ‘æˆ²ç´°è¦è½„å³½ä¿ ç‹¹å»ˆåš‡éé®®çº–é¹¹è³¢éŠœé–‘é¡¯éšªç¾ç»ç¸£é¤¡ç¾¨æ†²ç·šå»‚é‘²é„‰è©³éŸ¿é …è•­å›‚éŠ·æ›‰å˜¯è å”æŒ¾æ”œè„…è«§å¯«ç€‰è¬é‹…é‡èˆˆå…‡æ´¶éŠ¹ç¹¡è™›å™“é ˆè¨±æ•˜ç·’çºŒè»’æ‡¸é¸ç™¬çµ¢å­¸å‹›è©¢å°‹é¦´è¨“è¨Šéœå£“é´‰é´¨å•äºè¨é–¹ç…™é¹½åš´å·–é¡é–»è‰·å­ç¡¯å½¥è«ºé©—é´¦æ¥Šæšç˜é™½ç™¢é¤Šæ¨£ç‘¤æ–å ¯é™çª¯è¬ è—¥çˆºé æ¥­è‘‰å£¹é†«éŠ¥é ¤éºå„€å½œèŸ»è—å„„æ†¶ç¾©è©£è­°èª¼è­¯ç•°ç¹¹è”­é™°éŠ€é£²éš±æ«»å¬°é·¹æ‡‰çº“ç‘©è¢ç‡Ÿç†’è …è´ç©å–²æ“å‚­ç™°è¸´è© æ¹§å„ªæ†‚éƒµéˆ¾çŒ¶éŠèª˜æ–¼è¼¿é­šæ¼å¨›èˆ‡å¶¼èªç±²ç¦¦ç„è­½é é¦­é´›æ·µè½…åœ’å“¡åœ“ç·£é é¡˜ç´„èºé‘°å¶½ç²µæ‚…é–±é›²é„–å‹»éš•é‹è˜Šé†æšˆéŸ»é›œç½è¼‰æ”¢æš«è´Šè´“è‡Ÿé‘¿æ£—ç«ˆè²¬æ“‡å‰‡æ¾¤è³Šè´ˆç´®åŠ„è»‹é˜é–˜æŸµè©é½‹å‚µæ°ˆç›æ–¬è¼¾å¶„æ£§æˆ°ç¶»å¼µæ¼²å¸³è³¬è„¹è¶™èŸ„è½éºé€™è²é‡åµè¨ºé®é™£æ™çœçŒ™çˆ­å¹€ç™¥é„­è­‰ç¹”è·åŸ·ç´™èªŒæ‘¯æ“²å¹Ÿè³ªæ»¯é˜çµ‚ç¨®è…«çœ¾è¬…è»¸çšºæ™é©Ÿè±¬è«¸èª…ç‡­çŸšå›‘è²¯é‘„ç¯‰è¨»é§å°ˆç£šè½‰è³ºæ¨èŠè£å¦å£¯ç‹€éŒè´…å¢œç¶´è«„æº–è‘—æ¿èŒ²è³‡æ¼¬è¹¤ç¶œç¸½ç¸±é„’è©›çµ„é‰†éŒ’å™¯å¬¡ç’¦æ›–é„è«³éŠ¨éµªåª¼é©é°²éˆ€å”„éˆ‘é´‡é½™éµ¯è³éŒ›è“½å—¶æ½·é‰ç¯³è¹•èŠç·¶ç±©é©ƒé¢®é£†é¢é‘£é°¾å„ç¹½æª³æ®¯è‡é‘Œé«•é¬¢ç¨Ÿé¤‘éˆ¸éµ“éˆ½é©‚é»²æƒ»é¤å„•é‡µå›…è«‚è®–è•†æ‡ºå¬‹é©è¦˜ç¦ªé”å€€è‡æ‚µé–¶é¯§ç¡¨å‚–è«¶æ«¬ç££é½”æ£–æª‰é‹®éºé£­é´ŸéŠƒå„”å¹¬è®èŠ»çµ€èº•é‡§æ„´ç¶é¶‰è¼Ÿé½ªé¶¿è“¯é©„æ¨…è¼³æ”›éŠ¼é¹ºå™ éŸƒé§˜ç´¿æ®«è³§ç™‰ç°è®œç¢­è¥ ç‡¾é™ç³´è©†è«¦ç¶ˆè¦¿é‘å·”éˆ¿ç™²éŠšé¯›é°ˆé‹ŒéŠ©å´ é¶‡ç«‡ç€†æ«ç‰˜ç¯¤é»·ç±ªæ‡Ÿé“ç‡‰èº‰é¸è«¤å Šé–¼è»›é‹¨é”é¶šé¡é¡“é±·èª’é‚‡é‰ºé´¯é®éˆé­´ç·‹é¨é¯¡åƒ¨çƒé³§é§™ç´±ç´¼è³»éº©é®’é°’é‡“è³…å°·æŸç´ºæˆ‡çªèª¥ç¸é‹¯ç´‡é˜æ½äº™è³¡ç¶†é¯è©¬ç·±è¦¯è©è½‚éˆ·éŒ®é´£éµ é¶»é´°æ‘‘è©¿æ‘œé¸›é°¥ç·åŒ­åŠŒåª¯æªœé®­é±–è¢ç·„é¯€å å’¼å¹—æ§¨èŸˆé‰¿é—çµé ¡çé¡¥è¨¶é—”è £é»Œè¨Œè‘’é–é±Ÿæ»¸é¶˜é©Šæ¨ºéµå¥ç¹¯é°é¯‡é°‰è©¼è–ˆå™¦æ¾®ç¹¢ç¿æš‰è«¢é¤›é–½éˆ¥é‘Šè¨è©°è–ºå˜°åšŒé©¥ç’£è¦¬é½ç£¯ç¾ˆè †èº‹éœ½é±­é¯½éƒŸæµ¹é‹éµèŸ¯è««ç¸‘æˆ”æˆ©ç¼é¶¼ç­§é°¹éŸ‰çµ³éŸæ’Ÿå¶ é·¦é®«ç™¤é œé®šå·¹è—é¥‰ç¸‰è´è¦²å‰„æ¶‡é€•å¼³è„›éšé¬®é³©é·²è©å±¨æ«¸é¢¶é‰…é‹¦çª¶é½ŸéŒˆé«é›‹è­ç¨çš¸å‰´å¡æ„¾æ„·é§é‡é¾•é–Œéˆ§éŠ¬é¨ç·™è»»éˆ³éŒé ·é½¦é—åš³é„¶å™²è†¾çªé«–èª†èª‘é„ºå£™çºŠè²ºåŒ±è•¢æ†’èµç°£é–«éŒ•é¯¤è å´å¾ æ·¶ç€¨è³šçéŒ¸ç™©ç±Ÿåµæ¬–æ–•é‘­è¥¤é–¬é‹ƒå˜®å¶—éŠ é’ç™†é°³èª„ç¸²å„·é…ˆå£¢è—¶è’è˜ºåš¦é‚é©ªç¸­æ«ªæ«Ÿè½¢ç¤ªé‹°é¸ç™˜ç³²èº’é‚é±ºé±§è˜å¥©ç€²ç’‰æ®®è¤³è¥é°±é­ç¹šé‡•é·¯è—ºå»©æªè½”èºªç¶¾æ¬èŸ¶é¯ªç€é¨®ç¶¹é¦é·šè˜¢ç€§ç“æ«³æœ§ç¤±åƒ‚è”å˜å¶é¤ç˜ºè€¬è»é«å£šæ“¼åš•é–­ç€˜æ·¥æ«¨æ«“è½¤è¼…è½†æ°Œè‡šé¸•é·ºè‰«é±¸è‡ å­Œæ¬’é¸é‘¾åœ‡çŠ–ç€æ¿¼æ¬è…¡éæ«šè¤¸é‹å˜¸å˜œå¬¤æ¦ªå‹±ç¸µéé¡™é°»éº¼æ«ç‡œæ‡£é†ç¾‹è¬ç¼ç¦°æ¾ é¦é»½ç·²ç¹†é–”ç·¡è¬¨é©€é¥ƒæ­¿éŒé‰¬éƒè¨¥éˆ®é¯¢è¼¦é¯°è”¦è£Šéš‰è˜—å›é¡¢èº¡è‹§åš€è¹å„‚å™¥é§‘é‡¹å„ºè¬³æ…ªç”Œè¹£çš°è½¡ç´•ç¾†éˆ¹è«é§¢ç¸¹å¬ªé‡™é·é è˜„é¨ç¶ºæ¦¿ç£§é é é°­åƒ‰è•æ…³é¨«ç¹¾æ§§éˆå¬™æª£æˆ§ç†—éŒ†é˜é¹ç¾¥è¹Œèªšè­™è•ç¹°ç£½è¹ºæ„œé¥ç¯‹é‹Ÿæ’³é¯–ç…¢è›ºå·°è³•èŸ£é°è©˜å¶‡é—ƒè¦·é´è©®ç¶£è¼‡éŠ“é—‹é—•æ„¨è•˜å¬ˆæ©ˆé£ªè»”å¶¸è ‘ç¸ŸéŠ£é¡°èœ†é¢¯æ¯¿ç³ç¹…å—‡éŠ«ç©¡é©é¯Šé‡ƒè¨•å§é¨¸é‡¤é±”å°æ®¤è§´å™ç„ç•¬è©µè«—ç€‹è¬šå¡’è’”å¼’è»¾è²°éˆ°é°£ç¶¬æ”„ç´“é–‚é‘ å»é§Ÿç·¦é¶é·¥è—ªé¤¿é¢¼éªè¬–ç©Œèª¶è“€çŒ»å—©è„§é—¥é‰ˆé°¨éˆ¦é®æ›‡é‰­éŒŸé ‡å„»é¤³é‹éœéŸœé‹±ç·¹éµœé—ç³¶é½ é°·æ…Ÿéˆ„é‡·æ‘¶é£©ç±œé¼‰åª§è†ƒç´ˆç¶°è¼è«‰å¹ƒé—ˆæºˆæ½¿ç‘‹éŸ™ç…’é®ªé–¿èµé½·é„”å»¡æ†®å«µé¨–éµ¡é¶©é¤¼é¬©ç’½è¦¡ç¡¤è§è–Ÿè˜šå³´ç«å«»é·´ç™‡è ”ç§ˆèºšè–Œé¤‰é©¤ç·—é¥—å˜µç€Ÿé©ç¶ƒæ¢Ÿç°«è¤»æ“·ç´²çºˆé™˜æ»é¥ˆéµ‚è©¡é Šè«¼é‰‰é‡è¬”æ¾©é±ˆå¡¤æ½¯é±˜åŸ¡å©­æ¤æ°¬å´è´—å„¼å…—è®æ‡¨é–†é‡…é­˜é¥œé¼´ç…¬è»ºé·‚é°©é¨è¬é„´æ›„ç‡è©’å›ˆå¶§é£´æ‡Œé©›ç¸Šè»¼è²½é‡”é°é¿ç˜è‰¤éŠ¦ç™®å¡‹é¶¯ç¸ˆé£æ”–åš¶ç€…ç€ ç“”é¸šç™­é ¦ç½Œéè••éŠªé­·å‚´ä¿è«›è«­è•·å´³é£«é–¾å«—ç´†è¦¦æ­Ÿéˆºéµ’é·¸é½¬æ«é³¶é»¿é‰é„†è•“æƒ²æ…ç´œéŸæ®æ°³ç“šè¶²é¨é§”è³¾å˜–å¹˜ç°€è­–ç¹’è­«è©”é‡—è¬«è¼’é·“æ¹ç¸æ¥¨è»«è³‘ç¦é´†è«å´¢é‰¦éŒšç®é¨­æ«›æ¢”è»¹è¼Šè´„é·™è„ç¸¶èº“èº‘è§¶é¾ç´‚ç¸ä½‡æ«§éŠ–å›€é¥Œé¡³é¨…ç¸‹è«‘é²è«®ç·‡è¼œè²²çœ¥éŒ™é½œé¯”å‚¯è«é¨¶é¯«éƒçº˜èº¦é±’è¨è­¾éƒ¤çŒ›æ°¹é˜ªå£Ÿå –åµå¢Šæª¾è•’è‘¤è“§è’“è‡æ§æ‘£å’¤å”šå“¢å™å™…æ’…åŠˆè¬”è¥†å¶´è„Šä»¿åƒ¥çéº…é¤˜é¤·é¥Šé¥¢æ¥æ€µæ‡çˆ¿æ¼µç©æ··æ¿«ç€¦æ·¡å¯§ç³¸çµç·”ç‘‰æ¢˜æ£¬æ¡ˆæ©°æ««è»²è»¤è³«è†è…–é£ˆç³Šç…†æºœæ¹£æ¸ºç¢¸æ»¾ç˜éˆˆé‰•é‹£éŠ±é‹¥é‹¶é¦é§é©é€éƒéŒ‡é„é‡é¿éé‘¥é‘¹é‘”ç©­é¶“é¶¥é¸Œç™§å±™ç˜‚è‡’è¥‡ç¹ˆè€®é¡¬èŸéº¯é®é®ƒé®é¯—é¯é¯´é±é¯¿é° é°µé±…é½éŸé½‡";
var newNotice = new obsidian.Notice("æ¬¢è¿ä½¿ç”¨ Obsidianï¼",1);
var å½“å‰æ–‡ä»¶;
var å½“å‰æ–‡ä»¶è·¯å¾„;
var ç¼–è¾‘æ¨¡å¼;
var èšç„¦ç¼–è¾‘ = true;
var æ‰€é€‰æ–‡æœ¬ = "";
var ç¬”è®°æ­£æ–‡ = "";
var ç¬”è®°å…¨æ–‡;
var å½“å‰è¡Œæ–‡æœ¬ = "";
var å†å²è¡Œæ–‡æœ¬ = "";
var å½“å‰å…‰æ ‡;
var å†å²å…‰æ ‡;
var å½“å‰è¡Œå·;
var é€‰è‡³è¡Œé¦– = "";
var é€‰è‡³è¡Œå°¾ = "";
var æœ«è¡Œè¡Œå·;
var æœ«è¡Œæ–‡æœ¬ = "";
var é€‰è‡³æ–‡é¦– = "";
var é€‰è‡³æ–‡æœ« = "";
var å†å²ç¼©è¿› = "";
var æŒ‰ä¸Šæ¡£é”® = false;

var isCtrl = false;
var isIndent = true;
var isTool = false;
var isText = false;
var isGLS = false;
var isCTS = false;
var isXTS = false;
var isSCS = false;
var isXHS = false;
var isSB = false;
var isXB = false;
var isBgC = false;
var isCTxt = false;
var isGLS1 = false;
var isGLS2 = false;
var isGLS3 = false;

var isTHS = false; //æ¶‚é»‘
var isTCS = false; //æ¶‚å½©
var isWKS = false; //æŒ–ç©º

function setAttributes(element, attributes) {
    for (let key in attributes) {
        element.setAttribute(key, attributes[key]);
    }
}

class MyPlugin extends obsidian.Plugin {
    constructor() {
        super(...arguments);
    };

    onload() {
        console.log(t('loadThisPlugin'));
        this.loadSettings();
        this.footnoteStatusBar = this.addStatusBarItem();
        this.footnoteStatusBar.setText("");
        this.addCommand({
            id: 'internal-link',
            name: '[[é“¾æ¥]]è¯­æ³•',
            callback: () => this.è½¬æ¢å†…éƒ¨é“¾æ¥(),
            hotkeys: [{ modifiers: ["Alt"], key: "Z" } ]
        });
        //console.log('åŠ è½½äº†'+this.settings.maxTry);
        this.addCommand({
            id: 'tag-text',
            name: '#æ ‡ç­¾ è¯­æ³•',
            callback: () => this.è½¬æ¢æ ‡ç­¾(),
            hotkeys: [{ modifiers: ["Alt","Shift"], key: "3" } ]
        });

        /**/
        this.addCommand({
            id: 'all-links',
            name: 'æ‰¹é‡è½¬æ¢[[é“¾æ¥]]',
            callback: () => this.æ‰¹é‡è½¬æ¢å†…é“¾()
        });
        this.addCommand({
            id: 'internal-link2',
            name: '[[é“¾æ¥|åŒå]]è¯­æ³•',
            callback: () => this.è½¬æ¢åŒä¹‰é“¾æ¥(),
            hotkeys: [{ modifiers: ["Alt"], key: "Q" } ]
        });
        this.addCommand({
            id: 'auto-text',
            name: 'æ™ºèƒ½ç¬¦å·',
            callback: () => this.æ™ºèƒ½ç¬¦å·(),
            hotkeys: [{ modifiers: ["Alt"], key: ";"}]
        });

        this.addCommand({
            id: 'open-up',
            name: 'æŸ¥çœ‹åŒçº§ä¸Šæ–¹æ–‡ä»¶',
            callback: () => this.åˆ‡æ¢æ–‡ä»¶åˆ—è¡¨(-1),
            hotkeys: [{ modifiers: ["Alt","Shift"], key: "U" } ]
        });

        this.addCommand({
            id: 'open-down',
            name: 'æŸ¥çœ‹åŒçº§ä¸‹æ–¹æ–‡ä»¶',
            callback: () => this.åˆ‡æ¢æ–‡ä»¶åˆ—è¡¨(1),
            hotkeys: [{ modifiers: ["Alt","Shift"], key: "N" } ]
        });

        
        this.addCommand({
            id: 'leftWin-Up',
            name: 'å·¦çª—å‘ä¸Šæ»šåŠ¨',
            callback: () => this.å·¦çª—å‘ä¸Šæ»šåŠ¨(),
            hotkeys: [{ modifiers: ["Alt","Shift"], key: "I" } ]
        });
        this.addCommand({
            id: 'leftWin-Down',
            name: 'å·¦çª—å‘ä¸‹æ»šåŠ¨',
            callback: () => this.å·¦çª—å‘ä¸‹æ»šåŠ¨(),
            hotkeys: [{ modifiers: ["Alt","Shift"], key: "K" } ]
        });
        /**/

        this.addCommand({
            id: 'mouse-up',
            name: 'æ¸¸æ ‡ä¸Šç§»',
            callback: () => this.æ¸¸æ ‡ä¸Šç§»(),
            hotkeys: [{ modifiers: ["Alt"], key: "I" } ]
        });
        this.addCommand({
            id: 'mouse-down',
            name: 'æ¸¸æ ‡ä¸‹ç§»',
            callback: () => this.æ¸¸æ ‡ä¸‹ç§»(),
            hotkeys: [{ modifiers: ["Alt"], key: "K" } ]
        });
        this.addCommand({
            id: 'mouse-left',
            name: 'æ¸¸æ ‡å·¦ç§»',
            callback: () => this.æ¸¸æ ‡å·¦ç§»(),
            hotkeys: [{ modifiers: ["Alt"], key: "J" } ]
        });
        this.addCommand({
            id: 'mouse-right',
            name: 'æ¸¸æ ‡å³ç§»',
            callback: () => this.æ¸¸æ ‡å³ç§»(),
            hotkeys: [{ modifiers: ["Alt"], key: "L" } ]
        });
        this.addCommand({
            id: 'mouse-start',
            name: 'æ¸¸æ ‡ç§»è‡³è¡Œé¦–',
            callback: () => this.æ¸¸æ ‡ç§»è‡³è¡Œé¦–(),
            hotkeys: [{ modifiers: ["Alt"], key: "U" } ]
        });
        this.addCommand({
            id: 'mouse-end',
            name: 'æ¸¸æ ‡ç§»è‡³è¡Œå°¾',
            callback: () => this.æ¸¸æ ‡ç§»è‡³è¡Œå°¾(),
            hotkeys: [{ modifiers: ["Alt"], key: "O" } ]
        });
        this.addCommand({
            id: 'note-start',
            name: 'æ¸¸æ ‡ç§»è‡³æ–‡é¦–',
            callback: () => this.æ¸¸æ ‡ç§»è‡³æ–‡é¦–()
        });
        this.addCommand({
            id: 'note-end',
            name: 'æ¸¸æ ‡ç§»è‡³æ–‡æœ«',
            callback: () => this.æ¸¸æ ‡ç§»è‡³æ–‡æœ«()
        });

        this.addCommand({
            id: 'biaoti0-text',
            name: 'å–æ¶ˆæ ‡é¢˜',
            callback: () => this.æ ‡é¢˜è¯­æ³•(""),
            hotkeys: [{ modifiers: ["Mod"], key: "`" } ]
        });
        this.addCommand({
            id: 'biaoti1-text',
            name: 'H1æ ‡é¢˜',
            callback: () => this.æ ‡é¢˜è¯­æ³•("#"),
            hotkeys: [{ modifiers: ["Mod"], key: "1" } ]
        });
        this.addCommand({
            id: 'biaoti2-text',
            name: 'H2æ ‡é¢˜',
            callback: () => this.æ ‡é¢˜è¯­æ³•("##"),
            hotkeys: [{ modifiers: ["Mod"], key: "2" } ]
        }); 
        this.addCommand({
            id: 'biaoti3-text',
            name: 'H3æ ‡é¢˜',
            callback: () => this.æ ‡é¢˜è¯­æ³•("###"),
            hotkeys: [{ modifiers: ["Mod"], key: "3" } ]
        }); 
        this.addCommand({
            id: 'biaoti4-text',
            name: 'H4æ ‡é¢˜',
            callback: () => this.æ ‡é¢˜è¯­æ³•("####"),
            hotkeys: [{ modifiers: ["Mod"], key: "4" } ]
        }); 
        this.addCommand({
            id: 'biaoti5-text',
            name: 'H5æ ‡é¢˜',
            callback: () => this.æ ‡é¢˜è¯­æ³•("#####"),
            hotkeys: [{ modifiers: ["Mod"], key: "5" } ]
        }); 
        this.addCommand({
            id: 'biaoti6-text',
            name: 'H6æ ‡é¢˜',
            callback: () => this.æ ‡é¢˜è¯­æ³•("######"),
            hotkeys: [{ modifiers: ["Mod"], key: "6" } ]
        });
        this.addCommand({
            id: 'zeng-btexts',
            name: 'è°ƒé«˜æ ‡é¢˜çº§åˆ«',
            callback: () => this.è°ƒèŠ‚æ ‡é¢˜çº§åˆ«(true)
        });
        this.addCommand({
            id: 'jian-btexts',
            name: 'è°ƒä½æ ‡é¢˜çº§åˆ«',
            callback: () => this.è°ƒèŠ‚æ ‡é¢˜çº§åˆ«(false)
        });
        /**/
        this.addCommand({
            id: 'auto-texts',
            name: 'è‡ªåŠ¨è®¾ç½®æ ‡é¢˜',
            callback: () => this.è‡ªåŠ¨è®¾ç½®æ ‡é¢˜()
        });
        
        this.addCommand({
            id: 'quit-format',
            name: 'å…³é—­æ ¼å¼åˆ·',
            callback: () => {
                this.å…³é—­æ ¼å¼åˆ·();
                new obsidian.Notice("å·²å…³é—­æ ¼å¼åˆ·ï¼");
            }
        }); 
        this.addCommand({
            id: 'cuti-format',
            name: '**ç²—ä½“**æ ¼å¼åˆ·',
            callback: () => this.ç²—ä½“æ ¼å¼åˆ·(),
            hotkeys: [{ modifiers: ["Alt","Shift"], key: "C" } ]
        }); 
        this.addCommand({
            id: 'cuti-text',
            name: '**ç²—ä½“**',
            callback: () => this.è½¬æ¢ç²—ä½“(),
            hotkeys: [{ modifiers: ["Alt"], key: "C" } ]
        }); 

        this.addCommand({
            id: 'gaoliang-format',
            name: '==é«˜äº®==æ ¼å¼åˆ·',
            callback: () => this.é«˜äº®æ ¼å¼åˆ·(),
            hotkeys: [{ modifiers: ["Alt","Shift"], key: "G" } ]
        });
        this.addCommand({
            id: 'gaoliang-text',
            name: '==é«˜äº®==',
            callback: () => this.è½¬æ¢é«˜äº®(),
            hotkeys: [{ modifiers: ["Alt"], key: "G" } ]
        });
		this.addCommand({
            id: 'gaoliang1-text',
            name: '*==å¤šå½©é«˜äº®1==*',
            callback: () => this.è½¬æ¢é«˜äº®1()
        });
		this.addCommand({
            id: 'gaoliang2-text',
            name: '**==å¤šå½©é«˜äº®2==**',
            callback: () => this.è½¬æ¢é«˜äº®2()
        });
		this.addCommand({
            id: 'gaoliang3-text',
            name: '***==å¤šå½©é«˜äº®3==***',
            callback: () => this.è½¬æ¢é«˜äº®3()
        });
		this.addCommand({
            id: 'tuhei-text',
            name: '==~~æ¶‚é»‘~~==',
            callback: () => this.è½¬æ¢æ¶‚é»‘()
        });
		this.addCommand({
            id: 'tucai-text',
            name: '*==~~æ¶‚å½©~~==*',
            callback: () => this.è½¬æ¢æ¶‚å½©()
        });
		this.addCommand({
            id: 'wakong-text',
            name: '*~~æŒ–ç©º~~*',
            callback: () => this.è½¬æ¢æŒ–ç©º()
        });
        /**/
        this.addCommand({
            id: 'xieti-format',
            name: '*æ–œä½“*æ ¼å¼åˆ·',
            callback: () => this.æ–œä½“æ ¼å¼åˆ·(),
            hotkeys: [{ modifiers: ["Alt","Shift"], key: "X" } ]
        });
        this.addCommand({
            id: 'xieti-text',
            name: '*æ–œä½“*',
            callback: () => this.è½¬æ¢æ–œä½“(),
            hotkeys: [{ modifiers: ["Alt"], key: "X" } ]
        });

        
        this.addCommand({
            id: 'shanchu-format',
            name: '~~åˆ é™¤çº¿~~æ ¼å¼åˆ·',
            callback: () => this.åˆ é™¤çº¿æ ¼å¼åˆ·(),
            hotkeys: [{ modifiers: ["Alt","Shift"], key: "S" } ]
        });
        this.addCommand({
            id: 'shanchu-text',
            name: '~~åˆ é™¤çº¿~~',
            callback: () => this.è½¬æ¢åˆ é™¤çº¿(),
            hotkeys: [{ modifiers: ["Alt"], key: "S" } ]
        });

        this.addCommand({
            id: 'xiahua-format',
            name: '_ä¸‹åˆ’çº¿_æ ¼å¼åˆ·',
            callback: () => this.ä¸‹åˆ’çº¿æ ¼å¼åˆ·(),
            hotkeys: [{ modifiers: ["Alt","Shift"], key: "H" } ]
        });
        this.addCommand({
            id: 'xiahua-text',
            name: '_ä¸‹åˆ’çº¿_',
            callback: () => this.è½¬æ¢ä¸‹åˆ’çº¿(),
            hotkeys: [{ modifiers: ["Alt"], key: "H" } ]
        });

        /* Obsidianè‡ªå¸¦æ­¤åŠŸèƒ½
        this.addCommand({
            id: 'zhuozhong-text',
            name: '`è¡Œå†…ä»£ç `',
            callback: () => this.è½¬æ¢è¡Œå†…ä»£ç ()
        }); 
        */
        this.addCommand({
            id: 'add-daima',
            name: '```ä»£ç å—```',
            callback: () => this.è½¬æ¢ä»£ç å—(),
            hotkeys: [{ modifiers: ["Alt"], key: "D" } ]
        });
        this.addCommand({
            id: 'add-langxian',
            name: '~~~ä¸‰æµªçº¿~~~',
            callback: () => this.è½¬æ¢ä¸‰æµªçº¿()
        });
        
        this.addCommand({
            id: 'internal-hyper',
            name: '[[]]è½¬ä¸º[]()',
            callback: () => this.å†…é“¾è½¬ä¸ºè¶…é“¾æ¥()
        });
        this.addCommand({
            id: 'hyper-internal',
            name: '[]()è½¬ä¸º[[]]',
            callback: () => this.è¶…é“¾æ¥è½¬ä¸ºå†…é“¾()
        });
        this.addCommand({
            id: 'clear-link',
            name: 'å»é™¤è¶…é“¾æ¥è¯­æ³•()',
            callback: () => this.å»é™¤è¶…é“¾æ¥è¯­æ³•()
        });

        this.addCommand({
            id: 'common-text',
            name: 'è½¬æ¢æ— è¯­æ³•æ–‡æœ¬',
            callback: () => this.è½¬æ¢æ— è¯­æ³•æ–‡æœ¬(),
            hotkeys: [{ modifiers: ["Mod","Alt"],key: "Z"}]
        });
        this.addCommand({
            id: 'copy-text',
            name: 'è·å–æ— è¯­æ³•æ–‡æœ¬',
            callback: () => this.è·å–æ— è¯­æ³•æ–‡æœ¬(),
            hotkeys: [{ modifiers: ["Mod","Alt"],key: "C"}]
        });

        /*this.addCommand({
            id: 'format-up',
            name: 'ä¸Šæ ‡æ ¼å¼åˆ·',
            callback: () => this.ä¸Šæ ‡æ ¼å¼åˆ·()
        });*/
        this.addCommand({
            id: 'add-up',
            name: 'ä¸Šæ ‡è¯­æ³•',
            callback: () => this.è½¬æ¢ä¸Šæ ‡()
        });

        /*this.addCommand({
            id: 'format-ub',
            name: 'ä¸‹æ ‡æ ¼å¼åˆ·',
            callback: () => this.ä¸‹æ ‡æ ¼å¼åˆ·()
        });*/
        this.addCommand({
            id: 'add-ub',
            name: 'ä¸‹æ ‡è¯­æ³•',
            callback: () => this.è½¬æ¢ä¸‹æ ‡()
        });

        this.addCommand({
            id: 'text-Color1',
            name: 'è½¬æ¢å½©è‰²æ–‡å­—1',
            callback: () => {
                this.settings.hColor = this.settings.hColor1;
                this.è½¬æ¢æ–‡å­—é¢œè‰²();
            },
            hotkeys: [{ modifiers: ["Mod","Shift"], key: "1" } ]
        });
        this.addCommand({
            id: 'text-Color2',
            name: 'è½¬æ¢å½©è‰²æ–‡å­—2',
            callback: () => {
                this.settings.hColor = this.settings.hColor2;
                this.è½¬æ¢æ–‡å­—é¢œè‰²();
            },
            hotkeys: [{ modifiers: ["Mod","Shift"], key: "2" } ]
        });
        this.addCommand({
            id: 'text-Color3',
            name: 'è½¬æ¢å½©è‰²æ–‡å­—3',
            callback: () => {
                this.settings.hColor = this.settings.hColor3;
                this.è½¬æ¢æ–‡å­—é¢œè‰²();
            },
            hotkeys: [{ modifiers: ["Mod","Shift"], key: "3" } ]
        });
        this.addCommand({
            id: 'text-Color4',
            name: 'è½¬æ¢å½©è‰²æ–‡å­—4',
            callback: () => {
                this.settings.hColor = this.settings.hColor4;
                this.è½¬æ¢æ–‡å­—é¢œè‰²();
            },
            hotkeys: [{ modifiers: ["Mod","Shift"], key: "4" } ]
        });
        this.addCommand({
            id: 'text-Color5',
            name: 'è½¬æ¢å½©è‰²æ–‡å­—5',
            callback: () => {
                this.settings.hColor = this.settings.hColor5;
                this.è½¬æ¢æ–‡å­—é¢œè‰²();
            },
            hotkeys: [{ modifiers: ["Mod","Shift"], key: "5" } ]
        });
        this.addCommand({
            id: 'text-background1',
            name: 'è½¬æ¢å½©è‰²èƒŒæ™¯1',
            callback: () => {
                this.settings.bColor = this.settings.bColor1;
                this.è½¬æ¢èƒŒæ™¯é¢œè‰²();
            },
            hotkeys: [{ modifiers: ["Mod","Alt"], key: "1" } ]
        });
        this.addCommand({
            id: 'text-background2',
            name: 'è½¬æ¢å½©è‰²èƒŒæ™¯2',
            callback: () => {
                this.settings.bColor = this.settings.bColor2;
                this.è½¬æ¢èƒŒæ™¯é¢œè‰²();
            },
            hotkeys: [{ modifiers: ["Mod","Alt"], key: "2" } ]
        });
        this.addCommand({
            id: 'text-background3',
            name: 'è½¬æ¢å½©è‰²èƒŒæ™¯3',
            callback: () => {
                this.settings.bColor = this.settings.bColor3;
                this.è½¬æ¢èƒŒæ™¯é¢œè‰²();
            },
            hotkeys: [{ modifiers: ["Mod","Alt"], key: "3" } ]
        });
        this.addCommand({
            id: 'text-background4',
            name: 'è½¬æ¢å½©è‰²èƒŒæ™¯4',
            callback: () => {
                this.settings.bColor = this.settings.bColor4;
                this.è½¬æ¢èƒŒæ™¯é¢œè‰²();
            },
            hotkeys: [{ modifiers: ["Mod","Alt"], key: "4" } ]
        });
        this.addCommand({
            id: 'text-background5',
            name: 'è½¬æ¢å½©è‰²èƒŒæ™¯5',
            callback: () => {
                this.settings.bColor = this.settings.bColor5;
                this.è½¬æ¢èƒŒæ™¯é¢œè‰²();
            },
            hotkeys: [{ modifiers: ["Mod","Alt"], key: "5" } ]
        });

        this.addCommand({
            id: 'add-todo',
            name: 'è½¬æ¢å¾…åŠçŠ¶æ€',
            callback: () => this.è½¬æ¢å¾…åŠåˆ—è¡¨()
        });
        this.addCommand({
            id: 'sum-time',
            name: 'åˆè®¡ä»»åŠ¡ç”¨æ—¶',
            callback: () => this.åˆè®¡ä»»åŠ¡ç”¨æ—¶()
        });
        this.addCommand({
            id: 'add-todoTime',
            name: 'æ ‡è®°å®ŒæˆåŠæ—¶é—´',
            callback: () => this.æ ‡è®°å®ŒæˆåŠæ—¶é—´()
        });
        this.addCommand({
            id: 'y2w-list',
            name: 'æœ‰è½¬æ— åºåˆ—è¡¨()',
            callback: () => this.æœ‰è½¬æ— åºåˆ—è¡¨()()
        });
        this.addCommand({
            id: 'w2y-list',
            name: 'æ— è½¬æœ‰åºåˆ—è¡¨()',
            callback: () => this.æ— è½¬æœ‰åºåˆ—è¡¨()()
        });

        this.addCommand({
            id: 'add-tiankong',
            name: 'å¡«ç©º{{c*::é€‰æ–‡}}',
            callback: () => this.è½¬æ¢å¡«ç©º()
        });

        this.addCommand({
            id: 'list-mermaid',
            name: 'åˆ—è¡¨è½¬ä¸ºå›¾ç¤º',
            callback: () => this.åˆ—è¡¨è½¬ä¸ºå›¾ç¤º() 
        });
        this.addCommand({
            id: 'file-path',
            name: 'è½¬æ¢è·¯å¾„',
            callback: () => this.è½¬æ¢è·¯å¾„()
        });
        this.addCommand({
            id: 'text-line',
            name: 'æ‹†åˆ†å¤šè¡Œ',
            callback: () => this.æ‹†åˆ†å¤šè¡Œ()
        });
        this.addCommand({
            id: 'jian-fan',
            name: 'ç®€ä½“è½¬ç¹',
            callback: () => this.ç®€ä½“è½¬ç¹()
        });
        this.addCommand({
            id: 'fan-jian',
            name: 'ç¹ä½“è½¬ç®€',
            callback: () => this.ç¹ä½“è½¬ç®€()
        }); 

        this.addCommand({
            id: 'add-kh1',
            name: 'ã€é€‰æ–‡ã€‘',
            callback: () => this.æ‹¬é€‰æ–‡æœ¬1(),
        });
        this.addCommand({
            id: 'add-kh2',
            name: 'ï¼ˆé€‰æ–‡ï¼‰',
            callback: () => this.æ‹¬é€‰æ–‡æœ¬2(),
        });
        this.addCommand({
            id: 'add-kh3',
            name: 'ã€Œé€‰æ–‡ã€',
            callback: () => this.æ‹¬é€‰æ–‡æœ¬3(),
        });
        this.addCommand({
            id: 'add-kh4',
            name: 'ã€Šé€‰æ–‡ã€‹',
            callback: () => this.æ‹¬é€‰æ–‡æœ¬4(),
        });

        /*
        this.addCommand({
            id: 'paste-html',
            name: 'è·å–å¯Œæ–‡æœ¬()',
            callback: () => this.è·å–å¯Œæ–‡æœ¬()(),
            hotkeys: [{ modifiers: ["Mod","Shift","Alt"], key: "V" } ]
        });
        */
        this.addCommand({
            id: 'paste-text',
            name: 'æ™ºèƒ½ç²˜è´´',
            callback: () => this.æ™ºèƒ½ç²˜è´´(),
            hotkeys: [{ modifiers: ["Mod","Alt"], key: "V" } ]
        });
        this.addCommand({
            id: 'jisuan-form',
            name: 'è®¡ç®—æ‰€é€‰ç»“æœ',
            callback: () => this.è®¡ç®—æ‰€é€‰ç»“æœ(),
            hotkeys: [{ modifiers: [], key: "F9" } ]
        });
        this.addCommand({
            id: 'edit-biaodian',
            name: 'ä¿®å¤é”™è¯¯æ ‡ç‚¹',
            callback: () => this.ä¿®å¤é”™è¯¯æ ‡ç‚¹()
        });
        this.addCommand({
            id: 'edit-yufa',
            name: 'ä¿®å¤é”™è¯¯è¯­æ³•',
            callback: () => this.ä¿®å¤é”™è¯¯è¯­æ³•()
        });
        this.addCommand({
            id: 'edit-duanhang',
            name: 'ä¿®å¤æ„å¤–æ–­è¡Œ',
            callback: () => this.ä¿®å¤æ„å¤–æ–­è¡Œ()
        });
        this.addCommand({
            id: 'search-text',
            name: 'æœç´¢å½“å‰æ–‡æœ¬',
            callback: () => this.æœç´¢å½“å‰æ–‡æœ¬()
        });
        this.addCommand({
            id: 'delete-list',
            name: 'åˆ é™¤å½“å‰æ®µè½',
            callback: () => this.åˆ é™¤å½“å‰æ®µè½()
        });

        this.addCommand({
            id: 'parent-biaozhu',
            name: 'å…‰æ ‡å‘ä¸Šè·³è½¬',
            callback: () => this.å…‰æ ‡è·³è½¬("ä¸Š")
        });
        this.addCommand({
            id: 'next-biaozhu',
            name: 'å…‰æ ‡å‘ä¸‹è·³è½¬',
            callback: () => this.å…‰æ ‡è·³è½¬("ä¸‹")
        });
        
        this.addCommand({
            id: 'Selection-text',
            name: 'é€‰æ‹©å½“å‰æ•´æ®µ',
            callback: () => this.é€‰æ‹©å½“å‰æ•´æ®µ()
        });
        this.addCommand({
            id: 'Selection-juzi',
            name: 'é€‰æ‹©å½“å‰æ•´å¥',
            callback: () => this.é€‰æ‹©å½“å‰æ•´å¥()
        });
        this.addCommand({
            id: 'Selection-markdown',
            name: 'é€‰æ‹©å½“å‰è¯­æ³•',
            callback: () => this.é€‰æ‹©å½“å‰è¯­æ³•()
        });
        this.addCommand({
            id: 'search-text',
            name: 'è·å–æœç´¢ç»“æœ',
            callback: () => this.è·å–æœç´¢ç»“æœ()
        });
        this.addCommand({
            id: 'tiqu-text',
            name: 'è·å–æ ‡æ³¨æ–‡æœ¬',
            callback: () => this.è·å–æ ‡æ³¨æ–‡æœ¬()
        });
        this.addCommand({
            id: 'copy-filePath',
            name: 'è·å–ç›¸å¯¹è·¯å¾„',
            callback: () => this.è·å–ç›¸å¯¹è·¯å¾„()  
        });
        this.addCommand({
            id: 'modify-fileName',
            name: 'æŒ‡å®šå½“å‰æ–‡ä»¶å',
            callback: () => this.æŒ‡å®šå½“å‰æ–‡ä»¶å()  
        });
        this.addCommand({
            id: 'iframe-URL',
            name: 'åµŒå…¥å½“å‰ç½‘å€é¡µé¢',
            callback: () => this.åµŒå…¥å½“å‰ç½‘å€é¡µé¢() 
        });

        this.addCommand({
            id: 'sort-lines',
            name: 'å‡åºæ’åˆ—æ‰€é€‰æ®µè½',
            callback: () => this.å‡åºæ’åˆ—æ‰€é€‰æ®µè½()
        });
        this.addCommand({
            id: 'reverse-lines',
            name: 'é™åºæ’åˆ—æ‰€é€‰æ®µè½',
            callback: () => this.é™åºæ’åˆ—æ‰€é€‰æ®µè½()
        });
        this.addCommand({
            id: 'jiaId-lines',
            name: 'æ·»åŠ æ®µè½ç¼–å·',
            callback: () => this.æ·»åŠ æ®µè½ç¼–å·()
        });
        this.addCommand({
            id: 'jianId-lines',
            name: 'å»é™¤æ®µè½ç¼–å·',
            callback: () => this.å»é™¤æ®µè½ç¼–å·()
        });

        this.addCommand({
            id: 'zhe-lines',
            name: 'æŠ˜å åŒçº§æ ‡é¢˜',
            callback: () => this.æŠ˜å åŒçº§æ ‡é¢˜(),
            hotkeys: [{ modifiers: ["Mod","Shift","Alt"], key: "D" } ]
        });
        
        this.addCommand({
            id: 'link-showname',
            name: 'ä¿®æ”¹å†…éƒ¨é“¾æ¥çš„æ˜¾ç¤ºåç§°',
            callback: () => this.ä¿®æ”¹å†…éƒ¨é“¾æ¥çš„æ˜¾ç¤ºåç§°(2),
            hotkeys: [{ modifiers: ["Alt"], key: "\\" } ]
        });
        this.addCommand({
            id: 'zhe-level2',
            name: 'æŠ˜å äºŒçº§æ ‡é¢˜',
            callback: () => this.æŠ˜å æ ‡é¢˜ç­‰çº§(2),
            hotkeys: [{ modifiers: ["Shift"], key: "F2" } ]
        });
        this.addCommand({
            id: 'zhe-level3',
            name: 'æŠ˜å ä¸‰çº§æ ‡é¢˜',
            callback: () => this.æŠ˜å æ ‡é¢˜ç­‰çº§(3),
            hotkeys: [{ modifiers: ["Shift"], key: "F3" } ]
        });
        this.addCommand({
            id: 'zhe-level4',
            name: 'æŠ˜å å››çº§æ ‡é¢˜',
            callback: () => this.æŠ˜å æ ‡é¢˜ç­‰çº§(4),
            hotkeys: [{ modifiers: ["Shift"], key: "F4" } ]
        });
        this.addCommand({
            id: 'zhe-level5',
            name: 'æŠ˜å äº”çº§æ ‡é¢˜',
            callback: () => this.æŠ˜å æ ‡é¢˜ç­‰çº§(5),
            hotkeys: [{ modifiers: ["Shift"], key: "F5" } ]
        });
        this.addCommand({
            id: 'zhe-level6',
            name: 'æŠ˜å å…­çº§æ ‡é¢˜',
            callback: () => this.æŠ˜å æ ‡é¢˜ç­‰çº§(6),
            hotkeys: [{ modifiers: ["Shift"], key: "F6" } ]
        });

        this.addCommand({
            id: 'add-Line0',
            name: 'æ’å…¥æœ‰æ•ˆç©ºè¡Œ',
            callback: () => this.æ’å…¥æœ‰æ•ˆç©ºè¡Œ(),
            hotkeys: [{ modifiers: ["Mod","Shift","Alt"], key: "Enter" } ]
        });
        this.addCommand({
            id: 'space-lines',
            name: 'ç©ºæ ¼è½¬ä¸ºç©ºè¡Œ',
            callback: () => this.ç©ºæ ¼è½¬ä¸ºç©ºè¡Œ()
        });
        this.addCommand({
            id: 'add-lines',
            name: 'æ‰¹é‡æ’å…¥ç©ºè¡Œ',
            callback: () => this.æ‰¹é‡æ’å…¥ç©ºè¡Œ(),
            hotkeys: [{ modifiers: ["Mod","Shift"], key: "L" } ]    
        });
        this.addCommand({
            id: 'add-line1',
            name: 'ä¸Šæ–¹æ’å…¥ç©ºè¡Œ',
            callback: () => this.ä¸Šæ–¹æ’å…¥ç©ºè¡Œ(), 
        });
        this.addCommand({
            id: 'add-line2',
            name: 'ä¸‹æ–¹æ’å…¥ç©ºè¡Œ',
            callback: () => this.ä¸‹æ–¹æ’å…¥ç©ºè¡Œ()
        });
        this.addCommand({
            id: 'del-lines',
            name: 'æ‰¹é‡å»é™¤ç©ºè¡Œ',
            callback: () => this.æ‰¹é‡å»é™¤ç©ºè¡Œ(),
            hotkeys: [{ modifiers: ["Mod","Alt"], key: "l" } ]
        });
        this.addCommand({
            id: 'add-twoSpace',
            name: 'è¡Œé¦–ç¼©è¿›/å–æ¶ˆç¼©è¿›ä¸¤å­—ç¬¦',
            callback: () => this.è¡Œé¦–ç¼©è¿›ä¸¤å­—ç¬¦()
        });
        this.addCommand({
            id: 'add-space2',
            name: 'è¡Œé¦–æ·»åŠ ç©ºæ ¼',
            callback: () => this.è¡Œé¦–æ·»åŠ ç©ºæ ¼()
        });
        this.addCommand({
            id: 'del-space1',
            name: 'å»é™¤è¡Œé¦–ç©ºæ ¼',
            callback: () => this.å»é™¤è¡Œé¦–ç©ºæ ¼()
        });
        this.addCommand({
            id: 'add-space1',
            name: 'æœ«å°¾è¿½åŠ ç©ºæ ¼',
            callback: () => this.æœ«å°¾è¿½åŠ ç©ºæ ¼()
        });
        this.addCommand({
            id: 'del-space2',
            name: 'å»é™¤æœ«å°¾ç©ºæ ¼',
            callback: () => this.å»é™¤æœ«å°¾ç©ºæ ¼()
        });
        this.addCommand({
            id: 'add-allSpspace',
            name: 'æ·»åŠ é—´éš”ç©ºæ ¼',
            callback: () => this.æ·»åŠ é—´éš”ç©ºæ ¼()
        });
        this.addCommand({
            id: 'del-allSpspace',
            name: 'å»é™¤æ‰€æœ‰ç©ºæ ¼',
            callback: () => this.å»é™¤æ‰€æœ‰ç©ºæ ¼()
        });
        


        this.addSettingTab(new editSettingsTab(this.app, this));
        this.app.workspace.onLayoutReady(() => {
            setTimeout(() => {
                this.htmlè¯­æ³•æ ¼å¼åˆ·();
                this.å®ç”¨å‘½ä»¤èœå•();
            });
        });
        
        
        /*
        this.registerEvent(this.app.workspace.on('editor-change', function (file) {
            if (file) {
                
            };
        }));
        */

        document.addEventListener('mouseup', (e) => {
            this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
            if(èšç„¦ç¼–è¾‘){
                å†å²è¡Œæ–‡æœ¬ = å½“å‰è¡Œæ–‡æœ¬;
                if(æ‰€é€‰æ–‡æœ¬==null){
                    return
                }else{
                    if(isText){
                        this.è½¬æ¢æ— è¯­æ³•æ–‡æœ¬();
                    }else if(isCTxt){
                        this.è½¬æ¢æ–‡å­—é¢œè‰²();
                    }else if(isBgC){
                        this.è½¬æ¢èƒŒæ™¯é¢œè‰²();
                    }else if(isGLS){
                        this.è½¬æ¢é«˜äº®();
                    }else if(isGLS1){
                        this.è½¬æ¢é«˜äº®1();
					}else if(isGLS2){
                        this.è½¬æ¢é«˜äº®2();
                    }else if(isGLS3){
                        this.è½¬æ¢é«˜äº®3();
					}else if(isCTS){
                        this.è½¬æ¢ç²—ä½“();
                    }else if(isXTS){
                        this.è½¬æ¢æ–œä½“();
                    }else if(isSCS){
                        this.è½¬æ¢åˆ é™¤çº¿();
                    }else if(isXHS){
                        this.è½¬æ¢ä¸‹åˆ’çº¿();
                    }else if(isSB){
                        this.è½¬æ¢ä¸Šæ ‡();
                    }else if(isXB){
                        this.è½¬æ¢ä¸‹æ ‡();
                    }else if(isTHS){
                        this.è½¬æ¢æ¶‚é»‘();
                    }else if(isTCS){
                        this.è½¬æ¢æ¶‚å½©();
                    }else if(isWKS){
                        this.è½¬æ¢æŒ–ç©º();
                    }
                    //else if(isCtrl){
                        //newNotice.hide();
                        // newNotice = new obsidian.Notice(æ‰€é€‰æ–‡æœ¬);
                    //};
                }
                 
            }else if(isText||isCTxt ||isBgC ||isCTS || isGLS || isGLS1 ||isGLS2 ||isGLS3 ||isSB || isSCS || isXB || isXHS || isXTS || isTHS ||isTCS||isWKS){
                this.å…³é—­æ ¼å¼åˆ·();
                newNotice = new obsidian.Notice("å·²å…³é—­æ ¼å¼åˆ·ï¼");
            }
        });

        
        document.addEventListener('keydown',(e) =>{
            this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
            if(èšç„¦ç¼–è¾‘){
                if(e.key == "Tab" && this.settings.isTab){
                    if(/^\s*([\-\*]+|`+|\|[^\|]|[\-\+]\s|\d+\.\s)/.test(é€‰è‡³è¡Œé¦–)){
                        //å½“å‰ä¸ºåˆ†éš”è¡Œã€ä»£ç å—ã€åˆ—è¡¨è¡Œæˆ–è¡¨æ ¼è¡Œï¼Œåˆ™ä¸åœ¨è¡Œå†…æ’å…¥åˆ¶è¡¨ç¬¦
                    }else{
                        é€‰è‡³è¡Œé¦– = é€‰è‡³è¡Œé¦–.replace(/(    |\t)/,"");    //æ¶ˆé™¤æ­¤æ¬¡ç¼©è¿›æ•ˆæœ
                        ç¬”è®°å…¨æ–‡.replaceRange(é€‰è‡³è¡Œé¦–+"	", {line:å½“å‰è¡Œå·,ch:0}, å½“å‰å…‰æ ‡); //åè¡¥4ä¸ªç©ºæ ¼
                    }
                };

                if(e.key =="Control"){
                    isCtrl =true;
                }
            };
        });

        document.addEventListener('keyup',(e) =>{
            this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
            if(èšç„¦ç¼–è¾‘){
                if(e.key =="Control"){
                    isCtrl = false;
                }
            };            
        });

        /** ä»¥ä¸‹å››ä¸ªä¾¦å¬å‡½æ•°å¤‡ç”¨ */
        
        this.registerEvent(this.app.workspace.on('file-open', (file) => {
            if (file && file.path) {
                document.title = this.app.vault.adapter.basePath + "\\" +file.path.replace(/\//g,"\\");
                const files = this.app.vault.getFiles();
                const FilePaths = files.map((file) => {
                    return file.path;
                });
                let attachDir = this.app.vault.getConfig("attachmentFolderPath");
                //console.log("é™„ä»¶ç›®å½•\n"+attachDir);
                
                å½“å‰æ–‡ä»¶ = file;
                å½“å‰æ–‡ä»¶è·¯å¾„ = file.path;
                
                if(this.settings.version != å½“å‰ç‰ˆæœ¬){
                    const noticeContent = createFragment();
                    noticeContent.createEl("p").innerHTML = t('helloWorld');
                    noticeContent.createEl("p").innerHTML = åŠŸèƒ½æ›´æ–°;
                    noticeContent.createEl("button").innerHTML = t('qq');
                    noticeContent.createEl("p").innerHTML = t('close');
                    new obsidian.Notice(noticeContent, 0);
                    this.settings.version = å½“å‰ç‰ˆæœ¬;
                    this.saveSettings();
                };
                //this.æ˜¾ç¤ºå†™ä½œè¿›åº¦();                
            }
        }));

        /*
        this.registerEvent(this.app.vault.on('delete', (file) => {
            if (file && file.path) {
                this.saveSettings();
            }
        }));

        this.registerEvent(this.app.vault.on('rename', (file, oldPath) => {
            if (file && file.path) {
                this.saveSettings();
            }
        }));
        
        this.registerCodeMirror((cm) => {
            let cmEditor = cm;
            let currentExtraKeys = cmEditor.getOption('extraKeys');
            let moreKeys = {
                'Enter': (cm) => {
                    ç¼–è¾‘æ¨¡å¼ = this.è·å–ç¼–è¾‘æ¨¡å¼ ();
                    å½“å‰å…‰æ ‡ = ç¼–è¾‘æ¨¡å¼.getCursor();
                }
            };            
        });
        */
    };



    æ˜¾ç¤ºå†™ä½œè¿›åº¦(){
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(this.settings.isShowNum){
            let maxTry = this.settings.maxTry;
            let è¿›åº¦ = Math.round(ç¬”è®°æ­£æ–‡.length/maxTry*100)+"% â†’ "+maxTry +"å­—";
            //console.log(maxTry+" "+è¿›åº¦);
            this.footnoteStatusBar.setText(è¿›åº¦);
        }
    }

    å®ç”¨å‘½ä»¤èœå•() {
        this.statusBarIcon = this.addStatusBarItem();
        this.statusBarIcon.addClass("Enhanced-statusbar-button");
        obsidian.addIcon("mdè¯­æ³•å›¾æ ‡", å…¨å±€å‘½ä»¤å›¾æ ‡);
        obsidian.setIcon(this.statusBarIcon, "mdè¯­æ³•å›¾æ ‡");
        this.registerDomEvent(this.statusBarIcon, "click", (e) => {
            const activePane = this.app.workspace.activeLeaf;
            let å½“å‰æ¨¡å¼ =activePane.getViewState();
            if (å½“å‰æ¨¡å¼.type === "empty") {
                return;
              }
		    if(å½“å‰æ¨¡å¼.state.mode == "preview"){
                this.app.commands.executeCommandById("markdown:toggle-preview");
            };

            const statusBarRect2 = this.statusBarIcon.parentElement.getBoundingClientRect();
            const statusBarIconRect2 = this.statusBarIcon.getBoundingClientRect();
            const menu = new obsidian.Menu(this.app);

            menu.addItem((item) => {
                item.setTitle("è®¾ç½®æ’ä»¶");
                item.setIcon("gear");
                item.onClick(() =>{
                    this.app.setting.open();
                    this.app.setting.openTabById("Enhanced-editing");
                });
            });
            menu.addItem((item) => {
                item.setTitle("æ‰“å¼€æ’ä»¶æ–‡ä»¶å¤¹");
                item.setIcon("gear");
                item.onClick(() =>{
                    this.app.openWithDefaultApp(this.app.vault.configDir + "/plugins");
                    console.log(this.app.vault.configDir + "/plugins");
                });
            });
            menu.addItem((item) => {
                item.setTitle("è®¾ç½®å¿«æ·é”®");
                item.setIcon("gear");
                item.onClick(() =>{
                    this.app.setting.open();
                    var e = this.app.setting.openTabById("hotkeys");
                    e.setQuery("å¢å¼ºç¼–è¾‘");
                });
            });
            menu.addItem((item) => {
                item.setTitle("å»é™¤æ‰€æœ‰ç©ºæ ¼");
                item.setIcon("bracket-glyph");
                item.onClick(() =>this.å»é™¤æ‰€æœ‰ç©ºæ ¼());
            });
            menu.addItem((item) => {
                item.setTitle("æ·»åŠ é—´éš”ç©ºæ ¼");
                item.setIcon("bracket-glyph");
                item.onClick(() =>this.æ·»åŠ é—´éš”ç©ºæ ¼());
            });
            menu.addItem((item) => {
                item.setTitle("è¡Œé¦–ç¼©è¿›ä¸¤å­—ç¬¦");
                item.setIcon("indent-glyph");
                item.onClick(() =>this.è¡Œé¦–ç¼©è¿›ä¸¤å­—ç¬¦());
            });
            menu.addItem((item) => {
                item.setTitle("æ‰¹é‡å»é™¤ç©ºè¡Œ");
                item.setIcon("expand-vertically");
                item.onClick(() =>this.æ‰¹é‡å»é™¤ç©ºè¡Œ());
            });
            menu.addItem((item) => {
                item.setTitle("æ‰¹é‡æ’å…¥ç©ºè¡Œ");
                item.setIcon("expand-vertically");
                item.onClick(() =>this.æ‰¹é‡æ’å…¥ç©ºè¡Œ());
            });
            menu.addItem((item) => {
                item.setTitle("æŠ˜å åŒçº§æ ‡é¢˜");
                item.setIcon("double-up-arrow-glyph");
                item.onClick(() =>this.æŠ˜å åŒçº§æ ‡é¢˜());
            });
            menu.addItem((item) => {
                item.setTitle("åµŒå…¥å½“å‰ç½‘å€");
                item.setIcon("link");
                item.onClick(() =>this.åµŒå…¥å½“å‰ç½‘å€é¡µé¢());
            });
            menu.addItem((item) => {
                item.setTitle("è·å–æœç´¢ç»“æœ");
                item.setIcon("link");
                item.onClick(() =>this.è·å–æœç´¢ç»“æœ());
            });
            menu.addItem((item) => {
                item.setTitle("è·å–å½“å‰å­—æ•°");
                item.setIcon("info");
                item.onClick(() =>this.è·å–å½“å‰å­—æ•°());
            });
            menu.addItem((item) => {
                item.setTitle("è‡ªåŠ¨è®¾ç½®æ ‡é¢˜");
                item.setIcon("heading-glyph");
                item.onClick(() =>this.è‡ªåŠ¨è®¾ç½®æ ‡é¢˜());
            });
            menu.addItem((item) => {
                item.setTitle("åˆ—è¡¨è½¬ä¸ºå›¾ç¤º");
                item.setIcon("dot-network");
                item.onClick(() =>this.åˆ—è¡¨è½¬ä¸ºå›¾ç¤º());
            });
            menu.addItem((item) => {
                item.setTitle("ä¿®å¤æ„å¤–æ–­è¡Œ");
                item.setIcon("indent-glyph");
                item.onClick(() =>this.ä¿®å¤æ„å¤–æ–­è¡Œ());
            });
            menu.addItem((item) => {
                item.setTitle("ä¿®å¤é”™è¯¯è¯­æ³•");
                item.setIcon("check-small");
                item.onClick(() =>this.ä¿®å¤é”™è¯¯è¯­æ³•());
            });
            menu.addItem((item) => {
                item.setTitle("æ‰¹é‡è½¬æ¢å†…é“¾");
                item.setIcon("broken-link");
                item.onClick(() =>this.æ‰¹é‡è½¬æ¢å†…é“¾());
            });
            menu.showAtPosition({
                x: statusBarIconRect2.right + 5,
                y: statusBarRect2.top - 10,
            });
        });
    }
 

    htmlè¯­æ³•æ ¼å¼åˆ·() {
        this.statusBarIcon = this.addStatusBarItem();
       
        this.statusBarIcon.addClass("ewt-statusbar-button");
        obsidian.addIcon("æ ¼å¼åˆ·å›¾æ ‡", æ ¼å¼åˆ·å›¾æ ‡);
        obsidian.addIcon("æ™®é€šæ ¼å¼åˆ·", æ™®é€šæ ¼å¼åˆ·);
        obsidian.setIcon(this.statusBarIcon, "æ ¼å¼åˆ·å›¾æ ‡");
        this.registerDomEvent(this.statusBarIcon, "click", (e) => {
            const æ ¼å¼åˆ·1 ='<svg t="1650117667147" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12959" width="120" height="120"><path d="M409.856 331.9296l103.1936-103.168 307.712 307.712-103.168 103.168z" fill="#777677" p-id="12960"></path><path d="M384 358.4s-153.6 128-256 99.84c23.04 38.4 53.76 76.8 51.2 79.36 79.36 17.92 204.8-51.2 204.8-51.2l25.6 25.6s-133.12 102.4-204.8 76.8c66.56 99.84 212.48 225.28 256 256 97.28 0 230.4-179.2 230.4-179.2L384 358.4z" fill="'+this.settings.bColor1+'" p-id="12961"></path><path d="M641.3568 306.9952l153.856-153.856 103.1936 103.168-153.856 153.856z" fill="#777677" p-id="12962"></path></svg>';
            const æ ¼å¼åˆ·2 ='<svg t="1650117667147" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12959" width="120" height="120"><path d="M409.856 331.9296l103.1936-103.168 307.712 307.712-103.168 103.168z" fill="#777677" p-id="12960"></path><path d="M384 358.4s-153.6 128-256 99.84c23.04 38.4 53.76 76.8 51.2 79.36 79.36 17.92 204.8-51.2 204.8-51.2l25.6 25.6s-133.12 102.4-204.8 76.8c66.56 99.84 212.48 225.28 256 256 97.28 0 230.4-179.2 230.4-179.2L384 358.4z" fill="'+this.settings.bColor2+'" p-id="12961"></path><path d="M641.3568 306.9952l153.856-153.856 103.1936 103.168-153.856 153.856z" fill="#777677" p-id="12962"></path></svg>';
            const æ ¼å¼åˆ·3 ='<svg t="1650117667147" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12959" width="120" height="120"><path d="M409.856 331.9296l103.1936-103.168 307.712 307.712-103.168 103.168z" fill="#777677" p-id="12960"></path><path d="M384 358.4s-153.6 128-256 99.84c23.04 38.4 53.76 76.8 51.2 79.36 79.36 17.92 204.8-51.2 204.8-51.2l25.6 25.6s-133.12 102.4-204.8 76.8c66.56 99.84 212.48 225.28 256 256 97.28 0 230.4-179.2 230.4-179.2L384 358.4z" fill="'+this.settings.bColor3+'" p-id="12961"></path><path d="M641.3568 306.9952l153.856-153.856 103.1936 103.168-153.856 153.856z" fill="#777677" p-id="12962"></path></svg>';
            const æ ¼å¼åˆ·4 ='<svg t="1650117667147" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12959" width="120" height="120"><path d="M409.856 331.9296l103.1936-103.168 307.712 307.712-103.168 103.168z" fill="#777677" p-id="12960"></path><path d="M384 358.4s-153.6 128-256 99.84c23.04 38.4 53.76 76.8 51.2 79.36 79.36 17.92 204.8-51.2 204.8-51.2l25.6 25.6s-133.12 102.4-204.8 76.8c66.56 99.84 212.48 225.28 256 256 97.28 0 230.4-179.2 230.4-179.2L384 358.4z" fill="'+this.settings.bColor4+'" p-id="12961"></path><path d="M641.3568 306.9952l153.856-153.856 103.1936 103.168-153.856 153.856z" fill="#777677" p-id="12962"></path></svg>';
            const æ ¼å¼åˆ·5 ='<svg t="1650117667147" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12959" width="120" height="120"><path d="M409.856 331.9296l103.1936-103.168 307.712 307.712-103.168 103.168z" fill="#777677" p-id="12960"></path><path d="M384 358.4s-153.6 128-256 99.84c23.04 38.4 53.76 76.8 51.2 79.36 79.36 17.92 204.8-51.2 204.8-51.2l25.6 25.6s-133.12 102.4-204.8 76.8c66.56 99.84 212.48 225.28 256 256 97.28 0 230.4-179.2 230.4-179.2L384 358.4z" fill="'+this.settings.bColor5+'" p-id="12961"></path><path d="M641.3568 306.9952l153.856-153.856 103.1936 103.168-153.856 153.856z" fill="#777677" p-id="12962"></path></svg>';
            
            const æ–‡æœ¬åˆ·1 ='<svg t="1650187348745" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="41653" ><path d="M126.656 832c0-35.2 28.8-64 64-64H832c35.2 0 64 28.8 64 64s-28.8 64-64 64H190.656c-35.2 0-64-28.8-64-64z" fill="'+this.settings.hColor1+'" p-id="41654"></path><path d="M587.2 151.936C582.208 138.752 567.04 128 553.472 128H470.528a39.232 39.232 0 0 0-33.792 23.936l-201.024 528.128c-4.992 13.184 2.432 23.936 16.512 23.936h85.76c14.08 0 29.632-10.816 34.496-24l29.632-80A39.616 39.616 0 0 1 436.608 576h150.784c14.08 0 29.632 10.816 34.496 24l29.632 80a39.616 39.616 0 0 0 34.496 24h85.76c14.08 0 21.504-10.752 16.512-23.936L587.2 151.936zM502.912 338.048c4.992-13.184 13.184-13.184 18.176 0l32.768 86.016c4.992 13.184-2.432 23.936-16.512 23.936h-50.688c-14.08 0-21.504-10.752-16.512-23.936l32.768-86.016z" fill="#A5A6A7" p-id="41655"></path></svg>';
            const æ–‡æœ¬åˆ·2 ='<svg t="1650187348745" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="41653" ><path d="M126.656 832c0-35.2 28.8-64 64-64H832c35.2 0 64 28.8 64 64s-28.8 64-64 64H190.656c-35.2 0-64-28.8-64-64z" fill="'+this.settings.hColor2+'" p-id="41654"></path><path d="M587.2 151.936C582.208 138.752 567.04 128 553.472 128H470.528a39.232 39.232 0 0 0-33.792 23.936l-201.024 528.128c-4.992 13.184 2.432 23.936 16.512 23.936h85.76c14.08 0 29.632-10.816 34.496-24l29.632-80A39.616 39.616 0 0 1 436.608 576h150.784c14.08 0 29.632 10.816 34.496 24l29.632 80a39.616 39.616 0 0 0 34.496 24h85.76c14.08 0 21.504-10.752 16.512-23.936L587.2 151.936zM502.912 338.048c4.992-13.184 13.184-13.184 18.176 0l32.768 86.016c4.992 13.184-2.432 23.936-16.512 23.936h-50.688c-14.08 0-21.504-10.752-16.512-23.936l32.768-86.016z" fill="#A5A6A7" p-id="41655"></path></svg>';
            const æ–‡æœ¬åˆ·3 ='<svg t="1650187348745" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="41653" ><path d="M126.656 832c0-35.2 28.8-64 64-64H832c35.2 0 64 28.8 64 64s-28.8 64-64 64H190.656c-35.2 0-64-28.8-64-64z" fill="'+this.settings.hColor3+'" p-id="41654"></path><path d="M587.2 151.936C582.208 138.752 567.04 128 553.472 128H470.528a39.232 39.232 0 0 0-33.792 23.936l-201.024 528.128c-4.992 13.184 2.432 23.936 16.512 23.936h85.76c14.08 0 29.632-10.816 34.496-24l29.632-80A39.616 39.616 0 0 1 436.608 576h150.784c14.08 0 29.632 10.816 34.496 24l29.632 80a39.616 39.616 0 0 0 34.496 24h85.76c14.08 0 21.504-10.752 16.512-23.936L587.2 151.936zM502.912 338.048c4.992-13.184 13.184-13.184 18.176 0l32.768 86.016c4.992 13.184-2.432 23.936-16.512 23.936h-50.688c-14.08 0-21.504-10.752-16.512-23.936l32.768-86.016z" fill="#A5A6A7" p-id="41655"></path></svg>';
            const æ–‡æœ¬åˆ·4 ='<svg t="1650187348745" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="41653" ><path d="M126.656 832c0-35.2 28.8-64 64-64H832c35.2 0 64 28.8 64 64s-28.8 64-64 64H190.656c-35.2 0-64-28.8-64-64z" fill="'+this.settings.hColor4+'" p-id="41654"></path><path d="M587.2 151.936C582.208 138.752 567.04 128 553.472 128H470.528a39.232 39.232 0 0 0-33.792 23.936l-201.024 528.128c-4.992 13.184 2.432 23.936 16.512 23.936h85.76c14.08 0 29.632-10.816 34.496-24l29.632-80A39.616 39.616 0 0 1 436.608 576h150.784c14.08 0 29.632 10.816 34.496 24l29.632 80a39.616 39.616 0 0 0 34.496 24h85.76c14.08 0 21.504-10.752 16.512-23.936L587.2 151.936zM502.912 338.048c4.992-13.184 13.184-13.184 18.176 0l32.768 86.016c4.992 13.184-2.432 23.936-16.512 23.936h-50.688c-14.08 0-21.504-10.752-16.512-23.936l32.768-86.016z" fill="#A5A6A7" p-id="41655"></path></svg>';
            const æ–‡æœ¬åˆ·5 ='<svg t="1650187348745" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="41653" ><path d="M126.656 832c0-35.2 28.8-64 64-64H832c35.2 0 64 28.8 64 64s-28.8 64-64 64H190.656c-35.2 0-64-28.8-64-64z" fill="'+this.settings.hColor5+'" p-id="41654"></path><path d="M587.2 151.936C582.208 138.752 567.04 128 553.472 128H470.528a39.232 39.232 0 0 0-33.792 23.936l-201.024 528.128c-4.992 13.184 2.432 23.936 16.512 23.936h85.76c14.08 0 29.632-10.816 34.496-24l29.632-80A39.616 39.616 0 0 1 436.608 576h150.784c14.08 0 29.632 10.816 34.496 24l29.632 80a39.616 39.616 0 0 0 34.496 24h85.76c14.08 0 21.504-10.752 16.512-23.936L587.2 151.936zM502.912 338.048c4.992-13.184 13.184-13.184 18.176 0l32.768 86.016c4.992 13.184-2.432 23.936-16.512 23.936h-50.688c-14.08 0-21.504-10.752-16.512-23.936l32.768-86.016z" fill="#A5A6A7" p-id="41655"></path></svg>';


            obsidian.addIcon("æ ¼å¼åˆ·1", æ ¼å¼åˆ·1);
            obsidian.addIcon("æ ¼å¼åˆ·2", æ ¼å¼åˆ·2);
            obsidian.addIcon("æ ¼å¼åˆ·3", æ ¼å¼åˆ·3);
            obsidian.addIcon("æ ¼å¼åˆ·4", æ ¼å¼åˆ·4);
            obsidian.addIcon("æ ¼å¼åˆ·5", æ ¼å¼åˆ·5);
            obsidian.addIcon("æ–‡æœ¬åˆ·1", æ–‡æœ¬åˆ·1);
            obsidian.addIcon("æ–‡æœ¬åˆ·2", æ–‡æœ¬åˆ·2);
            obsidian.addIcon("æ–‡æœ¬åˆ·3", æ–‡æœ¬åˆ·3);
            obsidian.addIcon("æ–‡æœ¬åˆ·4", æ–‡æœ¬åˆ·4);
            obsidian.addIcon("æ–‡æœ¬åˆ·5", æ–‡æœ¬åˆ·5);
            const activePane = this.app.workspace.activeLeaf;
            let å½“å‰æ¨¡å¼ =activePane.getViewState();
            if (å½“å‰æ¨¡å¼.type === "empty") {
                return;
              }
		    if(å½“å‰æ¨¡å¼.state.mode == "preview"){
            this.app.commands.executeCommandById("markdown:toggle-preview");
               };
            if(isCTxt ||isBgC ||isCTS || isGLS ||isGLS1 ||isGLS2 ||isGLS3 || isSB || isSCS || isXB || isXHS || isXTS|| isTHS ||isTCS||isWKS){
                this.å…³é—­æ ¼å¼åˆ·();
                new obsidian.Notice("å·²å…³é—­æ ¼å¼åˆ·ï¼");
            }

            const statusBarRect1 = this.statusBarIcon.parentElement.getBoundingClientRect();
            const statusBarIconRect1 = this.statusBarIcon.getBoundingClientRect();
            const menu = new obsidian.Menu(this.app);
            
            const menuDom = menu.dom;
            menuDom.addClass("Enhanced-editing-menu");

            menu.addItem((item) => {
                item.setTitle("è®¾ç½®æ’ä»¶");
                item.setIcon("gear");
                item.setSection("settings");
                item.onClick(() =>{
                    this.app.setting.open();
                    this.app.setting.openTabById("Enhanced-editing");
                });
            });
            menu.addItem((item) => {
                item.setTitle("è®¾ç½®å¿«æ·é”®");
                item.setIcon("gear");
                item.setSection("settings");
                item.onClick(() =>{
                    this.app.setting.open();
                    var e = this.app.setting.openTabById("hotkeys");
                    e.setQuery("å¢å¼ºç¼–è¾‘");
                });
            });
            /*
            menu.addItem((item) => {
                item.setTitle("æ‰“å¼€å¢å¼ºå‘½ä»¤");
                item.setIcon("gear");
                item.onClick(() =>{
                    //this.app.setting.open();
                    this.app.commands.executeCommandById('command-palette:open');
                });
            });
            */
            menu.addItem((item) => {
                item.setTitle("çº¯æ–‡æœ¬");
                item.setIcon("æ™®é€šæ ¼å¼åˆ·");
                item.setSection("format");
                item.onClick(() =>{
                    this.å…³é—­æ ¼å¼åˆ·();
                    isText = true;
                    new obsidian.Notice("çº¯æ–‡æœ¬æ ¼å¼åˆ· å·²æ‰“å¼€ï¼")
                });
            });
            menu.addItem((item) => {
                item.setTitle(" ä¸Šæ ‡âºâ»â¿ ");
                item.setIcon("æ™®é€šæ ¼å¼åˆ·");
                item.setSection("format");
                item.onClick(() =>this.ä¸Šæ ‡æ ¼å¼åˆ·());
            });
            menu.addItem((item) => {
                item.setTitle(" ä¸‹æ ‡â‚â‚‚â‚ƒ ");
                item.setIcon("æ™®é€šæ ¼å¼åˆ·");
                item.setSection("format");
                item.onClick(() =>this.ä¸‹æ ‡æ ¼å¼åˆ·());
            });
            menu.addItem((item) => {
                item.setTitle("~~åˆ é™¤çº¿~~");
                item.setIcon("æ™®é€šæ ¼å¼åˆ·");
                item.setSection("format");
                item.onClick(() =>this.åˆ é™¤çº¿æ ¼å¼åˆ·());
            });
            menu.addItem((item) => {
                item.setTitle(" *æ–œä½“* ");
                item.setIcon("æ™®é€šæ ¼å¼åˆ·");
                item.setSection("format");
                item.onClick(() =>this.æ–œä½“æ ¼å¼åˆ·());
            });
            menu.addItem((item) => {
                item.setTitle("**ç²—ä½“**");
                item.setIcon("æ™®é€šæ ¼å¼åˆ·");
                item.setSection("format");
                item.onClick(() =>this.ç²—ä½“æ ¼å¼åˆ·());
            });
            menu.addItem((item) => {
                item.setTitle("==é«˜äº®==");
                item.setIcon("æ™®é€šæ ¼å¼åˆ·");
                item.setSection("highlight");
                item.onClick(() =>this.é«˜äº®æ ¼å¼åˆ·());
            });
//å¦‚æœBtæ”¯æŒé€‰é¡¹å¼€å¯æ˜¾ç¤ºbtä¸»é¢˜è‡ªå¸¦çš„è¯­æ³•æ•ˆæœ
            if( this.settings.isBT)
            {
                menu.addItem((item) => {
                    item.setTitle("*==å¤šå½©é«˜äº®1==*");
                    item.setIcon("æ™®é€šæ ¼å¼åˆ·");
                    item.setSection("highlight");
                    item.onClick(() =>this.å¤šå½©é«˜äº®æ ¼å¼åˆ·1());
                });
                menu.addItem((item) => {
                    item.setTitle("**==å¤šå½©é«˜äº®2==**");
                    item.setIcon("æ™®é€šæ ¼å¼åˆ·");
                    item.setSection("highlight");
                    item.onClick(() =>this.å¤šå½©é«˜äº®æ ¼å¼åˆ·2());
                });
                menu.addItem((item) => {
                    item.setTitle("***==å¤šå½©é«˜äº®3==***");
                    item.setIcon("æ™®é€šæ ¼å¼åˆ·");
                    item.setSection("highlight");
                    item.onClick(() =>this.å¤šå½©é«˜äº®æ ¼å¼åˆ·3());
                });
                    menu.addItem((item) => {
                    item.setTitle("==~~æ¶‚é»‘~~==");
                    item.setIcon("æ™®é€šæ ¼å¼åˆ·");
                    item.setSection("paint");
                    item.onClick(() =>this.æ¶‚é»‘æ ¼å¼åˆ·());
                });
                menu.addItem((item) => {
                    item.setTitle("*==~~æ¶‚å½©~~==*");
                    item.setIcon("æ™®é€šæ ¼å¼åˆ·");
                    item.setSection("paint");
                    item.onClick(() =>this.æ¶‚å½©æ ¼å¼åˆ·());
                });
                menu.addItem((item) => {
                    item.setTitle("*~~æŒ–ç©º~~*");
                    item.setIcon("æ™®é€šæ ¼å¼åˆ·");
                    item.setSection("paint");
                    item.onClick(() =>this.æŒ–ç©ºæ ¼å¼åˆ·());
                });
            }
		
            /*
            menu.addItem((item) => {
                item.setTitle("å…³é—­ æ ¼å¼åˆ·");
                item.setIcon("cross");
                item.onClick(() =>{
                    this.å…³é—­æ ¼å¼åˆ·();
                    new obsidian.Notice("å·²å…³é—­æ ¼å¼åˆ·ï¼");
                });
            });*/

            menu.addItem((item) => {
                item.setIcon("æ–‡æœ¬åˆ·1");
                item.setSection("fontcolor");
                item.onClick(() => this.å½©å­—æ ¼å¼åˆ·(this.settings.hColor1,'æ–‡æœ¬é¢œè‰²1'));
            });

            menu.addItem((item) => {
                item.setIcon("æ–‡æœ¬åˆ·2");
                item.setSection("fontcolor");
                item.onClick(() => this.å½©å­—æ ¼å¼åˆ·(this.settings.hColor2,'æ–‡æœ¬é¢œè‰²2'));
            });

            menu.addItem((item) => {
                item.setIcon("æ–‡æœ¬åˆ·3");
                item.setSection("fontcolor");
                item.onClick(() => this.å½©å­—æ ¼å¼åˆ·(this.settings.hColor3,'æ–‡æœ¬é¢œè‰²3'));
            });
            menu.addItem((item) => {
                item.setIcon("æ–‡æœ¬åˆ·4");
                item.setSection("fontcolor");
                item.onClick(() => this.å½©å­—æ ¼å¼åˆ·(this.settings.hColor4,'æ–‡æœ¬é¢œè‰²4'));
            });
            menu.addItem((item) => {
                item.setIcon("æ–‡æœ¬åˆ·5");
                item.setSection("fontcolor");
                item.onClick(() => this.å½©å­—æ ¼å¼åˆ·(this.settings.hColor5,'æ–‡æœ¬é¢œè‰²5'));
            });

            menu.addItem((item) => {
                item.setIcon("æ ¼å¼åˆ·1");
                item.setSection("highlight_html");
                item.onClick(() => this.å½©å­—æ ¼å¼åˆ·(this.settings.bColor1,'è§å…‰ç¬”1'));
            });
            menu.addItem((item) => {
                item.setIcon("æ ¼å¼åˆ·2");
                item.setSection("highlight_html");
                item.onClick(() => this.å½©å­—æ ¼å¼åˆ·(this.settings.bColor2,'è§å…‰ç¬”2'));
            });
            menu.addItem((item) => {
                item.setIcon("æ ¼å¼åˆ·3");
                item.setSection("highlight_html");
                item.onClick(() => this.å½©å­—æ ¼å¼åˆ·(this.settings.bColor3,'è§å…‰ç¬”3'));
            });
            menu.addItem((item) => {
                item.setIcon("æ ¼å¼åˆ·4");
                item.setSection("highlight_html");
                item.onClick(() => this.å½©å­—æ ¼å¼åˆ·(this.settings.bColor4,'è§å…‰ç¬”4'));
            });
            menu.addItem((item) => {
                item.setIcon("æ ¼å¼åˆ·5");
                item.setSection("highlight_html");
                item.onClick(() => this.å½©å­—æ ¼å¼åˆ·(this.settings.bColor5,'è§å…‰ç¬”5'));
            });



            menu.showAtPosition({
                x: statusBarIconRect1.right + 5,
                y: statusBarRect1.top - 10,
            });
        });

        
    }


    onunload() {
        console.log('å¸è½½æ’ä»¶');
    }

    async loadSettings() {
        console.log('åŠ è½½äº†é…ç½®');
        this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
     
    }
    async saveSettings() {
        await this.saveData(this.settings);
    }
    
    /** ä»¥ä¸‹ä¸ºåŸºç¡€åŠŸèƒ½å‡½æ•° */
    
    è·å–æ‰€é€‰æ–‡æœ¬() {
        var cmEditor = this.è·å–ç¼–è¾‘æ¨¡å¼ ();
        if (!cmEditor) return;
        if (cmEditor.getSelection() == "") {
       		return null;
        } else {
            return cmEditor.getSelection();
        }
    };
    

    è·å–ç¬”è®°æ­£æ–‡() {
        var cmEditor = this.è·å–ç¼–è¾‘æ¨¡å¼ ();
    	if (!cmEditor) return;
        return cmEditor.getValue();
    };

    æ›¿æ¢æ‰€é€‰æ–‡æœ¬(Selection) {
        var cmEditor = this.è·å–ç¼–è¾‘æ¨¡å¼ ();
        if(Selection==null){
            return;
        }else{
            cmEditor.replaceSelection(Selection);
        };
    };

    æ›¿æ¢ç¬”è®°æ­£æ–‡(lines) {
        var cmEditor = this.è·å–ç¼–è¾‘æ¨¡å¼ ();
        if (cmEditor.getSelection() == "") {
            cmEditor.setValue(lines);
        } else {
            cmEditor.replaceSelection(lines);
        }
    };

    è·å–ç¼–è¾‘æ¨¡å¼() {
        let view = this.app.workspace.getActiveViewOfType(obsidian.MarkdownView);
        if (!view){return;};
        //let cmEditor = view.sourceMode.cmEditor;
        let cmEditor = view.editor;
        return cmEditor;
    };

    è·å–ç¼–è¾‘å™¨ä¿¡æ¯() {
        //åˆå§‹ä¿¡æ¯è·å–ï¼Œæœ€åŸºæœ¬å‡½æ•°
        ç¼–è¾‘æ¨¡å¼ = this.è·å–ç¼–è¾‘æ¨¡å¼ ();
        if(ç¼–è¾‘æ¨¡å¼ == null){return;};
        èšç„¦ç¼–è¾‘ = ç¼–è¾‘æ¨¡å¼.hasFocus();
        ç¬”è®°å…¨æ–‡ = ç¼–è¾‘æ¨¡å¼.getDoc();
        ç¬”è®°æ­£æ–‡ = this.è·å–ç¬”è®°æ­£æ–‡ ();
        æ‰€é€‰æ–‡æœ¬ = this.è·å–æ‰€é€‰æ–‡æœ¬ ();
        å½“å‰å…‰æ ‡ = ç¼–è¾‘æ¨¡å¼.getCursor();
        å½“å‰è¡Œå· = å½“å‰å…‰æ ‡.line;
        å½“å‰è¡Œæ–‡æœ¬ = ç¼–è¾‘æ¨¡å¼.getLine(å½“å‰è¡Œå·);
        é€‰è‡³è¡Œé¦– = ç¼–è¾‘æ¨¡å¼.getRange({line:å½“å‰è¡Œå·,ch:0}, å½“å‰å…‰æ ‡);
        if(å½“å‰è¡Œæ–‡æœ¬!=""){
            é€‰è‡³è¡Œå°¾ = ç¼–è¾‘æ¨¡å¼.getRange(å½“å‰å…‰æ ‡,{line:å½“å‰è¡Œå·,ch:å½“å‰è¡Œæ–‡æœ¬.length});
        }else{
            é€‰è‡³è¡Œå°¾ = ç¼–è¾‘æ¨¡å¼.getRange(å½“å‰å…‰æ ‡,{line:å½“å‰è¡Œå·,ch:0});
        };        
        
        æœ«è¡Œè¡Œå· = ç¼–è¾‘æ¨¡å¼.lastLine();
        æœ«è¡Œæ–‡æœ¬ = ç¼–è¾‘æ¨¡å¼.getLine(æœ«è¡Œè¡Œå·);
        é€‰è‡³æ–‡é¦– = ç¼–è¾‘æ¨¡å¼.getRange({line:0,ch:0},å½“å‰å…‰æ ‡);
        if(æœ«è¡Œæ–‡æœ¬!=""){
            é€‰è‡³æ–‡æœ« = ç¼–è¾‘æ¨¡å¼.getRange(å½“å‰å…‰æ ‡,{line:æœ«è¡Œè¡Œå·,ch:æœ«è¡Œæ–‡æœ¬.length});
        }else{
            é€‰è‡³æ–‡æœ« = ç¼–è¾‘æ¨¡å¼.getRange(å½“å‰å…‰æ ‡,{line:æœ«è¡Œè¡Œå·,ch:0});
        };
    };

    /** ä»¥ä¸‹ä¸ºè‡ªå®šä¹‰åŠŸèƒ½å‡½æ•° */
    å…‰æ ‡è·³è½¬(æ–¹å‘) {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        //var é€‰æ‹©å­—æ•°=0;
        var è¡¨è¾¾å¼;
        if(ç¼–è¾‘æ¨¡å¼ == null){return;};
        //new obsidian.Notice(æ‰€é€‰æ–‡æœ¬+"\n"+å½“å‰è¡Œæ–‡æœ¬);
        if(æ‰€é€‰æ–‡æœ¬==null){
            var æ ‡é¢˜å¼1 = /^\s*# [^#]+$/;
            var æ ‡é¢˜å¼2 = /^\s*## [^#]+$/;
            var æ ‡é¢˜å¼3 = /^\s*### [^#]+$/;
            var æ ‡é¢˜å¼4 = /^\s*#### [^#]+$/;
            var æ ‡é¢˜å¼5 = /^\s*##### [^#]+$/;
            var æ ‡é¢˜å¼6 = /^\s*###### [^#]+$/;
            var åˆ—è¡¨å¼1 = /^(\- [^\[]|\d+\. ).*$/;
            var åˆ—è¡¨å¼2 = /^(\s{4}|\t)(\- [^\[]|\d+\. ).*$/;
            var åˆ—è¡¨å¼3 = /^(\s{8}|\t\t)(\- [^\[]|\d+\. ).*$/;
            var åˆ—è¡¨å¼4 = /^(\s{12}|\t\t\t)(\- [^\[]|\d+\. ).*$/;
            var å¾…åŠå¼ = /^\s*\- \[[^\[\]]] .*$/;
            var ä»£ç å¼ = /^```[^`]*$/;
            var å¼•ç”¨å¼ = /^\>.*$/;
            if(æ ‡é¢˜å¼1.test(å½“å‰è¡Œæ–‡æœ¬)){
                è¡¨è¾¾å¼ = æ ‡é¢˜å¼1;
            }if(æ ‡é¢˜å¼2.test(å½“å‰è¡Œæ–‡æœ¬)){
                è¡¨è¾¾å¼ = æ ‡é¢˜å¼2;
            }if(æ ‡é¢˜å¼3.test(å½“å‰è¡Œæ–‡æœ¬)){
                è¡¨è¾¾å¼ = æ ‡é¢˜å¼3;
            }if(æ ‡é¢˜å¼4.test(å½“å‰è¡Œæ–‡æœ¬)){
                è¡¨è¾¾å¼ = æ ‡é¢˜å¼4;
            }if(æ ‡é¢˜å¼5.test(å½“å‰è¡Œæ–‡æœ¬)){
                è¡¨è¾¾å¼ = æ ‡é¢˜å¼5;
            }if(æ ‡é¢˜å¼6.test(å½“å‰è¡Œæ–‡æœ¬)){
                è¡¨è¾¾å¼ = æ ‡é¢˜å¼6;
            }else if(å¾…åŠå¼.test(å½“å‰è¡Œæ–‡æœ¬)){
                è¡¨è¾¾å¼ = å¾…åŠå¼;
            }else if(åˆ—è¡¨å¼1.test(å½“å‰è¡Œæ–‡æœ¬)){
                è¡¨è¾¾å¼ = åˆ—è¡¨å¼1;
            }else if(åˆ—è¡¨å¼2.test(å½“å‰è¡Œæ–‡æœ¬)){
                è¡¨è¾¾å¼ = åˆ—è¡¨å¼2;
            }else if(åˆ—è¡¨å¼3.test(å½“å‰è¡Œæ–‡æœ¬)){
                è¡¨è¾¾å¼ = åˆ—è¡¨å¼3;
            }else if(åˆ—è¡¨å¼4.test(å½“å‰è¡Œæ–‡æœ¬)){
                è¡¨è¾¾å¼ = åˆ—è¡¨å¼4;
            }else if(ä»£ç å¼.test(å½“å‰è¡Œæ–‡æœ¬)){
                è¡¨è¾¾å¼ = ä»£ç å¼;
            }else if(å¼•ç”¨å¼.test(å½“å‰è¡Œæ–‡æœ¬)){
                è¡¨è¾¾å¼ = å¼•ç”¨å¼;
            }else{
                return;
            }
            console.log('è¡¨è¾¾å¼ '+è¡¨è¾¾å¼);
            //é€è¡Œåˆ¤æ–­æ˜¯å¦ç¬¦åˆæŒ‡å®šè¡¨è¾¾å¼
            for (var i=1;i<=æœ«è¡Œè¡Œå·;i++){
                var æ–°è¡Œå·;
                if(æ–¹å‘=="ä¸‹"){
                    æ–°è¡Œå·= å½“å‰è¡Œå·+i;
                }else if(æ–¹å‘=="ä¸Š"){
                    æ–°è¡Œå·= å½“å‰è¡Œå·-i;
                };
                if(æ–°è¡Œå·<0 || æ–°è¡Œå·>æœ«è¡Œè¡Œå·){
                    return;
                }
                var ä¸´æ—¶è¡Œæ–‡æœ¬ = ç¼–è¾‘æ¨¡å¼.getLine(æ–°è¡Œå·);
                if(è¡¨è¾¾å¼.test(ä¸´æ—¶è¡Œæ–‡æœ¬)){
                    ç¼–è¾‘æ¨¡å¼.setCursor({line:æ–°è¡Œå·,ch:ä¸´æ—¶è¡Œæ–‡æœ¬.length});
                    break
                };
            };
        }else{
            var æœç´¢èŒƒå›´="";
            var åŠ ç²—å¼ = /^\*\*[^\*]+\*\*$/;
            var é«˜äº®å¼ = /^==[^=]+==$/;
            var æ³¨é‡Šå¼ = /^%%[^%]*%%$/;
            var åˆ é™¤å¼ = /^~~[^~]*~~$/;
            var é“¾æ¥å¼ = /^\[\[[^\[\]]+\]\]$/;
            if(åŠ ç²—å¼.test(æ‰€é€‰æ–‡æœ¬)){
                è¡¨è¾¾å¼ = /\*\*[^\*]+\*\*/g;
            }else if(é«˜äº®å¼.test(æ‰€é€‰æ–‡æœ¬)){
                è¡¨è¾¾å¼ = /==[^=]+==/g;
            }else if(æ³¨é‡Šå¼.test(æ‰€é€‰æ–‡æœ¬)){
                è¡¨è¾¾å¼ = /%%[^%]*%%/g;
            }else if(åˆ é™¤å¼.test(æ‰€é€‰æ–‡æœ¬)){
                è¡¨è¾¾å¼ = /~~[^~]*~~/g;
            }else if(é“¾æ¥å¼.test(æ‰€é€‰æ–‡æœ¬)){
                è¡¨è¾¾å¼ = /\[\[[^\[\]]+\]\]/g;
            }else{
                è¡¨è¾¾å¼ = æ‰€é€‰æ–‡æœ¬;
            }
            console.log('è¡¨è¾¾å¼ '+è¡¨è¾¾å¼);
            é€‰è‡³æ–‡é¦– = ç¼–è¾‘æ¨¡å¼.getRange({line:0,ch:0},å½“å‰å…‰æ ‡);
            var ä»¥å‰å­—æ•° = é€‰è‡³æ–‡é¦–.length;
            var è¿”å›ä½ç½® = 0;
            var æœç´¢ç»“æœ,èµ·å§‹ä½ç½®,ç»“æŸä½ç½®;
            if(æ–¹å‘=="ä¸‹"){
                æœç´¢èŒƒå›´ = ç¼–è¾‘æ¨¡å¼.getRange(å½“å‰å…‰æ ‡,{line:æœ«è¡Œè¡Œå·,ch:æœ«è¡Œæ–‡æœ¬.length});
                è¿”å›ä½ç½® = æœç´¢èŒƒå›´.search(è¡¨è¾¾å¼);
                if(è¿”å›ä½ç½®<0){
                    return
                };
                æœç´¢ç»“æœ = æœç´¢èŒƒå›´.match(è¡¨è¾¾å¼)[0];
                //new obsidian.Notice(æœç´¢ç»“æœ.length);
                èµ·å§‹ä½ç½® = ä»¥å‰å­—æ•°+è¿”å›ä½ç½®;
                ç»“æŸä½ç½® = èµ·å§‹ä½ç½®+æœç´¢ç»“æœ.length;
                ç¼–è¾‘æ¨¡å¼.setSelection({line:0,ch:èµ·å§‹ä½ç½®}, {line:0,ch:ç»“æŸä½ç½®});
            }else if(æ–¹å‘=="ä¸Š"){
                æœç´¢èŒƒå›´ = ç¼–è¾‘æ¨¡å¼.getRange({line:0,ch:0},{line:å½“å‰å…‰æ ‡.line,ch:å½“å‰å…‰æ ‡.ch-æ‰€é€‰æ–‡æœ¬.length});
                if(æœç´¢èŒƒå›´.search(è¡¨è¾¾å¼)<0){
                    return
                };
                æœç´¢ç»“æœ = æœç´¢èŒƒå›´.match(è¡¨è¾¾å¼).pop();
                è¿”å›ä½ç½® = æœç´¢èŒƒå›´.lastIndexOf(æœç´¢ç»“æœ);
                //new obsidian.Notice(æœç´¢ç»“æœ);
                ç»“æŸä½ç½® = è¿”å›ä½ç½®+æœç´¢ç»“æœ.length;
                ç¼–è¾‘æ¨¡å¼.setSelection({line:0,ch:è¿”å›ä½ç½®}, {line:0,ch:ç»“æŸä½ç½®});
            };
        }
    }

    async å·¦çª—å‘ä¸Šæ»šåŠ¨(){
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        //ç¼–è¾‘æ¨¡å¼.setLine(å½“å‰è¡Œå·,"è¿™æ˜¯ä¸€è¡Œæµ‹è¯•æ–‡æœ¬ï¼ä½¿ç”¨setLineå‡½æ•°æŒ‡å®šå½“å‰è¡Œå†…å®¹");

        await this.app.commands.executeCommandById('editor:focus-left');
        let newWin = this.è·å–ç¼–è¾‘æ¨¡å¼ ();
        let yy = newWin.getScrollInfo().top;
        newWin.scrollTo(0,yy-this.settings.maxScroll);

        await this.app.commands.executeCommandById('editor:focus-right');
        let oldpos = {line:å½“å‰å…‰æ ‡.line,ch:å½“å‰å…‰æ ‡.ch};
        await this.app.workspace.activeLeaf.view.editor.setSelection({line:0,ch:0},oldpos);
        await this.app.workspace.activeLeaf.view.editor.exec("goRight");
    }

    async å·¦çª—å‘ä¸‹æ»šåŠ¨(){
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();

        await this.app.commands.executeCommandById('editor:focus-left');
        let newWin = this.è·å–ç¼–è¾‘æ¨¡å¼ ();
        let yy = newWin.getScrollInfo().top;
        newWin.scrollTo(0,yy+this.settings.maxScroll);

        await this.app.commands.executeCommandById('editor:focus-right');
        let oldpos = {line:å½“å‰å…‰æ ‡.line,ch:å½“å‰å…‰æ ‡.ch};
        await this.app.workspace.activeLeaf.view.editor.setSelection({line:0,ch:0},oldpos);
        await this.app.workspace.activeLeaf.view.editor.exec("goRight");
    }

    å…³é—­æ ¼å¼åˆ·() {
        newNotice.hide();
        //å…³é—­æ‰€æœ‰æ ¼å¼åˆ·å˜é‡
        isText = false; //çº¯æ–‡æœ¬
        isBgC = false;  //å¤šå½©èƒŒæ™¯åˆ·
        isCTxt = false; //å¤šå½©æ–‡å­—åˆ·
        isGLS =false;   //==æ™®é€šé«˜äº®==
		isGLS1 =false;   ///*==å¤šå½©é«˜äº®==*
		isGLS2 =false;   ///**==å¤šå½©é«˜äº®==**
		isGLS3 =false;   ///***==å¤šå½©é«˜äº®==***
        isCTS =false;   //**ç²—ä½“**
        isXTS = false;  //*æ–œä½“*
        isSCS = false;  //~~åˆ é™¤çº¿~~
        isXHS = false;
        isSB = false;
        isXB = false;
		
		isTHS = false; //æ¶‚é»‘
		isTCS = false; //æ¶‚å½©
		isWKS = false; //æŒ–ç©º
        
    };

    æ¸¸æ ‡ä¸Šç§»() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        ç¼–è¾‘æ¨¡å¼.exec("goUp");
    };
    æ¸¸æ ‡ä¸‹ç§»() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        ç¼–è¾‘æ¨¡å¼.exec("goDown");
    };
    æ¸¸æ ‡å·¦ç§»() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(/(==|\*\*|~~|%%|\[\[|\]\])$/.test(é€‰è‡³è¡Œé¦–)){
            ç¼–è¾‘æ¨¡å¼.exec("goLeft");
            ç¼–è¾‘æ¨¡å¼.exec("goLeft");
        }else{
            ç¼–è¾‘æ¨¡å¼.exec("goLeft");
        };
    };
    æ¸¸æ ‡å³ç§»() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(/^(==|\*\*|~~|%%|\[\[|\]\])/.test(é€‰è‡³è¡Œå°¾)){
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else{
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        };
    };
    æ¸¸æ ‡ç§»è‡³è¡Œé¦–() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        ç¼–è¾‘æ¨¡å¼.setCursor({line:å½“å‰è¡Œå·,ch:0});
    };
    æ¸¸æ ‡ç§»è‡³è¡Œå°¾() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        ç¼–è¾‘æ¨¡å¼.setCursor({line:å½“å‰è¡Œå·,ch:å½“å‰è¡Œæ–‡æœ¬.length});
    };
    æ¸¸æ ‡ç§»è‡³æ–‡é¦–() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        ç¼–è¾‘æ¨¡å¼.exec("goStart");
    };
    æ¸¸æ ‡ç§»è‡³æ–‡æœ«() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        ç¼–è¾‘æ¨¡å¼.exec("goEnd");
    };

    åˆ‡æ¢æ–‡ä»¶åˆ—è¡¨(_num) {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        å½“å‰æ–‡ä»¶ = this.app.workspace.getActiveFile();
        å½“å‰æ–‡ä»¶è·¯å¾„ = å½“å‰æ–‡ä»¶.path;
        var çˆ¶çº§æ–‡ä»¶å¤¹ = å½“å‰æ–‡ä»¶è·¯å¾„.replace(/[^\\\/]+$/,"");
        
        var åŒçº§æ–‡ä»¶åˆ—è¡¨=[];
        this.app.vault.getMarkdownFiles().map((file) => {
            if(file.path==çˆ¶çº§æ–‡ä»¶å¤¹+file.basename+".md"){
                åŒçº§æ–‡ä»¶åˆ—è¡¨.push(file);
            }
        });
        åŒçº§æ–‡ä»¶åˆ—è¡¨ = åŒçº§æ–‡ä»¶åˆ—è¡¨.sort(function (str1, str2) {
            return str1.path.localeCompare(str2.path, 'zh');
            });
        //new obsidian.Notice(åŒçº§æ–‡ä»¶åˆ—è¡¨.join("\n"));
        var thisID = åŒçº§æ–‡ä»¶åˆ—è¡¨.indexOf(å½“å‰æ–‡ä»¶)+_num;
        if(thisID>åŒçº§æ–‡ä»¶åˆ—è¡¨.length-1){
            thisID=0;
        }else if(thisID<0){
            thisID=åŒçº§æ–‡ä»¶åˆ—è¡¨.length-1;
        }
        var xinFile = åŒçº§æ–‡ä»¶åˆ—è¡¨[thisID];
        //new obsidian.Notice(çˆ¶çº§æ–‡ä»¶å¤¹+" "+thisID+" "+xinFile);
        this.app.workspace.activeLeaf.openFile(xinFile);
    };

    æ‰¹é‡è½¬æ¢å†…é“¾() {
        let fileNameAry = [];
        for (const file of this.app.vault.getMarkdownFiles()) {
            fileNameAry.push(file.basename);
        };
        fileNameAry.sort().reverse();
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<=\[\[[^\[\]]*)([^\[\]])(?=[^\[\]]*\]\])/g,"$1âš˜");
        for (const oldStr of fileNameAry){
            let xinStr = oldStr.replace(/([^âš˜])/g,"$1âš˜");  //âš˜
            ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(oldStr,"[["+xinStr+"]]");
        };
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/âš˜/g,"");
        this.æ›¿æ¢ç¬”è®°æ­£æ–‡(ç¬”è®°æ­£æ–‡);
        new obsidian.Notice("æ½œåœ¨é“¾æ¥å·²å…¨éƒ¨è½¬æ¢ï¼\nå¯ä»¥ Ctrl+Z æ’¤æ¶ˆã€‚");
    };

    è½¬æ¢æ ‡ç­¾() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            return;
        };

        let tagReg = /(^|\s)#([^#\s]+)(\s|\r*\n|$)/g;	//æ˜¯å¦åŒ…å«[]()åŠæ ‡ç‚¹ç¬¦å·
	  	if (tagReg.test(æ‰€é€‰æ–‡æœ¬)) {
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(tagReg, "$2");
		}else{
			æ‰€é€‰æ–‡æœ¬ = " #" + æ‰€é€‰æ–‡æœ¬ + " ";
		}
        this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);        
    };

    è½¬æ¢å†…éƒ¨é“¾æ¥() {
        let æç¤ºè¯­="";
        let æ—§æ–‡æœ¬="";
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            let lreg = /\[\[([^\[\]]*)$/;
            let rreg = /^([^\[\]]*)\]\]/;
            if(lreg.test(é€‰è‡³è¡Œé¦–) && rreg.test(é€‰è‡³è¡Œå°¾)){
                //å½“å‰å…‰æ ‡å‰åæœ‰[[]]é“¾æ¥ç¬¦å·
                let å‰æ–‡æœ¬ = é€‰è‡³è¡Œé¦–.match(lreg)[0];
                let åæ–‡æœ¬ = é€‰è‡³è¡Œå°¾.match(rreg)[0];
                ç¼–è¾‘æ¨¡å¼.setSelection({line:å½“å‰å…‰æ ‡.line,ch:Number(å½“å‰å…‰æ ‡.ch-å‰æ–‡æœ¬.length)}, {line:å½“å‰å…‰æ ‡.line,ch:Number(å½“å‰å…‰æ ‡.ch+åæ–‡æœ¬.length)});
                æ‰€é€‰æ–‡æœ¬ = ç¼–è¾‘æ¨¡å¼.getRange({line:å½“å‰å…‰æ ‡.line,ch:Number(å½“å‰å…‰æ ‡.ch-å‰æ–‡æœ¬.length)}, {line:å½“å‰å…‰æ ‡.line,ch:Number(å½“å‰å…‰æ ‡.ch+åæ–‡æœ¬.length)});
            }else{
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ ("[[");
                return;
            };
        };
        æ—§æ–‡æœ¬=æ‰€é€‰æ–‡æœ¬;

        var link = /[\"\|\[\]\?\\\*\<\>\/:]/g;	//æ˜¯å¦åŒ…å«[]()åŠæ ‡ç‚¹ç¬¦å·
        var link1 = /^([^\[\]]*)!\[+([^\[\]]*)$|^([^\[\]]*)\[+([^\[\]]*)$|^([^\[\]]*)\]+([^\[\]]*)$|^([^\[\]]*)\[([^\[\]]*)\]([^\[\]]*)$/g;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„[[æˆ–]]
  		var link2 = /^[^\[\]]*(\[\[[^\[\]]*\]\][^\[\]]*)+$/g;	//æ˜¯å¦åŒ…å«Nç»„æˆå¯¹çš„å†…é“¾è¯­æ³•
  		var link4 = /([^\[\]\(\)\r\n]*)(\n*)(http.*)/mg;	//æ˜¯å¦åŒ…å« è¯´æ˜æ–‡æœ¬&ç½‘å€
	  	var link5 = /!?\[([^\[\]\r\n]*)(\n*)\]\((http[^\(\)]*)\)/mg;	//æ˜¯å¦åŒ…å« [è¯´æ˜æ–‡æœ¬](ç½‘å€)
  		var link8 = /([ã€\n])/g;
	  	if (link.test(æ‰€é€‰æ–‡æœ¬)) {
	  		if (link1.test(æ‰€é€‰æ–‡æœ¬)){
                new obsidian.Notice("åˆ’é€‰å†…å®¹ä¸ç¬¦åˆå†…é“¾è¯­æ³•æ ¼å¼ï¼");
	  			return;
	  		}else if (link2.test(æ‰€é€‰æ–‡æœ¬)){
                æç¤ºè¯­="å†…å®¹åŒ…å«å†…é“¾è¯­æ³•æ ¼å¼ï¼Œå·²ç»å»é™¤[[]]ï¼";
	  			æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/(\[\[(.*\|)*)/g,"");
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\]\]/g,"");
	  		}else if(link5.test(æ‰€é€‰æ–‡æœ¬)){
	  			æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(link5,"$1$3");
                æç¤ºè¯­="å†…å®¹åŒ…å«æœ‰[]()é“¾æ¥è¯­æ³•ï¼Œå·²ç»å»é™¤ç¬¦å·ï¼";
	  		}else if(link4.test(æ‰€é€‰æ–‡æœ¬)){
	  			æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(link4,"[$1]($3)");
	  			æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace("[\r\n]","");
                æç¤ºè¯­="å†…å®¹åŒ…å«æœ‰è¯´æ˜æ–‡æœ¬å’Œç½‘å€ï¼Œå·²ç»è½¬æ¢ï¼";
	  		}else{
                new obsidian.Notice("æ–‡ä»¶åä¸èƒ½åŒ…å«ä¸‹åˆ—å­—ç¬¦:\*\"\\\/\<\>\:\|\?");
                return;
            }
		}else{
            æç¤ºè¯­="å†…å®¹æœªåŒ…å«å†…é“¾è¯­æ³•æ ¼å¼ï¼Œéœ€è¦è½¬æ¢";
			if (link8.test(æ‰€é€‰æ–‡æœ¬)){
				æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(link8, "]]$1[[");
			}
			æ‰€é€‰æ–‡æœ¬ = "[[" + æ‰€é€‰æ–‡æœ¬ + "]]";
		}
        console.log("æ‚¨åˆ’é€‰äº† "+æ—§æ–‡æœ¬+"\n"+æç¤ºè¯­);
        this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);        
    };

    è½¬æ¢åŒä¹‰é“¾æ¥() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ ("[[");
            return;
        }
        var lNum = æ‰€é€‰æ–‡æœ¬.length +3
        var link = /[\"\|\[\]\?\\\*\<\>\/:\n]/g;	//æ˜¯å¦åŒ…å«[]()åŠæ ‡ç‚¹ç¬¦å·
  	  	if (link.test(æ‰€é€‰æ–‡æœ¬)) {
            return;
		}else{
			æ‰€é€‰æ–‡æœ¬ = "[[|" + æ‰€é€‰æ–‡æœ¬ + "]]";
		}
        this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
        
        var i=0;
        while (i<lNum){
            ç¼–è¾‘æ¨¡å¼.exec("goLeft");
            i++;
        }
    };

    ç²—ä½“æ ¼å¼åˆ·() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isCTS){
                isCTS = false;
                this.å…³é—­æ ¼å¼åˆ·();
                new obsidian.Notice("å·²å…³é—­ç²—ä½“æ ¼å¼åˆ·ï¼");
            }else{
                this.å…³é—­æ ¼å¼åˆ·();
                isCTS = true;
                newNotice = new obsidian.Notice("**ç²—ä½“æ ¼å¼åˆ·** å·²æ‰“å¼€ï¼\né¦–å°¾ä¸è¦é€‰ä¸­æ ‡ç‚¹ã€‚",0);
            };
        };
    };

    è½¬æ¢ç²—ä½“() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isGLS){
                isGLS = false;
                newNotice.hide();
                new obsidian.Notice("å·²å…³é—­ç²—ä½“æ ¼å¼åˆ·ï¼");
            }
            ç¬”è®°å…¨æ–‡.replaceRange("****", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else{
            var link = /.*(\<b\>|\*\*)([^\*]*)(\<\/b\>|\*\*).*/g;	//æ˜¯å¦åŒ…å«åŠ ç²—ç¬¦å·
            var link1 = /^[^\*](\<\/?b\>|\*\*)[^\*]*$/;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„**
            if (link1.test(æ‰€é€‰æ–‡æœ¬)){
                return; //new obsidian.Notice("åªæœ‰ä¸€ä¾§å‡ºç°==ç¬¦å·");
            }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/(\<\/?b\>|\*\*)/g,"");    //new obsidian.Notice("æˆå¯¹å‡ºç°**ç¬¦å·");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
            }else{
                if(/^\<.*\>$/.test(æ‰€é€‰æ–‡æœ¬) || /[,\.?!ï¼Œã€‚ã€ï¼Ÿï¼]$/.test(æ‰€é€‰æ–‡æœ¬)){
                    æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^/,"<b>");
                    æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/$/,"</b>");
                }else{
                    æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^([\t\s]*)([^\t\s])/mg,"$1**$2").replace(/([^\t\s])([\t\s]*)$/mg,"$1**$2");
                    æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^\*\*\*\*$/mg,"");
                }
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
                ç¼–è¾‘æ¨¡å¼.exec("goRight");
            }
        }
    };

    é«˜äº®æ ¼å¼åˆ·() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isGLS){
                this.å…³é—­æ ¼å¼åˆ·();
                new obsidian.Notice("å·²å…³é—­é«˜äº®æ ¼å¼åˆ·ï¼");
            }else{
                this.å…³é—­æ ¼å¼åˆ·();
                isGLS = true;
                newNotice = new obsidian.Notice("==é«˜äº®æ ¼å¼åˆ·== å·²æ‰“å¼€ï¼",0);
            }
        }
    }
	å¤šå½©é«˜äº®æ ¼å¼åˆ·1() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isGLS1){
                this.å…³é—­æ ¼å¼åˆ·();
                new obsidian.Notice("å·²å…³é—­å¤šå½©é«˜äº®åˆ·1ï¼");
            }else{
                this.å…³é—­æ ¼å¼åˆ·();
                isGLS1 = true;
                newNotice = new obsidian.Notice("*==å¤šå½©é«˜äº®åˆ·1==*  å·²æ‰“å¼€ï¼",0);
            }
        }
    }
	å¤šå½©é«˜äº®æ ¼å¼åˆ·2() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isGLS2){
                this.å…³é—­æ ¼å¼åˆ·();
                new obsidian.Notice("å·²å…³é—­å½©é«˜äº®åˆ·2ï¼");
            }else{
                this.å…³é—­æ ¼å¼åˆ·();
                isGLS2 = true;
                newNotice = new obsidian.Notice("**==å¤šå½©é«˜äº®åˆ·2==** å·²æ‰“å¼€ï¼",0);
            }
        }
    }	
	å¤šå½©é«˜äº®æ ¼å¼åˆ·3() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isGLS3){
                this.å…³é—­æ ¼å¼åˆ·();
                new obsidian.Notice("å·²å…³é—­å¤šå½©é«˜äº®åˆ·3ï¼");
            }else{
                this.å…³é—­æ ¼å¼åˆ·();
                isGLS3 = true;
                newNotice = new obsidian.Notice("***==å¤šå½©é«˜äº®åˆ·3==*** å·²æ‰“å¼€ï¼",0);
            }
        }
    }
	
	æ¶‚é»‘æ ¼å¼åˆ·() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isTHS){
                this.å…³é—­æ ¼å¼åˆ·();
                new obsidian.Notice("å·²å…³é—­æ¶‚é»‘æ ¼å¼åˆ·ï¼");
            }else{
                this.å…³é—­æ ¼å¼åˆ·();
                isTHS = true;
                newNotice = new obsidian.Notice("==~~æ¶‚é»‘~~==å·²æ‰“å¼€ï¼",0);
            }
        }
    }
	æ¶‚å½©æ ¼å¼åˆ·() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isTCS){
                this.å…³é—­æ ¼å¼åˆ·();
                new obsidian.Notice("å·²å…³é—­æ¶‚å½©æ ¼å¼åˆ·ï¼");
            }else{
                this.å…³é—­æ ¼å¼åˆ·();
                isTCS = true;
                newNotice = new obsidian.Notice("*==~~æ¶‚å½©~~==* å·²æ‰“å¼€ï¼",0);
            }
        }
    }	
	æŒ–ç©ºæ ¼å¼åˆ·() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isWKS){
                this.å…³é—­æ ¼å¼åˆ·();
                new obsidian.Notice("å·²å…³é—­æŒ–ç©ºæ ¼å¼åˆ·ï¼");
            }else{
                this.å…³é—­æ ¼å¼åˆ·();
                isWKS = true;
                newNotice = new obsidian.Notice("*~~æŒ–ç©º~~* å·²æ‰“å¼€ï¼",0);
            }
        }
    }
	
	
    è½¬æ¢é«˜äº®() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isGLS){
                isGLS = false;
                newNotice.hide();
                new obsidian.Notice("å·²å…³é—­é«˜äº®æ ¼å¼åˆ·ï¼");
            }
            ç¬”è®°å…¨æ–‡.replaceRange("====", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else{
            var link = /==[^=]*==/;	//æ˜¯å¦åŒ…å«é«˜äº®ç¬¦å·
            var link1 = /^[^=]*==[^=]*$/;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„==
            if (link1.test(æ‰€é€‰æ–‡æœ¬)){
                return; //new obsidian.Notice("åªæœ‰ä¸€ä¾§å‡ºç°==ç¬¦å·");
            }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/==/g,"");    //new obsidian.Notice("æˆå¯¹å‡ºç°==ç¬¦å·");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
            }else{
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^([\t\s]*)([^\t\s])/mg,"$1==$2").replace(/([^\t\s])([\t\s]*)$/mg,"$1==$2");
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^====$/mg,"");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
                ç¼–è¾‘æ¨¡å¼.exec("goRight");
            }
        }
    };
	
    è½¬æ¢é«˜äº®1() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isGLS1){
                isGLS1 = false;
                newNotice.hide();
                new obsidian.Notice("å·²å…³é—­é«˜äº®æ ¼å¼åˆ·ï¼");
            }
            ç¬”è®°å…¨æ–‡.replaceRange("*====*", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
			ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else{
            var link = /\*==[^=]*==\*/;	//æ˜¯å¦åŒ…å«é«˜äº®ç¬¦å·
            var link1 = /^[^=]*==[^=]*$/;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„==
			var isbank =/[ ]$/; //æœ«å°¾æ˜¯å¦æœ‰ç©ºæ ¼
            if (link1.test(æ‰€é€‰æ–‡æœ¬)){
                return; //new obsidian.Notice("åªæœ‰ä¸€ä¾§å‡ºç°*==ç¬¦å·");
            }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
				if (isbank.test(æ‰€é€‰æ–‡æœ¬))
				æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\*==|==\*/g,"");
				else
				æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\ *==|\*==|==\* |==\*/g,""); //new obsidian.Notice("å‡ºç°*== æˆ–è€…==*ç¬¦å·");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
            }else{
				if (isbank.test(æ‰€é€‰æ–‡æœ¬))
				æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^([\t\s]*)([^\t\s])/mg,"$1*==$2").replace(/([^\t\s])([\t\s]*)$/mg,"$1==*$2");
				else
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^([\t\s]*)([^\t\s])/mg,"$1 *==$2").replace(/([^\t\s])([\t\s]*)$/mg,"$1==* $2");
				
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^\*====\*$/mg,"");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
                ç¼–è¾‘æ¨¡å¼.exec("goRight");
            }
        }
    };
	
    è½¬æ¢é«˜äº®2() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
             if(isGLS2){
                isGLS2 = false;
                newNotice.hide();
                new obsidian.Notice("å·²å…³é—­é«˜äº®æ ¼å¼åˆ·ï¼");
            }
            ç¬”è®°å…¨æ–‡.replaceRange("**====**", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
			ç¼–è¾‘æ¨¡å¼.exec("goRight");
			ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else{
            var link = /\*\*==[^=]*==\*\*/;	//æ˜¯å¦åŒ…å«é«˜äº®ç¬¦å·
            var link1 = /^[^=]*==[^=]*$/;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„==
			var isbank =/[ ]$/; //æœ«å°¾æ˜¯å¦æœ‰ç©ºæ ¼
            if (link1.test(æ‰€é€‰æ–‡æœ¬)){
                return; //new obsidian.Notice("åªæœ‰ä¸€ä¾§å‡ºç°**==ç¬¦å·");
            }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
				if (isbank.test(æ‰€é€‰æ–‡æœ¬))
				æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\*\*==|==\*\*/g,"");
				else
				æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/ \*\*==|\*\*==|==\*\* |==\*\*/g,""); //new obsidian.Notice("å‡ºç°*== æˆ–è€…==*ç¬¦å·");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
            }else{
				if (isbank.test(æ‰€é€‰æ–‡æœ¬))
				æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^([\t\s]*)([^\t\s])/mg,"$1**==$2").replace(/([^\t\s])([\t\s]*)$/mg,"$1==**$2");
				else
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^([\t\s]*)([^\t\s])/mg,"$1 **==$2").replace(/([^\t\s])([\t\s]*)$/mg,"$1==** $2");
				
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^\*\*====\*\*$/mg,"");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
                ç¼–è¾‘æ¨¡å¼.exec("goRight");
            }
        }
    };
		
    è½¬æ¢é«˜äº®3() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
         if(æ‰€é€‰æ–‡æœ¬==null){
             if(isGLS2){
                isGLS2 = false;
                newNotice.hide();
                new obsidian.Notice("å·²å…³é—­é«˜äº®æ ¼å¼åˆ·ï¼");
            }
            ç¬”è®°å…¨æ–‡.replaceRange("***====***", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
			ç¼–è¾‘æ¨¡å¼.exec("goRight");
			ç¼–è¾‘æ¨¡å¼.exec("goRight");
			ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else{
            var link = /\*\*==[^=]*==\*\*/;	//æ˜¯å¦åŒ…å«é«˜äº®ç¬¦å·
            var link1 = /^[^=]*==[^=]*$/;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„==
			var isbank =/[ ]$/; //æœ«å°¾æ˜¯å¦æœ‰ç©ºæ ¼
            if (link1.test(æ‰€é€‰æ–‡æœ¬)){
                return; //new obsidian.Notice("åªæœ‰ä¸€ä¾§å‡ºç°**==ç¬¦å·");
            }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
				if (isbank.test(æ‰€é€‰æ–‡æœ¬))
				æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\*\*\*==|==\*\*\*/g,"");
				else
				æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/ \*\*\*==|\*\*\*==|==\*\*\* |==\*\*\*/g,""); //new obsidian.Notice("å‡ºç°*== æˆ–è€…==*ç¬¦å·");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
            }else{
				if (isbank.test(æ‰€é€‰æ–‡æœ¬))
				æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^([\t\s]*)([^\t\s])/mg,"$1***==$2").replace(/([^\t\s])([\t\s]*)$/mg,"$1==***$2");
				else
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^([\t\s]*)([^\t\s])/mg,"$1 ***==$2").replace(/([^\t\s])([\t\s]*)$/mg,"$1==*** $2");
				
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^\*\*\*====\*\*\*$/mg,"");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
                ç¼–è¾‘æ¨¡å¼.exec("goRight");
            }
        }
    };
	
	 è½¬æ¢æ¶‚é»‘() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
         if(æ‰€é€‰æ–‡æœ¬==null){
             if(isTHS){
                isTHS = false;
                newNotice.hide();
                new obsidian.Notice("å·²å…³é—­æ¶‚é»‘æ ¼å¼åˆ·ï¼");
            }
            ç¬”è®°å…¨æ–‡.replaceRange("==~~~~==", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
			ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else{
            var link = /==~~[^~=]*~~==/;	//æ˜¯å¦åŒ…å«é«˜äº®ç¬¦å·
            var link1 = /^[^=]*==[^=]*$/;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„==
            if (link1.test(æ‰€é€‰æ–‡æœ¬)){
                return; //new obsidian.Notice("åªæœ‰ä¸€ä¾§å‡ºç°**==ç¬¦å·");
            }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
				æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/==~~|==~~ |~~==/g,""); //new obsidian.Notice("å‡ºç°*== æˆ–è€…==*ç¬¦å·");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
            }else{
			
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^([\t\s]*)([^\t\s])/mg,"$1==~~$2").replace(/([^\t\s])([\t\s]*)$/mg,"$1~~==$2");		
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^==~~~~==$/mg,"");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
                ç¼–è¾‘æ¨¡å¼.exec("goRight");
            }
        }
    };
	 è½¬æ¢æ¶‚å½©() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
         if(æ‰€é€‰æ–‡æœ¬==null){
             if(isTCS){
                isTCS = false;
                newNotice.hide();
                new obsidian.Notice("å·²å…³é—­æ¶‚å½©æ ¼å¼åˆ·ï¼");
            }
            ç¬”è®°å…¨æ–‡.replaceRange(" *==~~~~==* ", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
			ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
			ç¼–è¾‘æ¨¡å¼.exec("goRight");
			ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else{
            var link = /\*==~~[^=]*~~==\*/;	//æ˜¯å¦åŒ…å«é«˜äº®ç¬¦å·
            var link1 = /^[^=]*==[^=]*$/;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„==
			var isbank =/[ ]$/; //æœ«å°¾æ˜¯å¦æœ‰ç©ºæ ¼
            if (link1.test(æ‰€é€‰æ–‡æœ¬)){
                return; //new obsidian.Notice("åªæœ‰ä¸€ä¾§å‡ºç°**==ç¬¦å·");
            }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
				if (isbank.test(æ‰€é€‰æ–‡æœ¬))
				æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\*==~~|~~==\*/g,"");
				else
				æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\*==~~| \*==~~|~~==\* |~~==\*/g,""); //new obsidian.Notice("å‡ºç°*== æˆ–è€…==*ç¬¦å·");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
            }else{
				if (isbank.test(æ‰€é€‰æ–‡æœ¬))
				æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^([\t\s]*)([^\t\s])/mg,"$1*==~~$2").replace(/([^\t\s])([\t\s]*)$/mg,"$1~~==*$2");
				else
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^([\t\s]*)([^\t\s])/mg,"$1 *==~~$2").replace(/([^\t\s])([\t\s]*)$/mg,"$1~~==* $2");
				
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^\*==~~~~==\*$/mg,"");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
                ç¼–è¾‘æ¨¡å¼.exec("goRight");
            }
        }
    };
	 è½¬æ¢æŒ–ç©º() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
         if(æ‰€é€‰æ–‡æœ¬==null){
             if(isWKS){
                isWKS = false;
                newNotice.hide();
                new obsidian.Notice("å·²å…³é—­æŒ–ç©ºæ ¼å¼åˆ·ï¼");
            }
            ç¬”è®°å…¨æ–‡.replaceRange(" *~~~~* ", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
			ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else{
            var link = /\*~~[^~]*~~\*/;	//æ˜¯å¦åŒ…å«é«˜äº®ç¬¦å·
            var link1 = /^[^~]*~~[^~]*$/;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„==
			var isbank =/[ ]$/; //æœ«å°¾æ˜¯å¦æœ‰ç©ºæ ¼
            if (link1.test(æ‰€é€‰æ–‡æœ¬)){
                return; //new obsidian.Notice("åªæœ‰ä¸€ä¾§å‡ºç°**==ç¬¦å·");
            }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
				if (isbank.test(æ‰€é€‰æ–‡æœ¬))
				æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\*~~|~~\*/g,"");
				else
				æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/ \*~~|\*~~|~~\* |~~\*/g,""); //new obsidian.Notice("å‡ºç°*== æˆ–è€…==*ç¬¦å·");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
            }else{
				if (isbank.test(æ‰€é€‰æ–‡æœ¬))
				æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^([\t\s]*)([^\t\s])/mg,"$1*~~$2").replace(/([^\t\s])([\t\s]*)$/mg,"$1~~*$2");
				else
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^([\t\s]*)([^\t\s])/mg,"$1 *~~$2").replace(/([^\t\s])([\t\s]*)$/mg,"$1~~* $2");
				
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^\*~~~~\*$/mg,"");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
                ç¼–è¾‘æ¨¡å¼.exec("goRight");
            }
        }
    };
    
    æ–œä½“æ ¼å¼åˆ·(){
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isXTS){
                this.å…³é—­æ ¼å¼åˆ·();
                new obsidian.Notice("å·²å…³é—­æ ¼å¼åˆ·ï¼");
            }else{
                this.å…³é—­æ ¼å¼åˆ·();
                isXTS = true;
                newNotice = new obsidian.Notice("*æ–œä½“æ ¼å¼åˆ·* å·²æ‰“å¼€ï¼\né¦–å°¾ä¸è¦é€‰ä¸­æ ‡ç‚¹ã€‚",0);
            }
        };
    };
    è½¬æ¢æ–œä½“() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isXTS){
                isXTS = false;
                newNotice.hide();
                new obsidian.Notice("å·²å…³é—­æ–œä½“æ ¼å¼åˆ·ï¼");
            }
            ç¬”è®°å…¨æ–‡.replaceRange("**", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else{
            var link = /\*[^\*]*\*/;	//æ˜¯å¦åŒ…å«é«˜äº®ç¬¦å·
            var link1 = /^[^\*]*\*[^\*]*$/;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„\*
            if (link1.test(æ‰€é€‰æ–‡æœ¬)){
                return; //new obsidian.Notice("åªæœ‰ä¸€ä¾§å‡ºç°\*ç¬¦å·");
            }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\*/g,"");    //new obsidian.Notice("æˆå¯¹å‡ºç°\*ç¬¦å·");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
            }else{
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^(.*)$/mg,"\*$1\*");
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^\*\*$/mg,"");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
                ç¼–è¾‘æ¨¡å¼.exec("goRight");
            }
        }
    };

    åˆ é™¤çº¿æ ¼å¼åˆ·(){
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isSCS){
                this.å…³é—­æ ¼å¼åˆ·();
                new obsidian.Notice("å·²å…³é—­åˆ é™¤çº¿æ ¼å¼åˆ·ï¼");
            }else{
                this.å…³é—­æ ¼å¼åˆ·();
                isSCS = true;
                newNotice = new obsidian.Notice("~~åˆ é™¤çº¿æ ¼å¼åˆ·~~ å·²æ‰“å¼€ï¼",0);
            }
        }
    };
    è½¬æ¢åˆ é™¤çº¿() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isSCS){
                isSCS = false;
                newNotice.hide();
                new obsidian.Notice("å·²å…³é—­åˆ é™¤çº¿æ ¼å¼åˆ·ï¼");
            }
            ç¬”è®°å…¨æ–‡.replaceRange("~~~~", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else{
            var link = /~~[^~]*~~/;	//æ˜¯å¦åŒ…å«åˆ é™¤çº¿ç¬¦å·
            var link1 = /^[^~]*~~[^~]*$/;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„~~
            if (link1.test(æ‰€é€‰æ–‡æœ¬)){
                return; //new obsidian.Notice("åªæœ‰ä¸€ä¾§å‡ºç°~~ç¬¦å·");
            }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/~~/g,"");    //new obsidian.Notice("æˆå¯¹å‡ºç°~~ç¬¦å·");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
            }else{
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^(.*)$/mg,"~~$1~~");
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^~~~~$/mg,"");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
                ç¼–è¾‘æ¨¡å¼.exec("goRight");
            }
        }
        
    };

    ä¸‹åˆ’çº¿æ ¼å¼åˆ·(){
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isXHS){
                this.å…³é—­æ ¼å¼åˆ·();
                new obsidian.Notice("å·²å…³é—­ä¸‹åˆ’çº¿æ ¼å¼åˆ·ï¼");
            }else{
                this.å…³é—­æ ¼å¼åˆ·();
                isXHS = true;
                newNotice = new obsidian.Notice("<u>ä¸‹åˆ’çº¿æ ¼å¼åˆ·</u> å·²æ‰“å¼€ï¼",0);
            }
        }
    };

    è½¬æ¢ä¸‹åˆ’çº¿() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isXHS){
                isXHS = false;
                newNotice.hide();
                new obsidian.Notice("å·²å…³é—­ä¸‹åˆ’çº¿æ ¼å¼åˆ·ï¼");
            }
            ç¬”è®°å…¨æ–‡.replaceRange("<u></u>", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else{
            var link = /\<u\>([^\<\>]*)\<\/u\>/mg;	//æ˜¯å¦åŒ…å«ä¸‹åˆ’ç¬¦å·
            var link1 = /^[^\<\>]*\<\/?u\>[^\<\>]*$/;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„<>
            if (link1.test(æ‰€é€‰æ–‡æœ¬)){
                return; //new obsidian.Notice("åªæœ‰ä¸€ä¾§å‡ºç°<>ç¬¦å·");
            }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(link,"$1");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
            }else{
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^(.*)$/mg,"<u>$1</u>");
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^\<u\>\<\/u\>$/mg,"");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
                ç¼–è¾‘æ¨¡å¼.exec("goRight");
            }
        }
    };


    è½¬æ¢è¡Œå†…ä»£ç () {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            ç¬”è®°å…¨æ–‡.replaceRange("``", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else{
            var link = /`[^`]*`/;	//æ˜¯å¦åŒ…å«ä»£ç è¡Œç¬¦å·
            var link1 = /^[^`]*`[^`]*$/;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„`
    
            if (link1.test(æ‰€é€‰æ–‡æœ¬)){
                //new obsidian.Notice("åªæœ‰ä¸€ä¾§å‡ºç°`ç¬¦å·");
                return;
            }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
                //new obsidian.Notice("æˆå¯¹å‡ºç°`ç¬¦å·");
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/`/g,"");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
            }else{
                //new obsidian.Notice("éœ€è¦è¡¥å……`ç¬¦å·");
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^(.*)$/mg,"`$1`");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
                ç¼–è¾‘æ¨¡å¼.exec("goRight");
            }
        };
    };

    è½¬æ¢ä»£ç å—() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            ç¬”è®°å…¨æ–‡.replaceRange("```\n\n```", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goDown");
        }else{
            var link = /```[^`]+```/;	//æ˜¯å¦åŒ…å«ä»£ç è¡Œç¬¦å·
            var link1 = /^[^`]*```[^`]*$/m;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„`
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\n/g,"â†«");
            if (link1.test(æ‰€é€‰æ–‡æœ¬)){
                //new obsidian.Notice("åªæœ‰ä¸€ä¾§å‡ºç°```ç¬¦å·");
                return;
            }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
                //new obsidian.Notice("æˆå¯¹å‡ºç°```ç¬¦å·");
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/â†«*```â†«?|â†«?```â†«*/g,"");
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/â†«/g,"\n");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
            }else{
                //new obsidian.Notice("éœ€è¦è¡¥å……```ç¬¦å·");
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^(.*)$/m,"â†«```â†«$1â†«```â†«");
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/â†«/g,"\n");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
                ç¼–è¾‘æ¨¡å¼.exec("goLeft");
                ç¼–è¾‘æ¨¡å¼.exec("goUp");
            }
        };
    };

    è½¬æ¢ä¸‰æµªçº¿() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        var link = /~~~[^~]+~~~/;	//æ˜¯å¦åŒ…å«ä»£ç è¡Œç¬¦å·
        var link1 = /^[^~]*~~~[^~]*$/m;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„~
        if(æ‰€é€‰æ–‡æœ¬==null){return};
        æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\n/g,"â†«");
        if (link1.test(æ‰€é€‰æ–‡æœ¬)){
            //new obsidian.Notice("åªæœ‰ä¸€ä¾§å‡ºç°~~~ç¬¦å·");
            return;
        }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
            //new obsidian.Notice("æˆå¯¹å‡ºç°~~~ç¬¦å·");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/~~~â†«?|â†«?~~~/g,"");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/â†«/g,"\n");
            this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
        }else{
            //new obsidian.Notice("éœ€è¦è¡¥å……~~~ç¬¦å·");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^(.*)$/m,"~~~â†«$1â†«~~~");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/â†«/g,"\n");
            this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }
    };
    

    ä¸Šæ ‡æ ¼å¼åˆ·(){
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isSB){
                this.å…³é—­æ ¼å¼åˆ·();
                new obsidian.Notice("å·²å…³é—­ä¸Šæ ‡æ ¼å¼åˆ·ï¼");
            }else{
                this.å…³é—­æ ¼å¼åˆ·();
                isSB = true;
                newNotice = new obsidian.Notice("<sup>ä¸Šæ ‡æ ¼å¼åˆ·</sup> å·²æ‰“å¼€ï¼",0);
            }
        }
    };
    è½¬æ¢ä¸Šæ ‡() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isSB){
                isSB = false;
                newNotice.hide();
                new obsidian.Notice("å·²å…³é—­ä¸Šæ ‡æ ¼å¼åˆ·ï¼");
            }
            ç¬”è®°å…¨æ–‡.replaceRange("<sup></sup>", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.setCursor({line:å½“å‰è¡Œå·,ch:Number(å½“å‰å…‰æ ‡.ch+5)});
        }else{
            var link = /\<sup\>[^\<\>]*\<\/sup\>/g;	//æ˜¯å¦åŒ…å«<sup>ä¸‹æ ‡</sup>
            var link1 = /\<sup\>[^\<\>\/]*$|^[^\<\>]*\<\/sup\>/g;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„<sup>ä¸‹æ ‡</sup>
            if (link1.test(æ‰€é€‰æ–‡æœ¬)){
                //new obsidian.Notice("åªæœ‰ä¸€ä¾§å‡ºç°<sup>ä¸‹æ ‡</sup>ç¬¦å·");
                return;
            }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/(\<sup\>|\<\/sup\>)/g,"");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
            }else{
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^(.+)$/mg,"\<sup\>$1\<\/sup\>");
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^\<sup\>\s*\<\/sup\>$/mg,"");
                this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
                ç¼–è¾‘æ¨¡å¼.exec("goRight");
            }
        };
    };

    ä¸‹æ ‡æ ¼å¼åˆ·(){
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isXB){
                this.å…³é—­æ ¼å¼åˆ·();
                new obsidian.Notice("å·²å…³é—­ä¸‹æ ‡æ ¼å¼åˆ·ï¼");
            }else{
                this.å…³é—­æ ¼å¼åˆ·();
                isXB = true;
                newNotice = new obsidian.Notice("<sub>ä¸‹æ ‡æ ¼å¼åˆ·</sub> å·²æ‰“å¼€ï¼",0);
            }
        }
    };
    è½¬æ¢ä¸‹æ ‡() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            if(isXB){
                isXB = false;
                newNotice.hide();
                new obsidian.Notice("å·²å…³é—­ä¸‹æ ‡æ ¼å¼åˆ·ï¼");
            }
            ç¬”è®°å…¨æ–‡.replaceRange("<sub></sub>", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.setCursor({line:å½“å‰è¡Œå·,ch:Number(å½“å‰å…‰æ ‡.ch+5)});
        }else{
            var link = /\<sub\>[^\<\>]*\<\/sub\>/g;	//æ˜¯å¦åŒ…å«<sub>ä¸‹æ ‡</sub>
            var link1 = /\<sub\>[^\<\>\/]*$|^[^\<\>]*\<\/sub\>/g;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„<sub>ä¸‹æ ‡</sub>
            if (link1.test(æ‰€é€‰æ–‡æœ¬)){
                return;
            }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/(\<sub\>|\<\/sub\>)/g,"");
            }else{
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^(.+)$/mg,"\<sub\>$1\<\/sub\>");
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^\<sub\>\s*\<\/sub\>$/mg,"");
            }
            this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        };
    };

    è½¬æ¢å¡«ç©º() {
        var link = /\{\{c\d+::[^\{\}]+\}\}/ig;	//æ˜¯å¦åŒ…å«{{c*::}}
        var link1 = /\{\{c[^\{\}]*$|^[^\{\}]*\}\}/ig;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„{{c*::}}
        var cs=[];
        var clinks="";
        var lastId=1;
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        
        if (link1.test(æ‰€é€‰æ–‡æœ¬)){
            return;
        }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/(\{\{c\d::|\}\})/g,"");
        }else{
            if(link.test(ç¬”è®°æ­£æ–‡)){
                cs = ç¬”è®°æ­£æ–‡.match(link);
                clinks = cs.toString().replace(/\{\{c/ig,"").replace(/::[^\}]+\}\}/ig,"");
                new obsidian.Notice(clinks);
                lastId = Number(clinks.split(",").sort().pop())+1;
                new obsidian.Notice(lastId);
            }
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^(.+)$/m,"{{c"+lastId+"::$1}}");
        }
        this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
    };

    é€‰æ‹©å½“å‰æ•´æ®µ () {    
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(å½“å‰è¡Œæ–‡æœ¬!=""){
            ç¼–è¾‘æ¨¡å¼.setSelection({line:å½“å‰è¡Œå·,ch:0}, {line:å½“å‰è¡Œå·,ch:å½“å‰è¡Œæ–‡æœ¬.length});
        };
    };

    é€‰æ‹©å½“å‰æ•´å¥ () {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        var å¥å‰ = é€‰è‡³è¡Œé¦–.match(/(?<=(^|[ã€‚ï¼Ÿï¼]))[^ã€‚ï¼Ÿï¼]*$/);
        var å¥å = é€‰è‡³è¡Œå°¾.match(/^[^ã€‚ï¼Ÿï¼]*([ã€‚ï¼Ÿï¼]|$)/);
        if(å¥å‰==null && å¥å==null){
            ç¼–è¾‘æ¨¡å¼.setSelection({line:å½“å‰è¡Œå·,ch:0}, {line:å½“å‰è¡Œå·,ch:å½“å‰è¡Œæ–‡æœ¬.length});
        }else{
            var _length1 = é€‰è‡³è¡Œé¦–.length-å¥å‰[0].length;
            var _length2 = é€‰è‡³è¡Œé¦–.length+å¥å[0].length;
            //new obsidian.Notice(å¥å‰+"\nå…‰æ ‡\n"+å¥å);
            ç¼–è¾‘æ¨¡å¼.setSelection({line:å½“å‰è¡Œå·,ch:_length1}, {line:å½“å‰è¡Œå·,ch:_length2});
        }
    };

    é€‰æ‹©å½“å‰è¯­æ³• () {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){
            var å¥å‰ = é€‰è‡³è¡Œé¦–.match(/(^|\*\*|==|~~|%%|\[\[)[^\*=~%\[\]]*$/);
            var å¥å = é€‰è‡³è¡Œå°¾.match(/^[^\*=~%\[\]]*(\*\*|==|~~|%%|\]\]|$)/);
            if(å¥å‰==null ||å¥å==null){
                return;
            }else{
                var _length1 = é€‰è‡³è¡Œé¦–.length-å¥å‰[0].length;
                var _length2 = é€‰è‡³è¡Œé¦–.length+å¥å[0].length;
                //new obsidian.Notice(å¥å‰+"\nå…‰æ ‡\n"+å¥å);
                ç¼–è¾‘æ¨¡å¼.setSelection({line:å½“å‰è¡Œå·,ch:_length1}, {line:å½“å‰è¡Œå·,ch:_length2});
            };
        }else if(/^(\*\*|==|~~|%%|\[\[)[^\*=~%\[\]]*(\*\*|==|~~|%%|\]\])$/.test(æ‰€é€‰æ–‡æœ¬)){
            this.é€‰æ‹©å½“å‰æ•´å¥ ();
        }
    };

    é‡å¤å½“å‰è¡Œ () {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        var æ–°è¡Œæ–‡æœ¬ = "\n" + å½“å‰è¡Œæ–‡æœ¬;
        ç¬”è®°å…¨æ–‡.replaceRange(æ–°è¡Œæ–‡æœ¬, {line:å½“å‰è¡Œå·,ch:å½“å‰è¡Œæ–‡æœ¬.length}, {line:å½“å‰è¡Œå·,ch:å½“å‰è¡Œæ–‡æœ¬.length});
    };

    æ™ºèƒ½ç¬¦å· () {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        let è½¬æ¢æ–‡æœ¬ = "";
        var æ ‡å‰ä¸¤å­— = ç¼–è¾‘æ¨¡å¼.getRange({line:å½“å‰è¡Œå·,ch:é€‰è‡³è¡Œé¦–.length-2}, å½“å‰å…‰æ ‡);
        var æ ‡åä¸¤å­— = ç¼–è¾‘æ¨¡å¼.getRange(å½“å‰å…‰æ ‡,{line:å½“å‰è¡Œå·,ch:é€‰è‡³è¡Œé¦–.length+2});
        //new obsidian.Notice("æ ‡å‰ä¸¤å­—\n"+æ ‡å‰ä¸¤å­—+"\n\næ ‡åä¸¤å­—ï¼š\n"+æ ‡åä¸¤å­—);

        if(é€‰è‡³è¡Œå°¾.match(/^(\]\]|\=\=|\*\*|\~\~)/)){
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");   //å¦‚æœä¸‹ä¸ªå­—ç¬¦æ˜¯åæ‹¬å·ï¼Œåˆ™è·ƒè¿‡
        }else if(é€‰è‡³è¡Œå°¾.match(/^[$ã€‹ã€‰ï¼½ï½ã€‘ã€—ã€•ã€ã€ï¼‰}\)]/)){
            ç¼–è¾‘æ¨¡å¼.exec("goRight");   //å¦‚æœä¸‹ä¸ªå­—ç¬¦æ˜¯åæ‹¬å·ï¼Œåˆ™è·ƒè¿‡
        }else if(æ ‡å‰ä¸¤å­—.match(/^[ã€\[][ï¼ˆ\(]$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("ã€–", {line:å½“å‰è¡Œå·,ch:é€‰è‡³è¡Œé¦–.length-2}, å½“å‰å…‰æ ‡);
        }else if(æ ‡å‰ä¸¤å­—.match(/^[ï¼ˆ\(][ã€Š\<]$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("ã€ˆ", {line:å½“å‰è¡Œå·,ch:é€‰è‡³è¡Œé¦–.length-2}, å½“å‰å…‰æ ‡);
        }else if(æ ‡å‰ä¸¤å­—.match(/^[\(ï¼ˆ][ã€\[]$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("ã€”", {line:å½“å‰è¡Œå·,ch:é€‰è‡³è¡Œé¦–.length-2}, å½“å‰å…‰æ ‡);
        }else if(æ ‡å‰ä¸¤å­—.match(/^[â€œ\"][ã€\[]$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("ã€", {line:å½“å‰è¡Œå·,ch:é€‰è‡³è¡Œé¦–.length-2}, å½“å‰å…‰æ ‡);
        }else if(æ ‡å‰ä¸¤å­—.match(/^[â€˜\'][ã€\[]$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("ã€Œ", {line:å½“å‰è¡Œå·,ch:é€‰è‡³è¡Œé¦–.length-2}, å½“å‰å…‰æ ‡);
        }else if(æ ‡å‰ä¸¤å­—.match(/^â€¦â€¦$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("^", {line:å½“å‰è¡Œå·,ch:é€‰è‡³è¡Œé¦–.length-2}, å½“å‰å…‰æ ‡);
        }else if(æ ‡å‰ä¸¤å­—.match(/^ï¿¥ï¿¥$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("$$", {line:å½“å‰è¡Œå·,ch:é€‰è‡³è¡Œé¦–.length-2}, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goLeft");
        }else if(é€‰è‡³è¡Œé¦–.match(/ã€Š[^ã€Šã€‹ã€ˆã€‰ï½›ï½ã€ã€‘ã€–ã€—ã€”ã€•ï¼ˆï¼‰ã€ã€ã€Œã€]*$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("ã€‹", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else if(é€‰è‡³è¡Œé¦–.match(/ã€ˆ[^ã€Šã€‹ã€ˆã€‰ï¼»ï¼½ï½›ï½ã€ã€‘ã€–ã€—ã€”ã€•ï¼ˆï¼‰ã€ã€ã€Œã€]*$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("ã€‰", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else if(é€‰è‡³è¡Œé¦–.match(/ï¼»[^ã€Šã€‹ã€ˆã€‰ï¼»ï¼½ï½›ï½ã€ã€‘ã€–ã€—ã€”ã€•ï¼ˆï¼‰ã€ã€ã€Œã€]*$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("ï¼½", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else if(é€‰è‡³è¡Œé¦–.match(/ï½›[^ã€Šã€‹ã€ˆã€‰ï¼»ï¼½ï½›ï½ã€ã€‘ã€–ã€—ã€”ã€•ï¼ˆï¼‰ã€ã€ã€Œã€]*$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("ï½", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else if(é€‰è‡³è¡Œé¦–.match(/ã€[^ã€Šã€‹ã€ˆã€‰ï¼»ï¼½ï½›ï½ã€ã€‘ã€–ã€—ã€”ã€•ï¼ˆï¼‰ã€ã€ã€Œã€]*$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("ã€‘", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else if(é€‰è‡³è¡Œé¦–.match(/ã€–[^ã€Šã€‹ã€ˆã€‰ï¼»ï¼½ï½›ï½ã€ã€‘ã€–ã€—ã€”ã€•ï¼ˆï¼‰ã€ã€ã€Œã€]*$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("ã€—", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else if(é€‰è‡³è¡Œé¦–.match(/ã€”[^ã€Šã€‹ã€ˆã€‰ï¼»ï¼½ï½›ï½ã€ã€‘ã€–ã€—ã€”ã€•ï¼ˆï¼‰ã€ã€ã€Œã€]*$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("ã€•", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else if(é€‰è‡³è¡Œé¦–.match(/ã€[^ã€Šã€‹ã€ˆã€‰ï¼»ï¼½ï½›ï½ã€ã€‘ã€–ã€—ã€”ã€•ï¼ˆï¼‰ã€ã€ã€Œã€]*$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("ã€", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else if(é€‰è‡³è¡Œé¦–.match(/ã€Œ[^ã€Šã€‹ã€ˆã€‰ï¼»ï¼½ï½›ï½ã€ã€‘ã€–ã€—ã€”ã€•ï¼ˆï¼‰ã€ã€ã€Œã€]*$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("ã€", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else if(é€‰è‡³è¡Œé¦–.match(/ï¼ˆ[^ã€Šã€‹ã€ˆã€‰ï¼»ï¼½ï½›ï½ã€ã€‘ã€–ã€—ã€”ã€•ï¼ˆï¼‰ã€ã€ã€Œã€]*$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("ï¼‰", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else if(é€‰è‡³è¡Œé¦–.match(/^[ã€‹ã€](.*)$/)){
            è½¬æ¢æ–‡æœ¬ = é€‰è‡³è¡Œé¦–.replace(/^ã€‹(.*)$/,">$1");
            è½¬æ¢æ–‡æœ¬ = è½¬æ¢æ–‡æœ¬.replace(/^ã€(.*)$/,"/$1");
            ç¬”è®°å…¨æ–‡.replaceRange(è½¬æ¢æ–‡æœ¬, {line:å½“å‰è¡Œå·,ch:0}, å½“å‰å…‰æ ‡);
        }else if(é€‰è‡³è¡Œé¦–.match(/\[\[[^=\[\]\*~]*$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("]]", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else if(é€‰è‡³è¡Œé¦–.match(/\$\$[^\$]*$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("$$", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else if(é€‰è‡³è¡Œé¦–.match(/\$[^\$]*$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("$", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else if(é€‰è‡³è¡Œé¦–.match(/==[^=\[\]\*~]*$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("==", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else if(é€‰è‡³è¡Œé¦–.match(/\*\*[^=\[\]\*~]*$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("**", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else if(é€‰è‡³è¡Œé¦–.match(/%%[^=\[\]\*~%]*$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("%%", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else if(é€‰è‡³è¡Œé¦–.match(/~~[^=\[\]\*~]*$/)){
            ç¬”è®°å…¨æ–‡.replaceRange("~~", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else{
            let coreAry = ["query|qy","mermaid|mm","dataview|dv","ABAP","apl","asciiarmor","ASN.1","asp","assembly","bash","basic","C","C#","cassandra","ceylon","clike","clojure","cmake","cobol","coffeescript","commonlisp","cpp","CQL","crystal","csharp","css","cypher","cython","D","dart","diff","django","dockerfile","ejs","elixir","elm","embeddedjs","erb","erlang","F#","flow","forth","fortran","fsharp","gas","gfm","gherkin","gist","go","groovy","handlebars","haskell","haxe","html","http","hxml","idl","ini","jade","java","Javascript|js","jinja2","json","jsp","jsx","julia","kotlin","latex","less","lisp","livescript","lua","makefile","mariadb","markdown|md","mathematica","matlab","mbox","mermaid","mssql","mysql","nginx","nim","nsis","objc","objective-c","ocaml","octave","oZ","pascal","perl","perl6","pgp","php","php+HTML","plsql","powershell","properties","protobuf","pseudocode","python|py","q","R","react","reStructuredText","rst","ruby","rust","SAS","scala","scheme","SCSS","sequence","sh","shell","smalltalk","solidity","SPARQL","spreadsheet","sql","sqlite","squirrel","stylus","swift","tcl","tex","tiddlywiki","tiki","wiki","toml","tsx","turtle","twig","typescript","V","vbscript","velocity","verilog","vhdl","vb|visual basic","vue","web-idl","xaml","xml","xml-dtd","xquery","yacas","yaml"];
            for(var _l=0; _l<coreAry.length; _l++){
                let _coreID = coreAry[_l];
                let qcStr = _coreID.replace(/\|.+$/,"");
                if(eval("/^"+_coreID+"$/i").test(é€‰è‡³è¡Œé¦–)){
                    ç¬”è®°å…¨æ–‡.replaceRange("```"+qcStr+"\n\n```\n", {line:å½“å‰è¡Œå·,ch:0}, å½“å‰å…‰æ ‡);
                    ç¼–è¾‘æ¨¡å¼.exec("goLeft");
                    ç¼–è¾‘æ¨¡å¼.exec("goUp");
                };
            };

            let infoAry = ["note|ç¬”è®°|è®°å½•","abstract|æ‘˜è¦","summary|æ€»ç»“","tldr|æ¦‚è¦","info|ä¿¡æ¯|èµ„è®¯","todo|å¾…åŠ","tip|hint|æç¤º","important|é‡è¦","success|æˆåŠŸ","check|æ£€æŸ¥","done|å®Œæˆ","question|é—®é¢˜","help|å¸®åŠ©","faq|å¸¸è§é—®é¢˜","warning|è­¦å‘Š","caution|æé†’","attention|æ³¨æ„","failure|å¤±è´¥","fail|ä¸¢å¤±","missing|ç¼ºå¤±","danger|å±é™©","error|é”™è¯¯","bug|æ¼æ´|ç¼ºé™·","example|ç¤ºä¾‹|ä¾‹å­","quote|cite|å¼•ç”¨"];
            for(var i=0; i<infoAry.length; i++){
                let _strID = infoAry[i];
                let oneStr = _strID.replace(/\|.+$/,"");
                if(eval("/^("+_strID+")( ([å·¦ä¸­å³lcr]|left|center|right))*[\+\-]*$/i").test(é€‰è‡³è¡Œé¦–)){
                    let calloutStr = ">[!"+oneStr+"â– ]â–² \n>";
                    new obsidian.Notice("ç¬¦åˆè¡¨è¾¾å¼ï¼Œå¯ä»¥è½¬æ¢ï¼");
                    if(/\s([å·¦l]|left)(?=[\+\-]|$)/i.test(é€‰è‡³è¡Œé¦–)){
                        calloutStr = calloutStr.replace("â– "," left");
                    }else if(/\s([ä¸­c]|center)(?=[\+\-]|$)/i.test(é€‰è‡³è¡Œé¦–)){
                        calloutStr = calloutStr.replace("â– "," center");
                    }else if(/\s([å³r]|right)(?=[\+\-]|$)/i.test(é€‰è‡³è¡Œé¦–)){
                        calloutStr = calloutStr.replace("â– "," right");
                    }else{
                        calloutStr = calloutStr.replace("â– ","");
                    }
                    if(/\+$/.test(é€‰è‡³è¡Œé¦–)){
                        calloutStr = calloutStr.replace("â–²","+");
                    }else if(/\-$/.test(é€‰è‡³è¡Œé¦–)){
                        calloutStr = calloutStr.replace("â–²","-");
                    }else{
                        calloutStr = calloutStr.replace("â–²","");
                    }

                    ç¬”è®°å…¨æ–‡.replaceRange(calloutStr, {line:å½“å‰è¡Œå·,ch:0}, å½“å‰å…‰æ ‡);
                    ç¼–è¾‘æ¨¡å¼.exec("goLeft");
                    ç¼–è¾‘æ¨¡å¼.exec("goLeft");
                }
            };
        };
    };

    æ ‡é¢˜è¯­æ³•(_str) {
        let link = eval("/^"+_str+" ([^#]+)/");	//æ˜¯å¦åŒ…å«å‡ ä¸ª#ç¬¦å·
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        let æ–°æ–‡æœ¬ = "";
        
        if(_str==""){   //è‹¥ä¸ºæ ‡é¢˜ï¼Œè½¬ä¸ºæ™®é€šæ–‡æœ¬
            æ–°æ–‡æœ¬ = å½“å‰è¡Œæ–‡æœ¬.replace(/^(\>*(\[[!\w]+\])?\s*)#+\s/,"$1");
        }else{  //åˆ—è¡¨ã€å¼•ç”¨ï¼Œå…ˆè½¬ä¸ºæ™®é€šæ–‡æœ¬ï¼Œå†è½¬ä¸ºæ ‡é¢˜
            æ–°æ–‡æœ¬ = å½“å‰è¡Œæ–‡æœ¬.replace(/^\s*(#*|\>|\-|\d+\.)\s*/m,"");
            console.log(æ–°æ–‡æœ¬);
            æ–°æ–‡æœ¬ = _str+" "+æ–°æ–‡æœ¬;
        }
        //ç¬”è®°å…¨æ–‡.replaceRange(æ–°æ–‡æœ¬, {line:å½“å‰è¡Œå·,ch:0}, {line:å½“å‰è¡Œå·,ch:å½“å‰è¡Œæ–‡æœ¬.length});
        ç¼–è¾‘æ¨¡å¼.setLine(å½“å‰è¡Œå·,æ–°æ–‡æœ¬);
        ç¼–è¾‘æ¨¡å¼.setCursor({line:å½“å‰è¡Œå·,ch:Number(æ–°æ–‡æœ¬.length-é€‰è‡³è¡Œå°¾.length)});
    };

    è°ƒèŠ‚æ ‡é¢˜çº§åˆ«(å¢åŠ ) {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        let æ–°æ–‡æœ¬ = "";
        let ä½ç½® = é€‰è‡³è¡Œé¦–.length;
        if(å¢åŠ ){
            if(/^##+\s/.test(å½“å‰è¡Œæ–‡æœ¬)){
                æ–°æ–‡æœ¬ = å½“å‰è¡Œæ–‡æœ¬.replace(/(^\s*)##/,"$1#");
                ä½ç½®--
            }else{
                return;
            }
        }else{
            if(/^#{1,5}\s/.test(å½“å‰è¡Œæ–‡æœ¬)){
                æ–°æ–‡æœ¬ = å½“å‰è¡Œæ–‡æœ¬.replace(/(^[â€Œâ€Œâ€Œâ€Œâ€Œâ€Œã€€]*)#/,"$1##");
                ä½ç½®++
            }else{
                return;
            }
        }
        //ç¬”è®°å…¨æ–‡.replaceRange(æ–°æ–‡æœ¬, {line:å½“å‰è¡Œå·,ch:0}, {line:å½“å‰è¡Œå·,ch:å½“å‰è¡Œæ–‡æœ¬.length});
        ç¼–è¾‘æ¨¡å¼.setLine(å½“å‰è¡Œå·,æ–°æ–‡æœ¬);
        ç¼–è¾‘æ¨¡å¼.setCursor({line:å½“å‰è¡Œå·,ch:ä½ç½®});
    };

    å½©å­—æ ¼å¼åˆ·(_color){
        this.å…³é—­æ ¼å¼åˆ·();
        isCTxt = true;
        this.settings.hColor = _color;
        newNotice = new obsidian.Notice("å¤šå½©æ–‡å­—æ ¼å¼åˆ· å·²æ‰“å¼€ï¼",0);
    }

    è½¬æ¢æ–‡å­—é¢œè‰²() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){return};

        let _html0 = /\<font color=[0-9a-zA-Z#]+[^\<\>]*\>[^\<\>]+\<\/font\>/g;
        let _html1 = /^\<font color=[0-9a-zA-Z#]+[^\<\>]*\>([^\<\>]+)\<\/font\>$/;
        let _html2 = '\<font color='+this.settings.hColor+'\>$1\<\/font\>';
        let _html3 = /\<font color=[^\<]*$|^[^\>]*font\>/g;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„<>

        if (_html3.test(æ‰€é€‰æ–‡æœ¬)){
            return; //new obsidian.Notice("ä¸èƒ½è½¬æ¢é¢œè‰²ï¼");
        }else if (_html0.test(æ‰€é€‰æ–‡æœ¬)){
            if(_html1.test(æ‰€é€‰æ–‡æœ¬)){
                //new obsidian.Notice("æ›¿æ¢é¢œè‰²ï¼");
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(_html1,_html2);
            }else{
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\<font color=[0-9a-zA-Z#]+[^\<\>]*?\>|\<\/font\>/g,""); 
            }
        }else{
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^(.+)$/mg,_html2);  //new obsidian.Notice("å¯ä»¥è½¬æ¢é¢œè‰²ï¼");
        }
        this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
        ç¼–è¾‘æ¨¡å¼.exec("goRight");
    };

    å½©åº•æ ¼å¼åˆ·(_color){
        this.å…³é—­æ ¼å¼åˆ·();
        isBgC = true;
        this.settings.bColor = _color;
        newNotice = new obsidian.Notice("å¤šå½©èƒŒæ™¯æ ¼å¼åˆ· å·²æ‰“å¼€ï¼",0);
    }
    è½¬æ¢èƒŒæ™¯é¢œè‰²() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){return};
        let _html0 = /\<span style=[\"'][^\<\>]+:[0-9a-zA-Z#]+[\"'][^\<\>]*\>[^\<\>]+\<\/span\>/g;
        let _html1 = /^\<span style=[\"'][^\<\>]+:[0-9a-zA-Z#]+[\"'][^\<\>]*\>([^\<\>]+)\<\/span\>$/;
        let _html2 = '\<span style=\"background\:'+this.settings.bColor+'\"\>$1\<\/span\>';
        let _html3 = /\<span style=[^\<]*$|^[^\>]*span\>/g;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„<>
        if (_html3.test(æ‰€é€‰æ–‡æœ¬)){
            return; //new obsidian.Notice("ä¸èƒ½è½¬æ¢é¢œè‰²ï¼");
        }else if (_html0.test(æ‰€é€‰æ–‡æœ¬)){
            if(_html1.test(æ‰€é€‰æ–‡æœ¬)){
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(_html1,_html2); 
            }else{
                æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\<span style=[\"'][^\<\>]+:[0-9a-zA-Z#]+[\"'][^\<\>]*\>|\<\/span\>/g,"");
                //new obsidian.Notice("éœ€è¦å»é™¤é¢œè‰²ï¼");
            }
        }else{
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^(.+)$/mg,_html2);  //new obsidian.Notice("å¯ä»¥è½¬æ¢é¢œè‰²ï¼");
        }
        this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
        ç¼–è¾‘æ¨¡å¼.exec("goRight");
    };
    
    è½¬æ¢æ— è¯­æ³•æ–‡æœ¬() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬ == null){
            if(isText){
                this.å…³é—­æ ¼å¼åˆ·();
                new obsidian.Notice("å·²å…³é—­æ ¼å¼åˆ·ï¼");
            }else{
                this.å…³é—­æ ¼å¼åˆ·();
                isText = true;
                newNotice = new obsidian.Notice("çº¯æ–‡æœ¬æ ¼å¼åˆ· å·²æ‰“å¼€ï¼",0);
                //new obsidian.Notice("è¯·å…ˆåˆ’é€‰éƒ¨åˆ†æ–‡æœ¬ï¼Œå†æ‰§è¡Œå‘½ä»¤ï¼");
                let reg1 = /(~~|%%|\*==|==|\*\*?|\<[^\<\>]*?\>|!?\[\[*|`|_|!?\[)([^!#=\[\]\<\>\`_\*~\(\)]*)$/;
                let reg2 = /^([^!=\[\]\<\>\`_\*~\(\)]*)(~~|%%|==\*|==|\*\*?|\<[^\<\>]*\>|\]\]|`|_|\]\([^\(\)\[\]]*\))/;
                if(é€‰è‡³è¡Œé¦–.match(reg1)!=null && é€‰è‡³è¡Œå°¾.match(reg2)!=null){
                    é€‰è‡³è¡Œé¦– = é€‰è‡³è¡Œé¦–.replace(reg1,"$2");
                    é€‰è‡³è¡Œå°¾ = é€‰è‡³è¡Œå°¾.replace(reg2,"$1");
                    //ç¬”è®°å…¨æ–‡.replaceRange(é€‰è‡³è¡Œé¦–+é€‰è‡³è¡Œå°¾, {line:å½“å‰è¡Œå·,ch:0},{line:å½“å‰è¡Œå·,ch:å½“å‰è¡Œæ–‡æœ¬.length});
                    ç¼–è¾‘æ¨¡å¼.setLine(å½“å‰è¡Œå·,é€‰è‡³è¡Œé¦–+é€‰è‡³è¡Œå°¾);
                    ç¼–è¾‘æ¨¡å¼.setCursor({line:å½“å‰è¡Œå·,ch:Number(é€‰è‡³è¡Œé¦–.length)});
                }
            }
        }else{
            let mdText = /(^#+\s|(?<=^|\s*)#|^\>|^\- \[( |x)\]|^\+ |\<[^\<\>]+?\>|^1\. |^\s*\- |^\-+$|^\*+$|==\*|\*==|==\*\*|\*\*==|==\*\*\*|\*\*\*==)/mg;
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(mdText,"");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^[ ]+|[ ]+$/mg,"");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\!?\[\[([^\[\]\|]*\|)*([^\(\)\[\]]+)\]\]/g,"$2");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\!?\[+([^\[\]\(\)]+)\]+\(([^\(\)]+)\)/g,"$1");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/`([^`]+)`/g,"$1");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/_([^_]+)_/g,"$1");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/==([^=]+)==/g,"$1");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\*\*?([^\*]+)\*\*?/g,"$1");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/~~([^~]+)~~/g,"$1");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/(\r*\n)+/mg,"\r\n");
       
			this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
        }
    };

    å†…é“¾è½¬ä¸ºè¶…é“¾æ¥() {
		this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!ç¬”è®°æ­£æ–‡) return;
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/\[\[([^\[\]]+)(\.\w{3,4})?\]\]/g,"[$1]($1$2)");
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<=\]\([^\)]*)\s(?=[^\(]*\))/g,"%20");
        this.æ›¿æ¢ç¬”è®°æ­£æ–‡ (ç¬”è®°æ­£æ–‡);
    };

    è¶…é“¾æ¥è½¬ä¸ºå†…é“¾() {
		this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!ç¬”è®°æ­£æ–‡) return;
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/\[([^\[\]]+)\]\([^\(\)]+\)/g,"[[$1]]");
        this.æ›¿æ¢ç¬”è®°æ­£æ–‡ (ç¬”è®°æ­£æ–‡);
    };

    å»é™¤è¶…é“¾æ¥è¯­æ³•() {
		this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!ç¬”è®°æ­£æ–‡) return;
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/\[([^\[\]]+)\]\([^\(\)]+\)/g,"$1");
        this.æ›¿æ¢ç¬”è®°æ­£æ–‡ (ç¬”è®°æ­£æ–‡);
    };
    
    æ‹¬é€‰æ–‡æœ¬1() {
        let link = /(.*ã€[^ã€ã€‘]+ã€‘.*)/g;	//æ˜¯å¦åŒ…å«ã€ã€‘
        let link1 = /ã€[^ã€ã€‘]*$|^[^ã€ã€‘]*ã€‘/g;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„ã€ã€‘
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){return};
        if (link1.test(æ‰€é€‰æ–‡æœ¬)){
            return;
        }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/[ã€ã€‘]/g,"");
        }else{
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^(.+)$/mg,"ã€$1ã€‘");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^ã€\s*ã€‘$/mg,"");
        }
        this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
    };

    æ‹¬é€‰æ–‡æœ¬2() {
        let link = /(.*ï¼ˆ[^ï¼ˆï¼‰]*ï¼‰.*)/g;	//æ˜¯å¦åŒ…å«ã€ã€‘
        let link1 = /ï¼ˆ[^ï¼ˆï¼‰]*$|^[^ï¼ˆï¼‰]*ï¼‰/g;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„ã€ã€‘
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){return};
        if (link1.test(æ‰€é€‰æ–‡æœ¬)){
            return;
        }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/[ï¼ˆï¼‰]/g,"");
        }else{
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^(.+)$/mg,"($1)");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^(\s*)$/mg,"");
        }
        this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
    };

    æ‹¬é€‰æ–‡æœ¬3() {
        let link = /(.*ã€Œ[^ã€Œã€]*ã€.*)/g;	//æ˜¯å¦åŒ…å«ã€Œã€
        let link1 = /ã€Œ[^ã€Œã€]*$|^[^ã€Œã€]*ã€/g;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„ã€Œ
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){return};
        if (link1.test(æ‰€é€‰æ–‡æœ¬)){
            return;
        }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/[ã€Œã€]/g,"");
        }else{
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^(.+)$/mg,"ã€Œ$1ã€");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^ã€Œ\s*ã€$/mg,"");
        }
        this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
    };

    æ‹¬é€‰æ–‡æœ¬4() {
        let link = /(.*ã€Š[^ã€Šã€‹]*ã€‹.*)/;	//æ˜¯å¦åŒ…å«ã€Šã€‹
        let link1 = /ã€Š[^ã€Šã€‹]*$|^[^ã€Šã€‹]*ã€‹/;	//æ˜¯å¦åªåŒ…å«ä¸€ä¾§çš„ã€Š
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){return};
        if (link1.test(æ‰€é€‰æ–‡æœ¬)){
            return;
        }else if (link.test(æ‰€é€‰æ–‡æœ¬)){
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/[ã€Šã€‹]/g,"");
        }else{
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^(.+)$/mg,"ã€Š$1ã€‹");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^ã€Š\s*ã€‹$/mg,"");
        }
        this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
    };

    åˆ é™¤å½“å‰æ®µè½() {
        //ä¼˜åŒ–Obè‡ªå¸¦åŠŸèƒ½ï¼Œæ”¯æŒåˆ é™¤å…‰æ ‡æ‰€åœ¨é“¾æ¥æ–‡æœ¬ï¼Œä¿®æ­£æœ‰åºåˆ—è¡¨çš„åºå·
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        let reg = /^[\t\s]*\d+(?=\.\s[^\s])/mg;
        if(å½“å‰è¡Œæ–‡æœ¬.match(reg)==null){
            console.log("å½“å‰ä¸æ˜¯åˆ—è¡¨");
            let reg1 =/^(.*\[\[)[^\[]+$/;
            let reg2 = /^[^\]]+(\]\].*)$/;

            //å½“å‰å…‰æ ‡åœ¨[[]]ä¸­é—´ï¼Œåªåˆ é™¤é“¾æ¥æ–‡å­—
            if(reg1.test(é€‰è‡³è¡Œé¦–) && reg2.test(é€‰è‡³è¡Œå°¾)){
                new obsidian.Notice("ä¼˜å…ˆåˆ é™¤å†…éƒ¨é“¾æ¥ï¼Œå¯ä»¥åˆ‡æ¢æ ‡é¢˜ï¼");
                é€‰è‡³è¡Œé¦– = é€‰è‡³è¡Œé¦–.replace(reg1,"$1");
                é€‰è‡³è¡Œå°¾ = é€‰è‡³è¡Œå°¾.replace(reg2,"$1");
                //ç¬”è®°å…¨æ–‡.replaceRange(é€‰è‡³è¡Œé¦–+é€‰è‡³è¡Œå°¾, {line:å½“å‰è¡Œå·,ch:0},{line:å½“å‰è¡Œå·,ch:å½“å‰è¡Œæ–‡æœ¬.length});
                ç¼–è¾‘æ¨¡å¼.setLine(å½“å‰è¡Œå·,é€‰è‡³è¡Œé¦–+é€‰è‡³è¡Œå°¾);
                ç¼–è¾‘æ¨¡å¼.setCursor({line:å½“å‰è¡Œå·,ch:é€‰è‡³è¡Œé¦–.length});
            }else{
                //å½“å‰æ‰€åœ¨è¡Œä¸ºæ™®é€šæ–‡æœ¬ï¼Œç›´æ¥åˆ é™¤
                ç¬”è®°å…¨æ–‡.replaceRange("", {line:å½“å‰è¡Œå·,ch:0},{line:Number(å½“å‰è¡Œå·+1),ch:0});
            }
        }else{
            //å½“å‰æ‰€åœ¨è¡Œä¸ºæœ‰åºåˆ—è¡¨çš„ä¸€é¡¹ï¼Œåˆ™è°ƒå°åè¡¨éƒ¨åˆ†çš„åºå·
            é€‰è‡³æ–‡æœ« = é€‰è‡³æ–‡æœ«.replace(/\n/g,"â†«");
            let åè¡¨éƒ¨åˆ† = é€‰è‡³æ–‡æœ«.match(/^([\t\s]*\d+\.\s[^â†«]*â†«)+/)[0].replace(/â†«/g,"\n"); //æ›¿æ¢ä¸ºå•è¡Œæ–‡æœ¬ï¼Œå†æˆªå–åè¡¨éƒ¨åˆ†
            let åè¡¨è¡Œæ•° = åè¡¨éƒ¨åˆ†.match(/\n/g).length;    //è®¡ç®—æ¢è¡Œæ¬¡æ•°
            let ç¼©è¿›å­—ç¬¦ = å½“å‰è¡Œæ–‡æœ¬.match(/^[\t\s]*(?=\d)/)[0];
            let reg3 = eval("/(?<=^"+ç¼©è¿›å­—ç¬¦+")\\d+(?=\\.*\\s)/mg");    //æŒ‰å½“å‰è¡Œçš„ç¼©è¿›æ ¼å¼è¿›è¡ŒæŸ¥æ‰¾æ›¿æ¢
            åè¡¨éƒ¨åˆ† = åè¡¨éƒ¨åˆ†.replace(reg3, function(a){return a*1-1;});
            åè¡¨éƒ¨åˆ† = åè¡¨éƒ¨åˆ†.replace(/^[^\n]*\n/,"");
            //new obsidian.Notice("é€‰è‡³æ–‡æœ«\n"+é€‰è‡³æ–‡æœ«);
            ç¬”è®°å…¨æ–‡.replaceRange(åè¡¨éƒ¨åˆ†, {line:å½“å‰è¡Œå·,ch:0},{line:å½“å‰è¡Œå·+åè¡¨è¡Œæ•°,ch:ç¼–è¾‘æ¨¡å¼.getLine(å½“å‰è¡Œå·+åè¡¨è¡Œæ•°).length});
        };
    };

    æœ‰è½¬æ— åºåˆ—è¡¨() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){return};
        æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/(?<=^\s*)[0-9]+\.\s/mg,"- ");
        this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
    };

    æ— è½¬æœ‰åºåˆ—è¡¨() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null){return};
        æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/(?<=^\s*)[\-\+]\s/mg,"1. ");
        this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
    };
    
    è½¬æ¢å¾…åŠåˆ—è¡¨() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        let å½“å‰æ–°æ–‡æœ¬ = å½“å‰è¡Œæ–‡æœ¬.replace(/(?<=^\s*([\-\+]|[0-9]+\.)\s\[) (?=\]\s[^\s])/mg,"xâ˜€");
        å½“å‰æ–°æ–‡æœ¬ = å½“å‰æ–°æ–‡æœ¬.replace(/(?<=^\s*([\-\+]|[0-9]+\.)\s\[)x(?=\]\s[^\s])/mg,"-â˜€");
        å½“å‰æ–°æ–‡æœ¬ = å½“å‰æ–°æ–‡æœ¬.replace(/(?<=^\s*([\-\+]|[0-9]+\.)\s\[)\-(?=\]\s[^\s])/mg,"!â˜€");
        å½“å‰æ–°æ–‡æœ¬ = å½“å‰æ–°æ–‡æœ¬.replace(/(?<=^\s*([\-\+]|[0-9]+\.)\s\[)\!(?=\]\s[^\s])/mg,"?â˜€");
        å½“å‰æ–°æ–‡æœ¬ = å½“å‰æ–°æ–‡æœ¬.replace(/(?<=^\s*([\-\+]|[0-9]+\.)\s\[)\?(?=\]\s[^\s])/mg,">â˜€");
        å½“å‰æ–°æ–‡æœ¬ = å½“å‰æ–°æ–‡æœ¬.replace(/(?<=^\s*([\-\+]|[0-9]+\.)\s\[)\>(?=\]\s[^\s])/mg,"<â˜€");
        å½“å‰æ–°æ–‡æœ¬ = å½“å‰æ–°æ–‡æœ¬.replace(/(?<=^\s*([\-\+]|[0-9]+\.)\s\[)\<(?=\]\s[^\s])/mg,"+â˜€");
        å½“å‰æ–°æ–‡æœ¬ = å½“å‰æ–°æ–‡æœ¬.replace(/(?<=^\s*([\-\+]|[0-9]+\.)\s\[)\+(?=\]\s[^\s])/mg," â˜€");
        å½“å‰æ–°æ–‡æœ¬ = å½“å‰æ–°æ–‡æœ¬.replace(/(?<=^\s*([\-\+]|[0-9]+\.)\s\[[\sx\-\+\?\!\<\>])â˜€(?=\]\s[^\s])/mg,"");
        //ç¬”è®°å…¨æ–‡.replaceRange(å½“å‰æ–°æ–‡æœ¬, {line:å½“å‰è¡Œå·,ch:0},{line:å½“å‰è¡Œå·,ch:å½“å‰è¡Œæ–‡æœ¬.length});
        ç¼–è¾‘æ¨¡å¼.setLine(å½“å‰è¡Œå·,å½“å‰æ–°æ–‡æœ¬);
    };

    åˆè®¡ä»»åŠ¡ç”¨æ—¶() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        let å½“å‰ç¼©è¿› = "";
        let çˆ¶çº§ç¼©è¿› = "";
        if(/^\s*\- [^\n]+$/.test(å½“å‰è¡Œæ–‡æœ¬)){
            å½“å‰ç¼©è¿› = å½“å‰è¡Œæ–‡æœ¬.replace(/\-.*$/m,"");
        }

        let timeReg = /.*(20\d\d\-\d\d\-\d\d \d\d:\d\d)\s*\-\s*(20\d\d\-\d\d\-\d\d \d\d:\d\d)\s*$/m;
        if(timeReg.test(å½“å‰è¡Œæ–‡æœ¬)){
            let startTime = å½“å‰è¡Œæ–‡æœ¬.replace(timeReg,"$1");
            let stopTime = å½“å‰è¡Œæ–‡æœ¬.replace(timeReg,"$2");
            let date1 = new Date(startTime.replace(/-/g, '/'));
            let date2 = new Date(stopTime.replace(/-/g, '/'));
        
            // æœ‰ä¸‰ç§æ–¹å¼è·å–ï¼Œåœ¨åé¢ä¼šè®²åˆ°ä¸‰ç§æ–¹å¼çš„åŒºåˆ«
            let time1 = date1.getTime();
            let time2 = date2.valueOf();

            new obsidian.Notice("å½“å‰ä»»åŠ¡ç”¨æ—¶ "+Number((time2-time1)/1000)+" ç§’");
        }
        
    }

    æ ‡è®°å®ŒæˆåŠæ—¶é—´() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        let å½“å‰æ–°æ–‡æœ¬ = å½“å‰è¡Œæ–‡æœ¬.replace(/(?<=^\s*([\-\+]|[0-9]+\.)\s\[) (?=\]\s[^\s])/mg,"xâ˜€");
        å½“å‰æ–°æ–‡æœ¬ = å½“å‰æ–°æ–‡æœ¬.replace(/(?<=^\s*([\-\+]|[0-9]+\.)\s\[[\sx\-\+\?\!\<\>])â˜€(?=\]\s[^\s])/mg,"");
        å½“å‰æ–°æ–‡æœ¬ = å½“å‰æ–°æ–‡æœ¬+" "+this.ç”Ÿæˆæ—¶é—´æˆ³();
        //ç¬”è®°å…¨æ–‡.replaceRange(å½“å‰æ–°æ–‡æœ¬, {line:å½“å‰è¡Œå·,ch:0},{line:å½“å‰è¡Œå·,ch:å½“å‰è¡Œæ–‡æœ¬.length});
        ç¼–è¾‘æ¨¡å¼.setLine(å½“å‰è¡Œå·,å½“å‰æ–°æ–‡æœ¬);
    };

    è‡ªåŠ¨è®¾ç½®æ ‡é¢˜() {    //ä¿®å¤ æ ‡é¢˜è¡Œé¦–çš„ç©ºæ ¼æˆ–åˆ¶è¡¨ç¬¦å½±å“æ­£å¸¸æ ¼å¼ çš„é—®é¢˜ã€‚ 20220807
		this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!ç¬”è®°æ­£æ–‡) return;
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/\r?\n/g,"â†«");
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/â†«\s*â†«/g,"â†«â†«");
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/\s*(?=â†«)/g,"");
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<=^|â†«)[\s\t]*([^\s\t#`\[\]\(\)â†«]+[^\.\?\!:,0-9ï¼Œï¼šã€‚ï¼Ÿï¼ï¼‰â†«])(?=(â†«|$))/mg,"â†«# $1â†«");
        //ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/#+([^#â†«]+)â†«*$/mg,"$1");    //å–æ¶ˆæœ«è¡Œæ ‡é¢˜
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/â†«{3,}/g,"\r\n\r\n");
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/â†«/g,"\r\n");
        this.æ›¿æ¢ç¬”è®°æ­£æ–‡ (ç¬”è®°æ­£æ–‡);
    };

    æŒ‡å®šå½“å‰æ–‡ä»¶å () {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        å½“å‰æ–‡ä»¶è·¯å¾„ = this.app.workspace.getActiveFile().path;
        if (æ‰€é€‰æ–‡æœ¬ == ""){return};
        //navigator.clipboard.writeText(æ‰€é€‰æ–‡æœ¬);
        //this.app.workspace.activeLeaf.replaceSelection(æ‰€é€‰æ–‡æœ¬);
        this.app.vault.adapter.rename(å½“å‰æ–‡ä»¶è·¯å¾„, æ‰€é€‰æ–‡æœ¬+".md"); //å¼ºè¡Œé‡å‘½åï¼Œä¸èƒ½å…¨å±€æ›´æ–°
        console.log(å½“å‰æ–‡ä»¶è·¯å¾„+"\n"+æ‰€é€‰æ–‡æœ¬);
    };

    è·å–ç›¸å¯¹è·¯å¾„ () {
        å½“å‰æ–‡ä»¶ = this.app.workspace.getActiveFile();
        å½“å‰æ–‡ä»¶è·¯å¾„ = å½“å‰æ–‡ä»¶.path;
        //navigator.clipboard.writeText(å½“å‰æ–‡ä»¶è·¯å¾„)
        let ç›¸å¯¹ç›®å½• = å½“å‰æ–‡ä»¶è·¯å¾„.replace(/(?<=\/)[^\/]+$/m,"");
        new obsidian.Notice("å½“å‰ç¬”è®°ä½äºï¼š"+ç›¸å¯¹ç›®å½•);
    };

    æ™ºèƒ½ç²˜è´´() {
    	this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
    	let åˆ†éš”è¡Œ = "";        //è·å– å½“å‰çª—å£  //å…¶ä¸­constæ˜¯ã€å¸¸æ•°ã€‘
        navigator.clipboard.readText()
		.then(clipText => {
            let bgReg = /([^\t]+[\t]){3,}[^\t]+/;
            let urlReg = /^(https?:\/\/[^:]+)$/
            let pathReg = /^([c-z]:\\[^\/:\*\?\<\>\|]+)$/i
            let htmlReg = /^.*(\<\body[^\<\>]+\>.*\<\/body\>).*$/
            let tmpText = clipText.replace(/[\n ]/g,"");
            console.log("è·å–åˆ°å¦‚ä¸‹æ•°æ®ï¼š\n"+ tmpText);
            if(urlReg.test(tmpText)){
                clipText = clipText.replace(urlReg,"[é“¾æ¥]($1)");
                new obsidian.Notice("å‰ªè´´æ¿æ•°æ®å·²è½¬ä¸ºç½‘å€è¶…é“¾æ¥ï¼");
            }else if(pathReg.test(tmpText)){
                clipText = clipText.replace(pathReg,"[æœ¬åœ°]($1)");
                new obsidian.Notice("å‰ªè´´æ¿æ•°æ®å·²è½¬ä¸ºæœ¬åœ°æ–‡ä»¶è¶…é“¾æ¥ï¼");
            }else if(bgReg.test(tmpText)){
                clipText = clipText.replace(/\n/g,"â– ");
                clipText = clipText.replace(/\"([^â– \|\"]+)â– ([^\|\n\"]+)\"/g,"$1<br>$2");
                åˆ†éš”è¡Œ = clipText.replace(/â– .*/g,"");
                åˆ†éš”è¡Œ = åˆ†éš”è¡Œ.replace(/\t/g,"|");
                åˆ†éš”è¡Œ = åˆ†éš”è¡Œ.replace(/([^\|]*)/g,":---");
                clipText = clipText.replace(/\t/g,"\|");
                clipText = clipText.replace(/^([^â– ]+)/,"$1â– "+åˆ†éš”è¡Œ);
                clipText = clipText.replace(/â– /g,"\n");
                clipText = clipText.replace(/^\|/mg,"ã€€\|");
                clipText = clipText.replace(/\|$/mg,"\|ã€€");
                clipText = clipText.replace(/^(?=[^\r\n])|(?<=[^\r\n])$/mg,"\|");
                clipText = clipText.replace(/(?<=\|)(?=\|)/g,"ã€€");
                new obsidian.Notice("å‰ªè´´æ¿æ•°æ®å·²è½¬ä¸ºMDè¯­æ³•è¡¨æ ¼ï¼");
            }else if(htmlReg.test(tmpText)){
                console.log('è·å–åˆ°å¯Œæ–‡æœ¬');
            }else/* if(codeReg.test(tmpText))*/{
                clipText = "```\n"+clipText+"\n```\n"
                new obsidian.Notice("å‰ªè´´æ¿æ•°æ®å·²è½¬ä¸ºä»£ç å—æ ¼å¼ï¼");
            }
			ç¼–è¾‘æ¨¡å¼.replaceSelection(clipText);
            //åœ¨å½“å‰å…‰æ ‡ä½ç½®å†™å…¥å¤„ç†åçš„æ•°æ®
		})
		.catch(err => {
			console.error('æœªèƒ½è¯»å–åˆ°å‰ªè´´æ¿ä¸Šçš„å†…å®¹: ', err);
		});
    }

    è®¡ç®—æ‰€é€‰ç»“æœ() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(/^[\(\d\+\-][\(\)\d\+\-\/\*x\.]+[\d\)]$/i.test(æ‰€é€‰æ–‡æœ¬)){
            if(/[x\*\/][x\*\/]+/i.test(æ‰€é€‰æ–‡æœ¬)){
                new obsidian.Notice("è¿™ä¸ªé¢˜ç›®ï¼Œä¿ºçœ‹ä¸æ‡‚ï¼");
                return;
            }
            let ç»“æœ = eval(æ‰€é€‰æ–‡æœ¬.replace(/x/ig,"*"));
            new obsidian.Notice(æ‰€é€‰æ–‡æœ¬+"="+ç»“æœ+"\nç»“æœå·²å†™å…¥å‰ªè´´æ¿ï¼");
            navigator.clipboard.writeText(ç»“æœ);
        }else{
            new obsidian.Notice("æ•°äº†æ•°ï¼Œæ‚¨åˆ’é€‰äº†"+æ‰€é€‰æ–‡æœ¬.length+"ä¸ªå­—ç¬¦ï¼");
        }
    }

    è·å–æœç´¢ç»“æœ() {
        var _a;
        var _linkTxt = "";
        const searchView = (_a = this.app.workspace.getLeavesOfType('search')[0]) === null || _a === void 0 ? void 0 : _a.view;
        if (!searchView) {
            new obsidian.Notice("è¯·å…ˆæ‰§è¡Œæœç´¢æ“ä½œ...");
            return;
        }
        const searchResults = searchView.dom.getFiles();
        if (!searchResults.length) {
            return;
        }
        const markdownFiles = searchResults.filter((file) => file.extension === 'md');
        if (!markdownFiles.length) {
            return;
        }
        for(var i= 0;i<markdownFiles.length;i++){
            _linkTxt +=  "[["+markdownFiles[i].basename+"]]\n"
        }
        navigator.clipboard.writeText(_linkTxt);
        new obsidian.Notice("æœç´¢ç»“æœå·²å†™å…¥å‰ªè´´æ¿ï¼\nè¯·æ‰§è¡Œç²˜è´´æ“ä½œ...");
    };
    
    è·å–æ ‡æ³¨æ–‡æœ¬() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!ç¬”è®°æ­£æ–‡) return;
        let tmp = ç¬”è®°æ­£æ–‡.replace(/^(?!#+ |#æ³¨é‡Š|#æ ‡æ³¨|#æ‰¹æ³¨|#åæ€|#å¤‡æ³¨|.*==|.*%%).*$|^[^#\n%=]*(==|%%)|(==|%%)[^\n%=]*$|(==|%%)[^\n%=]*(==|%%)/mg,"\n");
        tmp = tmp.replace(/[\r\n|\n]+/g,"\n")        
        new obsidian.Notice("å·²æˆåŠŸè·å–æ ‡æ³¨ç±»æ–‡æœ¬ï¼Œå¯ä»¥ç²˜è´´ï¼");
        navigator.clipboard.writeText(tmp);
    };

    è·å–æ— è¯­æ³•æ–‡æœ¬() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬ == ""){
            new obsidian.Notice("è¯·å…ˆåˆ’é€‰éƒ¨åˆ†æ–‡æœ¬ï¼Œå†æ‰§è¡Œå‘½ä»¤ï¼");
        }else{
            let mdText = /(^#+\s|(?<=^|\s*)#|^>|^\- \[( |x)\]|^\+ |<[^<>]+>|^1\. |^\-+$|^\*+$|==|\*+|~~|```|!*\[\[|\]\])/mg;
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\[([^\[\]]*)\]\([^\(\)]+\)/img,"$1");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(mdText,"");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^[ ]+|[ ]+$/mg,"");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/(\r\n|\n)+/mg,"\n");
            new obsidian.Notice("å·²æˆåŠŸè·å–æ— è¯­æ³•æ–‡æœ¬ï¼Œå¯ä»¥ç²˜è´´ï¼");
            navigator.clipboard.writeText(æ‰€é€‰æ–‡æœ¬);
        }
    };

    è·å–å½“å‰å­—æ•°() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!ç¬”è®°æ­£æ–‡) return;
        let showTip = "";
        let showTip1 = "";
        let showTip2 = "";

        let å¯è§å­—ç¬¦ = ç¬”è®°æ­£æ–‡.match(/[^\s\t\r\n]/g);
        if(å¯è§å­—ç¬¦){
            showTip1 += "\nå¯è§å­—ç¬¦ "+å¯è§å­—ç¬¦.length;

            let æ±‰å­—ä¸ªæ•° = ç¬”è®°æ­£æ–‡.match(/[ä¸€-é¾¥]/g);
            if(æ±‰å­—ä¸ªæ•°){
                showTip1 += "\n- æ±‰å­— "+æ±‰å­—ä¸ªæ•°.length;
            }

            let å­—æ¯ä¸ªæ•° = ç¬”è®°æ­£æ–‡.match(/[a-z]/ig);
            if(å­—æ¯ä¸ªæ•°){
                showTip1 += "\n- å­—æ¯ "+å­—æ¯ä¸ªæ•°.length;
            }

            let æ•°å­—ä¸ªæ•° = ç¬”è®°æ­£æ–‡.match(/\d/ig);
            if(æ•°å­—ä¸ªæ•°){
                showTip1 += "\n- æ•°å­— "+æ•°å­—ä¸ªæ•°.length;
            }

            let æ ‡ç‚¹ä¸ªæ•° = ç¬”è®°æ­£æ–‡.match(/[,ï¼Œ\.ã€‚\\ã€\/\?ï¼Ÿ\!ï¼:ï¼š;ï¼›â€”ã€ã€‘ï¼ˆï¼‰{}ã€Šã€‹#&@\$\^â€œâ€â€˜â€™'"\]\[\(\)â€”â€¦]/ig);
            if(æ ‡ç‚¹ä¸ªæ•°){
                showTip1 += "\n- æ ‡ç‚¹ "+æ ‡ç‚¹ä¸ªæ•°.length;
            }
        }else{
            showTip1 = "\n0 ä¸ªå¯è§å­—ç¬¦";
        }

        let ä¸å¯è§å­—ç¬¦ = ç¬”è®°æ­£æ–‡.match(/[\s\t\r\n]/g);
        if(ä¸å¯è§å­—ç¬¦){
            showTip2 += "\nä¸å¯è§å­—ç¬¦ "+ä¸å¯è§å­—ç¬¦.length;

            let ç©ºæ ¼ä¸ªæ•° = ç¬”è®°æ­£æ–‡.match(/[ ã€€\t]/g);
            if(ç©ºæ ¼ä¸ªæ•°){
                showTip2 += "\n- ç©ºæ ¼ "+ç©ºæ ¼ä¸ªæ•°.length;
            }

            let æ¢è¡Œä¸ªæ•° = ç¬”è®°æ­£æ–‡.match(/\r*\n/g);
            if(æ¢è¡Œä¸ªæ•°){
                showTip2 += "\n- æ¢è¡Œ "+æ¢è¡Œä¸ªæ•°.length;
            }
        }else{
            showTip2 = "\n0 ä¸ªä¸å¯è§å­—ç¬¦";
        }
        
         new obsidian.Notice("å½“å‰ç¬”è®°å«æœ‰:"+showTip1+"\n"+showTip2,0);
    };

    åµŒå…¥å½“å‰ç½‘å€é¡µé¢ () {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ (); 
        let vid,web;
        let åŸºæœ¬æ ¼å¼ = '\n<iframe src="â– " width=100% height="500px" frameborder="0" scrolling="auto"></iframe>';
        if(æ‰€é€‰æ–‡æœ¬.match(/^https?:\/\/[^:]+/)){
            if(æ‰€é€‰æ–‡æœ¬.match(/^https?:\/\/v\.qq\.com/)){
                vid = æ‰€é€‰æ–‡æœ¬.replace(/^http.*\/([^\/=\?\.]+)(\.html.*)?$/,"$1");
                web = "https://v.qq.com/txp/iframe/player.html?vid="+vid;
            }else if(æ‰€é€‰æ–‡æœ¬.match(/^https?:\/\/www\.bilibili\.com/)){
                vid = æ‰€é€‰æ–‡æœ¬.replace(/^http.*\/([^\/=\?\.]+)(\?spm.*)?$/,"$1");
                web = "https://player.bilibili.com/player.html?bvid="+vid;
            }else if(æ‰€é€‰æ–‡æœ¬.match(/^https?:\/\/www\.youtube\.com/)){
                vid = æ‰€é€‰æ–‡æœ¬.replace(/^http.*?v=([^\/=\?\.]+)(\/.*)?$/,"$1");
                web = "https://www.youtube.com/embed/"+vid;
            }else{
                web = æ‰€é€‰æ–‡æœ¬;
            }
            åŸºæœ¬æ ¼å¼ = åŸºæœ¬æ ¼å¼.replace(/â– /,web);
            ç¬”è®°å…¨æ–‡.replaceRange(åŸºæœ¬æ ¼å¼, {line:å½“å‰è¡Œå·,ch:å½“å‰è¡Œæ–‡æœ¬.length},{line:å½“å‰è¡Œå·,ch:å½“å‰è¡Œæ–‡æœ¬.length});
            ç¼–è¾‘æ¨¡å¼.exec("goRight");
        }else{
            new obsidian.Notice("æ‰€é€‰æ–‡æœ¬ä¸ç¬¦åˆç½‘å€æ ¼å¼ï¼Œæ— æ³•åµŒå…¥ï¼");
        }
    };

    åˆ—è¡¨è½¬ä¸ºå›¾ç¤º () {
        let å¤§çº²æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/(    |\t)/mg,"â– ");
        å¤§çº²æ–‡æœ¬ = å¤§çº²æ–‡æœ¬.replace(/(\-\s|\d+\.\s)/mg,"");   //å¯¹æ‰€æœ‰æ–‡æœ¬è¡Œçš„è¡Œé¦–è¿›è¡Œæ›¿æ¢æ•´ç†,å»é™¤-
        å¤§çº²æ–‡æœ¬ = å¤§çº²æ–‡æœ¬.replace(/\s+$/mg,"");   //å¯¹æ‰€æœ‰æ–‡æœ¬è¡Œçš„è¡Œå°¾è¿›è¡Œæ›¿æ¢å»é™¤
        å¤§çº²æ–‡æœ¬ = å¤§çº²æ–‡æœ¬.replace(/\n/g,"â†µ");
        å¤§çº²æ–‡æœ¬ = å¤§çº²æ–‡æœ¬.replace(/â†µ+$/,"");   //å»é™¤æœ«å°¾å¤šä½™æ¢è¡Œç¬¦
        let tagAry = å¤§çº²æ–‡æœ¬.split("â†µ");
        //new obsidian.Notice(tagAry[0]);
        let fName = "";
        let ä¸»è¦è¯­æ³• = "";
        for(var i =0;i<tagAry.length;i++){
            var thisLine = tagAry[i];   //æ­¤è¡Œæ–‡æœ¬
            var n = thisLine.lastIndexOf("â– ");
            if(i>0){
                var upLine = tagAry[i-1];   //ä¸Šè¡Œæ–‡æœ¬
                var m = upLine.lastIndexOf("â– ");
            }
            
            if(n<0){//æ— â– ï¼Œå³ä¸ºæ ¹çº§å¤§çº²,å¯åˆ›å»º@å¯¼èˆªé¡µé¢
                fName = thisLine;
            }else{
                //new obsidian.Notice(upLine+"  "+m+"\n"+thisLine+"  "+n);
                //æ¯”è¾ƒä¸‹è¡Œä¸å½“å‰è¡Œçš„â– æ•°ï¼Œä¸‰ç§æƒ…å†µï¼Œä¸‹è¡Œå¤šï¼Œä¸¤è¡ŒåŒï¼Œä¸‹è¡Œå°‘
                thisLine = thisLine.replace(/^â– +/,"");  //å»é™¤æ ‡è¯†ç¬¦å·
                if(n>m){
                    //æœ¬è¡Œå¤šï¼Œè¿½åŠ -å½“å‰è¡Œï¼Œå‰ç¼€@
                    fName = fName+"-->"+thisLine;
                }else if(n==m){
                    //æ›¿æ¢æœ«å°¾-æ—§åç§° ä¸º -å½“å‰è¡Œ
                    fName = fName.replace(/(?<=(^|\-\-\>))[^\-\>]+$/,thisLine);
                }else{
                    var cha=Number(m-n)+1;  //è®¡ç®—ä¸Šè¡Œã€æœ¬è¡Œçš„â– æ•°
                    fName = fName.replace(eval("/(\-\-\>[^\-\>]+){"+cha+"}$/"),"-->"+thisLine);
                }
                var è¡Œè¯­æ³• = fName.replace(/^.*\-\-\>(?=[^\-\>]+\-\-\>[^\-\>]+$)/mg,"");
                ä¸»è¦è¯­æ³• = ä¸»è¦è¯­æ³• + "â†µ"+ è¡Œè¯­æ³•;
            }
        }
        var è¾“å‡ºè¯­æ³• = "%%æ­¤å›¾ç¤ºç”±åˆ—è¡¨æ–‡æœ¬è½¬æ¢è€Œæˆï¼%%â†µ"+ä¸»è¦è¯­æ³•
        ç¼–è¾‘æ¨¡å¼.setCursor({line:0,ch:0});
        ç¬”è®°æ­£æ–‡ = this.è·å–ç¬”è®°æ­£æ–‡();
        var æ–°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/\n/g,"â†µ");
        if(æ–°æ­£æ–‡.includes("%%æ­¤å›¾ç¤ºç”±åˆ—è¡¨æ–‡æœ¬è½¬æ¢è€Œæˆï¼%%")){
            æ–°æ­£æ–‡ = æ–°æ­£æ–‡.replace(/%%æ­¤å›¾ç¤ºç”±åˆ—è¡¨æ–‡æœ¬è½¬æ¢è€Œæˆï¼%%â†µ.+?(?=â†µ```)/g, è¾“å‡ºè¯­æ³•);
            æ–°æ­£æ–‡ = æ–°æ­£æ–‡.replace(/â†µ/g,"\n");
            this.æ›¿æ¢ç¬”è®°æ­£æ–‡ (æ–°æ­£æ–‡);
        }else{
            new obsidian.Notice("åˆ—è¡¨æ–‡æœ¬å·²è½¬ä¸ºMerMaidè¯­æ³•ã€‚\nå¯ä»¥ç²˜è´´ï¼");
            è¾“å‡ºè¯­æ³• = è¾“å‡ºè¯­æ³•.replace(/â†µ/g,"\n");
            navigator.clipboard.writeText("```mermaid\ngraph TD\n"+è¾“å‡ºè¯­æ³•+"\n```\n");
        };
    }

    å‡åºæ’åˆ—æ‰€é€‰æ®µè½() {
		this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!æ‰€é€‰æ–‡æœ¬) return;
        var æ®µè½ = æ‰€é€‰æ–‡æœ¬.replace(/\n\s*(?=\n)/g,"").split("\n");    //å»é™¤ç©ºè¡Œï¼Œæ‹†åˆ†ä¸ºæ•°ç»„
        æ®µè½.sort();
        this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ®µè½.join("\n"));
    };
    é™åºæ’åˆ—æ‰€é€‰æ®µè½() {
		this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!æ‰€é€‰æ–‡æœ¬) return;
        var æ®µè½ = æ‰€é€‰æ–‡æœ¬.replace(/\n\s*(?=\n)/g,"").split("\n");    //å»é™¤ç©ºè¡Œï¼Œæ‹†åˆ†ä¸ºæ•°ç»„
        æ®µè½.sort().reverse();
        this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ®µè½.join("\n"));
    };

    æ·»åŠ æ®µè½ç¼–å·() {
		this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!æ‰€é€‰æ–‡æœ¬){
            æ‰€é€‰æ–‡æœ¬ = ç¬”è®°æ­£æ–‡;
        };
        let æ’é™¤è¡Œ = /^(#+.*|```|\.*|\|([^\|]*\|)*|\>.*)\s*$/m;   //æ’é™¤ç‰¹æ®Šè¡Œæ–‡æœ¬
        //new obsidian.Notice("å½“å‰ä¸ºæ ‡é¢˜è¡Œ "+_str);
        var æœ«è¡Œè¡Œå· = ç¼–è¾‘æ¨¡å¼.lastLine();
        let lineId = 1;
        for(var i= 0;i<=æœ«è¡Œè¡Œå·;i++){
            var æœ¬è¡Œæ–‡æœ¬ = ç¼–è¾‘æ¨¡å¼.getLine(i);
            if(æ’é™¤è¡Œ.test(æœ¬è¡Œæ–‡æœ¬)){
               
            }else{
                ç¬”è®°å…¨æ–‡.replaceRange(lineId+". ", {line:i,ch:0},{line:i,ch:0});
                lineId ++;
            }
        }
    };

    å»é™¤æ®µè½ç¼–å·() {
		this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!ç¬”è®°æ­£æ–‡) return;
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/^[0-9]+\.\s+([^\s])/mg,"$1");
        this.æ›¿æ¢ç¬”è®°æ­£æ–‡ (ç¬”è®°æ­£æ–‡);
    };


    æŠ˜å åŒçº§æ ‡é¢˜() {
		this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!ç¬”è®°å…¨æ–‡) return;
        if(/^#+\s/.test(å½“å‰è¡Œæ–‡æœ¬)){
            this.app.commands.executeCommandById('editor:unfold-all');
            let _str = å½“å‰è¡Œæ–‡æœ¬.replace(/^(#+)\s.*$/,"$1");   //è·å–å‰é¢çš„å¤šä¸ª#å·
            //new obsidian.Notice("å½“å‰ä¸ºæ ‡é¢˜è¡Œ "+_str);
            var æœ«è¡Œè¡Œå· = ç¼–è¾‘æ¨¡å¼.lastLine();
            /*for(var i= æœ«è¡Œè¡Œå·;i>=0;i--){
                ç¼–è¾‘æ¨¡å¼.setCursor({line:i,ch:0});
                //new obsidian.Notice(æœ¬è¡Œæ–‡æœ¬);
                var æœ¬è¡Œæ–‡æœ¬ = ç¼–è¾‘æ¨¡å¼.getLine(i);
                if(eval("/^"+_str+"(?=[^#])/").test(æœ¬è¡Œæ–‡æœ¬)){
                    this.app.commands.executeCommandById('editor:toggle-fold');
                }
            }*/
            var arr = ç¼–è¾‘æ¨¡å¼.getRange({line:0,ch:0},{line:æœ«è¡Œè¡Œå·,ch:0}).split("\n");
            //console.log(arr);
            for (var i=arr.length; i>=0; i--) {
                if(eval("/^"+_str+"(?=[^#])/").test(arr[i])) {
                    ç¼–è¾‘æ¨¡å¼.setCursor({line:i,ch:0});
                    this.app.commands.executeCommandById('editor:toggle-fold');
                }
            }
        }
    };
    
    //ç«å†·æ·»åŠ 

    å½“å‰è¡Œå†…å®¹æ ¹æ®å…‰æ ‡æ‰€åœ¨å†…éƒ¨é“¾æ¥åˆ†å‰²() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯()
        var è¡Œå†…å®¹æ ¹æ®å…‰æ ‡å†…éƒ¨é“¾æ¥åˆ†å‰² = [];
        //console.log(é€‰è‡³è¡Œé¦–);
        //console.log(é€‰è‡³è¡Œå°¾);
        if (é€‰è‡³è¡Œé¦–.endsWith("]]")) { //å…‰æ ‡åœ¨å†…éƒ¨é“¾æ¥èŒƒå›´(å«]]åé¢ï¼Œå› ä¸ºæ·»åŠ å†…éƒ¨é“¾æ¥å…‰æ ‡é»˜è®¤åœ¨æ­¤ä½ç½®)
            var m0 = é€‰è‡³è¡Œé¦–.match(/^(.*)(!?\[\[.*?\]\])$/);
            è¡Œå†…å®¹æ ¹æ®å…‰æ ‡å†…éƒ¨é“¾æ¥åˆ†å‰² = [m0[1], m0[2], é€‰è‡³è¡Œå°¾];
        } else if (é€‰è‡³è¡Œé¦–.match(/\[\[/) && é€‰è‡³è¡Œå°¾.match(/\]\]/)) { //å…‰æ ‡åœ¨å†…éƒ¨é“¾æ¥å†…(TODO ä¸æ”¯æŒåœ¨]]ç¬¦å·å†…)
            var m0 = é€‰è‡³è¡Œé¦–.match(/^(.*)(!?\[\[.*)$/);
            var m1 = é€‰è‡³è¡Œå°¾.match(/^(.*?\]\])(.*)/);
            è¡Œå†…å®¹æ ¹æ®å…‰æ ‡å†…éƒ¨é“¾æ¥åˆ†å‰² = [m0[1], m0[2]+m1[1], m1[2]];
        } else {
            è¡Œå†…å®¹æ ¹æ®å…‰æ ‡å†…éƒ¨é“¾æ¥åˆ†å‰² = ["not in [[]]"];
        }
        //console.log(è¡Œå†…å®¹æ ¹æ®å…‰æ ‡å†…éƒ¨é“¾æ¥åˆ†å‰²);
        return è¡Œå†…å®¹æ ¹æ®å…‰æ ‡å†…éƒ¨é“¾æ¥åˆ†å‰²;
    }

    //["![[", "å†…éƒ¨é“¾æ¥æ–‡æœ¬" , "]]"]
    å†…éƒ¨é“¾æ¥åˆ†å‰²(å†…éƒ¨é“¾æ¥å«ç¬¦å·) {
        //console.log("å†…éƒ¨é“¾æ¥å«ç¬¦å· = " + å†…éƒ¨é“¾æ¥å«ç¬¦å·);
        var m = å†…éƒ¨é“¾æ¥å«ç¬¦å·.match(/^(!?\[\[)(.*)(\]\])$/);
        if (m)
            return [m[1],m[2],m[3]];
        else
            console.log("å†…éƒ¨é“¾æ¥åˆ†å‰² å¤±è´¥");
    }

    å†…éƒ¨é“¾æ¥åç§°(å†…éƒ¨é“¾æ¥æ–‡æœ¬) {
        return å†…éƒ¨é“¾æ¥æ–‡æœ¬.replace(/.*\//, '');
    }

    //æ·»åŠ å†…éƒ¨é“¾æ¥å†…å®¹çš„åˆ«åï¼Œæ¯”å¦‚ a/b/c â†’ a/b/c|c
    ä¿®æ”¹å†…éƒ¨é“¾æ¥çš„æ˜¾ç¤ºåç§°() {
        var arr = this.å½“å‰è¡Œå†…å®¹æ ¹æ®å…‰æ ‡æ‰€åœ¨å†…éƒ¨é“¾æ¥åˆ†å‰²();
        if (arr[1].indexOf("|") > -1) {
            return;
        }
        var å†…éƒ¨é“¾æ¥æ•°ç»„ = this.å†…éƒ¨é“¾æ¥åˆ†å‰²(arr[1]);
        var åç§° = this.å†…éƒ¨é“¾æ¥åç§°(å†…éƒ¨é“¾æ¥æ•°ç»„[1]);
        if (åç§°.indexOf("#") > -1) //æœ‰æ ‡é¢˜ï¼Œå–æ ‡é¢˜åé¢
            åç§° = åç§°.replace(/.*#/, '');
        if (åç§°.indexOf("^") > -1) //æœ‰æ®µè½æ ‡è®°ï¼Œåˆ™åˆ é™¤
            åç§° = åç§°.replace(/\s+\^.*/, '');
        å†…éƒ¨é“¾æ¥æ•°ç»„[1] += `|${åç§°}`;
        //console.log(å†…éƒ¨é“¾æ¥æ•°ç»„);
        arr[1] = å†…éƒ¨é“¾æ¥æ•°ç»„.join("");
        //console.log(arr);
        this.app.workspace.activeLeaf.view.editor.setLine(å½“å‰è¡Œå·, arr.join(""));
        ç¼–è¾‘æ¨¡å¼.setCursor({line:å½“å‰è¡Œå·,ch:arr[0].length+arr[1].length-2}); //-2æ˜¯å› ä¸º
    }

    æ‰€æœ‰ä¸Šçº§æ ‡é¢˜è·¯å¾„() {
        ç¼–è¾‘æ¨¡å¼ = this.è·å–ç¼–è¾‘æ¨¡å¼ ();
        å½“å‰å…‰æ ‡ = ç¼–è¾‘æ¨¡å¼.getCursor();
        å½“å‰è¡Œå· = å½“å‰å…‰æ ‡.line;
        var arr = ç¼–è¾‘æ¨¡å¼.getRange({line:0,ch:0},{line:å½“å‰è¡Œå·,ch:0}).split("\n");
        //console.log(arr);
        //ç¬¬ä¸€ä¸ªè¦åŒ¹é…çš„ re
        if (arr[arr.length-1].match(/^(\#+)\s/)) { //å½“å‰æ˜¯æ ‡é¢˜ï¼Œåˆ™æŸ¥æ‰¾ä¸Šä¸€çº§æ ‡é¢˜
            var l = arr[arr.length-1].match(/^(\#+)\s/)[1].length - 1;
            if (l == 0)
                return [];
            var re = new RegExp(`^\#{${l}}\\s`);
        } else {
            var re = /^\#+\s/;
        }
        //console.log(re);
        var arrRes = [];
        for (var i=arr.length-1; i>=0; i--) {
            //console.log(arr[i]);
            if (re.test(arr[i])) {
                arrRes.push(arr[i]);
                var l = arr[i].match(/^(\#+)\s/)[1].length - 1;
                if (l == 0)
                    return arrRes;
                re = new RegExp(`^\#{${l}}\\s`);
                //console.log(re);
            }
        }
        return arrRes;
    };

    æŠ˜å æ ‡é¢˜ç­‰çº§(æŠ˜å ç­‰çº§) {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!ç¬”è®°å…¨æ–‡)
            return;
        this.app.commands.executeCommandById('editor:unfold-all');
        var æœ«è¡Œè¡Œå· = ç¼–è¾‘æ¨¡å¼.lastLine();
        var arr = ç¼–è¾‘æ¨¡å¼.getRange({line:0,ch:0},{line:æœ«è¡Œè¡Œå·,ch:0}).split("\n");
        var re = new RegExp(`^\#{${æŠ˜å ç­‰çº§}}\\s`);
        for (var i=arr.length; i>=0; i--) {
            if (re.test(arr[i])) {
                ç¼–è¾‘æ¨¡å¼.setCursor({line:i,ch:0});
                this.app.commands.executeCommandById('editor:toggle-fold');
            }
        }
    };

    æ’å…¥æœ‰æ•ˆç©ºè¡Œ() {
		this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        ç¬”è®°å…¨æ–‡.replaceRange("ã€€\n", å½“å‰å…‰æ ‡, å½“å‰å…‰æ ‡);
        ç¼–è¾‘æ¨¡å¼.exec("goRight");
        ç¼–è¾‘æ¨¡å¼.exec("goRight");
    };

    æ‰¹é‡æ’å…¥ç©ºè¡Œ() {
		this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!ç¬”è®°æ­£æ–‡) return;
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<!^(\s*\- |\s*[0-9]+\.|\s*\>|\n)[^\n]*)\n(?!(\s*\- |\s*[0-9]+\.|\s*\>|\n))/g,"$1\n\n");
        this.æ›¿æ¢ç¬”è®°æ­£æ–‡ (ç¬”è®°æ­£æ–‡);
    };
    
    æ‰¹é‡å»é™¤ç©ºè¡Œ() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!ç¬”è®°æ­£æ–‡) return;
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(\r\n|\n)[\t\s]*(\r\n|\n)/g,"\n");
        this.æ›¿æ¢ç¬”è®°æ­£æ–‡ (ç¬”è®°æ­£æ–‡);
    };

    ç©ºæ ¼è½¬ä¸ºç©ºè¡Œ() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!ç¬”è®°æ­£æ–‡) return;
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<=[ä¸€-é¾¥ã€‚ï¼Ÿï¼])[\t\s](?=[ä¸€-é¾¥])/g,"\n");
        this.æ›¿æ¢ç¬”è®°æ­£æ–‡ (ç¬”è®°æ­£æ–‡);
    };

    è¡Œé¦–ç¼©è¿›ä¸¤å­—ç¬¦() {
		this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!ç¬”è®°æ­£æ–‡) return;
        //new obsidian.Notice(ç¬”è®°æ­£æ–‡);
        if(isIndent){
            ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/^[â€Œâ€Œâ€Œã€€]+/mg,"");
            ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/^(?!([\n\s\>#]+|```|\-\-\-|\|[^\|]|\*\*\*))/mg,"â€Œâ€Œâ€Œã€€ã€€");
            isIndent = false;
        }else{
            ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/^[â€Œâ€Œâ€Œã€€]+/mg,"");
            isIndent = true;
        }
        this.æ›¿æ¢ç¬”è®°æ­£æ–‡ (ç¬”è®°æ­£æ–‡);
    };

    è¡Œé¦–æ·»åŠ ç©ºæ ¼() {
		this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!æ‰€é€‰æ–‡æœ¬) return;
        æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/(?<=(^|\n))(?!(\-\-\-|\*\*\*|\s))/g,"  ");
        this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
    };

    å»é™¤è¡Œé¦–ç©ºæ ¼() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!æ‰€é€‰æ–‡æœ¬) return;
        æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/(?<=(^|\n))\s+/g,"");
        this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
    };

    æœ«å°¾è¿½åŠ ç©ºæ ¼() {
		this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!ç¬”è®°æ­£æ–‡) return;
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<!(\-\-\-|\*\*\*|\s\s))\n/g,"  \n");
        this.æ›¿æ¢ç¬”è®°æ­£æ–‡ (ç¬”è®°æ­£æ–‡);
    };
        
    å»é™¤æœ«å°¾ç©ºæ ¼() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!ç¬”è®°æ­£æ–‡) return;
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/\s+(?=($|\n))/g,"")
        this.æ›¿æ¢ç¬”è®°æ­£æ–‡ (ç¬”è®°æ­£æ–‡);
    };

    ä¸Šæ–¹æ’å…¥ç©ºè¡Œ(_str) {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        var æ–°æ–‡æœ¬ = "\r\n"+å½“å‰è¡Œæ–‡æœ¬;
        ç¬”è®°å…¨æ–‡.replaceRange(æ–°æ–‡æœ¬, {line:å½“å‰è¡Œå·,ch:0},{line:å½“å‰è¡Œå·,ch:å½“å‰è¡Œæ–‡æœ¬.length});
    };

    ä¸‹æ–¹æ’å…¥ç©ºè¡Œ(_str) {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        var æ–°æ–‡æœ¬ = å½“å‰è¡Œæ–‡æœ¬+"\r\n";  //.replace(/^([^\r\n]*)$/,"$1\n");
        ç¬”è®°å…¨æ–‡.replaceRange(æ–°æ–‡æœ¬, {line:å½“å‰è¡Œå·,ch:0},{line:å½“å‰è¡Œå·,ch:å½“å‰è¡Œæ–‡æœ¬.length});
        ç¼–è¾‘æ¨¡å¼.setSelection({line:å½“å‰è¡Œå·,ch:å½“å‰è¡Œæ–‡æœ¬.length+1}, {line:å½“å‰è¡Œå·,ch:å½“å‰è¡Œæ–‡æœ¬.length+1});
    };
   
    æ·»åŠ é—´éš”ç©ºæ ¼() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!ç¬”è®°æ­£æ–‡) return;
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/([a-zA-Z]+)([ä¸€-é¿†]+)/g,"$1 $2")
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/([ä¸€-é¿†]+)([a-zA-Z]+)/g,"$1 $2")
        this.æ›¿æ¢ç¬”è®°æ­£æ–‡ (ç¬”è®°æ­£æ–‡);
    };

    å»é™¤æ‰€æœ‰ç©ºæ ¼() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!ç¬”è®°æ­£æ–‡) return;
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/[ ã€€]+/g,"")
        this.æ›¿æ¢ç¬”è®°æ­£æ–‡ (ç¬”è®°æ­£æ–‡);
    };

    /* æ­¤åŠŸèƒ½æš‚æœªå¯ç”¨ã€‚*/
     ç»­é€‰å½“å‰æ–‡æœ¬() { 
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        var lang = é€‰è‡³è¡Œå°¾.indexOf(æ‰€é€‰æ–‡æœ¬);
        var èµ·å§‹ = é€‰è‡³è¡Œé¦–.length+lang;
        var ç»“æŸ = èµ·å§‹ + æ‰€é€‰æ–‡æœ¬.length;
        if(lang<0){ return};
        ç¼–è¾‘æ¨¡å¼.setSelection({line:å½“å‰è¡Œå·,ch:èµ·å§‹}, {line:å½“å‰è¡Œå·,ch:ç»“æŸ});
    };

    æœç´¢å½“å‰æ–‡æœ¬() {
        var å½“å‰æ–‡ä»¶ = this.app.workspace.getActiveFile();
        var å½“å‰æ–‡ä»¶è·¯å¾„ = å½“å‰æ–‡ä»¶.name;
        //new obsidian.Notice(å½“å‰æ–‡ä»¶è·¯å¾„);
        å½“å‰æ–‡ä»¶è·¯å¾„ = å½“å‰æ–‡ä»¶è·¯å¾„.replace(/\.md$/,"")
        var view = this.app.workspace.getActiveViewOfType(obsidian.MarkdownView);
        var _txt = view.getSelection();
        _txt = _txt.replace(/^/,"path:"+å½“å‰æ–‡ä»¶è·¯å¾„+" /")
        this.app.internalPlugins.getPluginById('global-search').instance.openGlobalSearch(_txt)
    };

    ä¿®å¤æ„å¤–æ–­è¡Œ() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!æ‰€é€‰æ–‡æœ¬) return;
        æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/(?<=[^a-zA-Z])\s+(?=\r*\n)/g,"")
        æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/(?<=\w)\s+(?=\r*\n)/g," ")
        //å»é™¤æœ«å°¾éå­—æ¯åçš„ç©ºæ ¼ï¼Œå°†æœ«å°¾å­—æ¯åçš„å¤šä¸ªç©ºæ ¼ä¿ç•™ä¸€ä¸ª
        æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/([^ã€‚ï¼Ÿï¼\.\?\!\w])(\r*\n)+/mg,"$1")
        æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/(\w)(\r*\n)+/mg,"$1 ")
        this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
    };

    ä¿®å¤é”™è¯¯è¯­æ³•() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!ç¬”è®°æ­£æ–‡) return;
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/[\[ã€]([^\[\]ã€ã€‘]*)[ã€‘\]][ï¼ˆ|\(]([^\(\)ï¼ˆï¼‰]*)[ï¼‰|\)]/g,"\[$1\]\($2\)");
        //å°† ã€ã€‘ï¼ˆï¼‰æˆ–ã€ã€‘() è½¬æ¢ä¸º[]()
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/\[+([^\[\]]*)\]+\(/g,"\[$1\](");
        //å¤„ç† bookXnote å›é“¾è¯­æ³•ï¼Œå°† [[é“¾æ¥]]() è½¬æ¢ä¸º []()
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<=^|\s)    /mg,"\t");
        //æŠŠ å››ä¸ªç©ºæ ¼è½¬æ¢ä¸º åˆ¶è¡¨ç¬¦
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<=\]\([^\(\)]+\))$/g,"  ");
        //åœ¨è¶…é“¾æ¥æœ«å°¾å¤„è¡¥åŠ ä¸¤ç©ºæ ¼
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/\*\s+\>\s+/g,"- ");
        //å¤„ç† bookXnote å›é“¾è¯­æ³•ä¸­çš„åˆ—è¡¨
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<=\s)[0-9]+ã€‚ /g,"1. ");
        //æŠŠ 1ã€‚ è½¬æ¢ä¸º æœ‰åºåˆ—è¡¨æ ·å¼
        this.æ›¿æ¢ç¬”è®°æ­£æ–‡ (ç¬”è®°æ­£æ–‡);
    };

    ä¿®å¤é”™è¯¯æ ‡ç‚¹() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if (!ç¬”è®°æ­£æ–‡) return;
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<=[ä¸€-é¾¥])\s*,\s*(?=[ä¸€-é¾¥])/g,"ï¼Œ");
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<=[ä¸€-é¾¥])\s*\s*\.(?=[ä¸€-é¾¥])/g,"ã€‚");   //æ•°å­—åçš„é»‘ç‚¹ä¸è½¬ä¸ºå¥å·
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<=[ä¸€-é¾¥])\s*\?\s*(?=[ä¸€-é¾¥])/g,"ï¼Ÿ");
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<=[ä¸€-é¾¥])\s*:\s*(?=[ä¸€-é¾¥])/g,"ï¼š");
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<=[ä¸€-é¾¥])\s*;\s*(?=[ä¸€-é¾¥])/g,"ï¼›");
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<=[ä¸€-é¾¥])\s+(?=[ä¸€-é¾¥])/g,"");
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<=[^ä¸€-é¾¥])ï¼Œ(?=[^ä¸€-é¾¥])/g,",");
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<=[^ä¸€-é¾¥])ã€‚(?=[^ä¸€-é¾¥])/g,".");   //æ•°å­—åçš„é»‘ç‚¹ä¸è½¬ä¸ºå¥å·
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<=[^ä¸€-é¾¥])ï¼Ÿ(?=[^ä¸€-é¾¥])/g,"?");
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<=[^ä¸€-é¾¥])ï¼š(?=[^ä¸€-é¾¥])/g,":");
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<=[^ä¸€-é¾¥])ï¼›(?=[^ä¸€-é¾¥])/g,";");
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/[\(ï¼ˆ)]([^ä¸€-é¾¥]+)[\)ï¼‰]/g,"($1)");
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/[\(ï¼ˆ)](.*?[ä¸€-é¾¥].*?)[\)ï¼‰]/g,"ï¼ˆ$1ï¼‰");
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/ï¼šï¼š/g,"::");
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/ã€ã€/g,"[[");
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/ã€‘ã€‘/g,"]]");
        ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(/(?<=[,\.?!])([^\s])/g," $1");
        this.æ›¿æ¢ç¬”è®°æ­£æ–‡ (ç¬”è®°æ­£æ–‡);
    };

    è½¬æ¢è·¯å¾„() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null || ç¬”è®°æ­£æ–‡==null){return};
        var link1 = /^[a-zA-Z]:\\/;	//ç¬¦åˆæ™®é€šè·¯å¾„æ ¼å¼
        var link2 = /^(\[[^\[\]]*\]\()*file:\/\/\/[^\(\)]*\)*/;	//ç¬¦åˆ[](fileè·¯å¾„)æ ¼å¼
        var link3 = /^\[[^\[\]]*\]\(([a-zA-Z]:\\[^\(\)]*)\)*/;	//æ„å¤–è·¯å¾„æ ¼å¼
        if (link1.test(æ‰€é€‰æ–‡æœ¬)){
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\s/mg,"%20");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^(.*)$/m,"\[file\]\(file:///$1\)");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\\/img,"\/");
            this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
        }else if(link2.test(æ‰€é€‰æ–‡æœ¬)){
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/%20/mg," ");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^(\[[^\[\]]*\]\()*file:\/\/\/([^\(\)]*)\)*/m,"$2");
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/\//mg,"\\");
            this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
        }else if(link3.test(æ‰€é€‰æ–‡æœ¬)){
            æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/^\[[^\[\]]*\]\(([a-zA-Z]:\\[^\(\)]*)\)*/m,"$1");
            this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
        }else{
            new obsidian.Notice("æ‚¨åˆ’é€‰çš„è·¯å¾„æ ¼å¼ä¸æ­£ç¡®ï¼");
            return;
        }
    };

    æ‹†åˆ†å¤šè¡Œ() {
        this.è·å–ç¼–è¾‘å™¨ä¿¡æ¯ ();
        if(æ‰€é€‰æ–‡æœ¬==null || ç¬”è®°æ­£æ–‡==null){return};
        æ‰€é€‰æ–‡æœ¬ = æ‰€é€‰æ–‡æœ¬.replace(/([ã€‚ï¼Ÿï¼]) /g,"$1\n");
        this.æ›¿æ¢æ‰€é€‰æ–‡æœ¬ (æ‰€é€‰æ–‡æœ¬);
    };

    ç®€ä½“è½¬ç¹() {
        ç¬”è®°æ­£æ–‡ = this.è·å–ç¬”è®°æ­£æ–‡();
        if (!ç¬”è®°æ­£æ–‡) return;
        for (var i=0;i<ç®€ä½“å­—è¡¨.length;i++){ 
            ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(eval("/"+ç®€ä½“å­—è¡¨[i]+"/g"),ç¹ä½“å­—è¡¨[i]);
        }
        this.æ›¿æ¢ç¬”è®°æ­£æ–‡ (ç¬”è®°æ­£æ–‡);
    }

    ç¹ä½“è½¬ç®€() {
        ç¬”è®°æ­£æ–‡ = this.è·å–ç¬”è®°æ­£æ–‡();
        if (!ç¬”è®°æ­£æ–‡) return;
        for (var i=0;i<ç¹ä½“å­—è¡¨.length;i++){ 
            ç¬”è®°æ­£æ–‡ = ç¬”è®°æ­£æ–‡.replace(eval("/"+ç¹ä½“å­—è¡¨[i]+"/g"),ç®€ä½“å­—è¡¨[i]);
        }
        this.æ›¿æ¢ç¬”è®°æ­£æ–‡ (ç¬”è®°æ­£æ–‡);
    }

    ç”Ÿæˆæ—¶é—´æˆ³() {
        var date = new Date();
        return date.getFullYear().toString() + this.pad2(date.getMonth() + 1) + this.pad2(date.getDate()); // + this.pad2(date.getHours()) + this.pad2(date.getMinutes()) + this.pad2(date.getSeconds()
    };
    pad2(n) {
        return n < 10 ? '0' + n : n
    };
}


class editSettingsTab extends obsidian.PluginSettingTab {
    constructor(app, plugin) {
        super(app, plugin);
        this.plugin = plugin;
    }

    display() {
        var plugin = this.plugin;
        var containerEl = this.containerEl;
        containerEl.empty();
        containerEl.createEl('h2', { text: "ZH å¢å¼ºç¼–è¾‘ V"+å½“å‰ç‰ˆæœ¬ });
        new obsidian.Setting(containerEl)
            .setName("ğŸ“£ è½¬æ¢å†…éƒ¨é“¾æ¥ã€ŒAlt+Zã€ï¼šåœ¨é€‰æ–‡ä¸¤ç«¯æ·»åŠ æˆ–å»é™¤ [[ ]] ç¬¦å·")
            .setDesc("æ”¯æŒæ‰¹é‡è½¬æ¢å¤šè¡Œæ–‡æœ¬ï¼ˆéœ€ç”¨æ¢è¡Œç¬¦åˆ†éš”ï¼‰æˆ–å¤šå¥æ–‡æœ¬ï¼ˆéœ€ç”¨é¡¿å·åˆ†éš”ï¼‰ã€‚")
  
        var div0 = containerEl.createEl('p', {
            cls: 'recent-files-donation',
        });

        var linkText = document.createDocumentFragment();
        linkText.appendText("ğŸ“£ è½¬æ¢åŒä¹‰é“¾æ¥ã€ŒAlt+Qã€ï¼šå°†é€‰æ–‡è½¬æ¢ä¸º [[|é€‰æ–‡]] æ ·å¼åå†é€‰æ‹©æ–‡æ¡£")
        linkText.appendChild(document.createElement('br'));
        linkText.appendChild(document.createElement('br'));
        linkText.appendText("ğŸ“£ è½¬æ¢æ ‡ç­¾ã€ŒAlt+Shift+3ã€ï¼šå°†é€‰æ–‡è½¬æ¢ä¸º #é€‰æ–‡ æ ‡ç­¾æ ·å¼æˆ–åå‘è½¬æ¢")
        linkText.appendChild(document.createElement('br'));
        div0.appendChild(linkText);

        /*
        new obsidian.Setting(containerEl)
            .setName('ğŸ“£ æ™ºèƒ½æ¢è¡Œã€ŒEnterã€ é»˜è®¤æ”¯æŒ```ä»£ç å—```å†…æ¢è¡Œç¼©è¿›æ•ˆæœ')
            .setDesc('å¯ç”¨æ­¤é¡¹åï¼Œåœ¨éåˆ—è¡¨æˆ–ä»£ç å—çš„æ–‡æœ¬ä¸­æŒ‰ä¸‹å›è½¦åè¡¥åŠ ä¸€æ¬¡æ¢è¡Œï¼›å¦‚æƒ³æ™®é€šæ¢è¡Œï¼Œå¯æŒ‰ä¸‹ Shift+Enter é”®ã€‚')
            .addToggle(toggle => toggle.setValue(this.plugin.settings.twoEnter)
            .onChange((value) => {
            this.plugin.settings.twoEnter = value;
            this.plugin.saveSettings();
        }));
        */

        new obsidian.Setting(containerEl)
            .setName("ğŸ“£ æ’å…¥åˆ¶è¡¨ç¬¦ã€ŒTabã€ åœ¨æ™®é€šæ–‡æœ¬è¡Œä¸­æ’å…¥åˆ¶è¡¨ç¬¦æ•ˆæœ")
            .setDesc("å¯ç”¨æ­¤é¡¹åï¼Œåœ¨æ™®é€šæ–‡æœ¬è¡Œä¸­æŒ‰ä¸‹ Tab é”®ä¼šæ’å…¥4ä¸ªç©ºæ ¼ï¼Œä¸å†æ•´è¡Œç¼©è¿›ã€‚")
            .addToggle(toggle => toggle.setValue(this.plugin.settings?.isTab)
            .onChange((value) => {
            this.plugin.settings.isTab = value;
            this.plugin.saveSettings();
        }));

        new obsidian.Setting(containerEl)
            .setName("ğŸ“£ æ™ºèƒ½è¯­æ³•ã€ŒAlt+;ã€ï¼šè‡ªåŠ¨è½¬æ¢ã€åŒ¹é…æˆ–è·³è¿‡å„ç§ç±»å‹çš„æ‹¬å·æˆ–ä»£ç å—è¯­æ³•")
            .setDesc("å¯å°†[( (< ([ \"[ \'[ç­‰ç»„åˆè½¬ä¸ºã€–ã€ˆã€”ã€ã€Œï¼Œæˆ–å°†dv qy mm CSS js tyç­‰å­—ç¬¦ä¸²ä¸ºä»£ç å—ï¼Œå°†ç±»å‹è¯è¯­è½¬ä¸ºCalloutå¼•ç”¨è¯­æ³•ã€‚")

        new obsidian.Setting(containerEl)
            .setName("ğŸ“£ æ™ºèƒ½ç²˜è´´ã€ŒCtrl+Alt+Vã€âˆ¶å°†å¤åˆ¶çš„å†…å®¹ç²˜è´´ä¸ºMdè¯­æ³•æ ·å¼")
            .setDesc("ä¾æ®å¤åˆ¶å†…å®¹çš„ç±»å‹ï¼Œå°†è¡¨æ ¼ã€ç½‘å€ã€æœ¬åœ°è·¯å¾„æˆ–ä»£ç ç›´æ¥ç²˜è´´ä¸ºMDè¡¨æ ¼ã€è¶…é“¾æ¥æˆ–ä»£ç å—æ ¼å¼ã€‚")

        new obsidian.Setting(containerEl)
            .setName("ğŸ“£ é”®æ§å…‰æ ‡ç§»åŠ¨ã€ŒAlt+I, +J, +K, +Lã€")
            .setDesc("æŒ‰ä¸‹Alt +Iå‘ä¸Š +Jå‘å·¦ +Kå‘ä¸‹ +Lå‘å³ +Uæ–‡é¦– +Næ–‡æœ« å¿«æ·é”®ï¼Œæ§åˆ¶å…‰æ ‡ç§»åŠ¨ä½ç½®ã€‚")

        new obsidian.Setting(containerEl)
            .setName("ğŸ“£ é”®æ§å…‰æ ‡è·³è½¬ã€ŒAlt+Shift +I, +Kã€")
            .setDesc("æ§åˆ¶å…‰æ ‡åœ¨æ ‡é¢˜ã€åˆ—è¡¨ã€å¾…åŠã€ä»£ç å—å’Œå¼•ç”¨ç­‰æ–‡æœ¬è¡Œ æˆ–åœ¨ç²—ä½“ã€é«˜äº®ã€æ³¨é‡Šã€åˆ é™¤ç­‰MDè¯­æ³•å­—ç¬¦ä¹‹é—´ ä¸Šä¸‹è·³è½¬")
        
        new obsidian.Setting(containerEl)
            .setName('ğŸ“£ é”®æ§åˆ‡æ¢åŒæ–‡ä»¶å¤¹å†…çš„æ–‡ä»¶æ˜¾ç¤ºã€ŒAlt+Shift +U +Nã€')
            .setDesc('æŒ‰ä¸‹å¿«æ·é”®ï¼Œæ§åˆ¶æ‰“å¼€åŒæ–‡ä»¶å¤¹å†…çš„ä¸Šä¸€æ–‡ä»¶æˆ–ä¸‹ä¸€æ–‡ä»¶ã€‚')
        
        new obsidian.Setting(containerEl)
            .setName('ğŸ“£ è®¾ç½®æ ‡é¢˜åŠç²—ã€æ–œã€åˆ ã€äº®ç­‰æ•ˆæœï¼ˆMarkDownè¯­æ³•ï¼‰åŠŸèƒ½ã€‚')
            .setDesc('å¯ç”¨åï¼Œå½“æœªé€‰æ–‡æœ¬æ—¶æŒ‰ä¸‹Alt + Shift +CåŠ ç²— +Gé«˜äº® +Såˆ é™¤çº¿ +Uä¸Šæ ‡ +Nä¸‹æ ‡ ç­‰å¿«æ·é”®ï¼Œå³å¼€å¯æˆ–å…³é—­ MDè¯­æ³•ã€Œæ ¼å¼åˆ·ã€åŠŸèƒ½ã€‚')

        var div1 = containerEl.createEl('p', {
            cls: 'recent-files-donation',
        });
        var mdText = document.createDocumentFragment();
        mdText.appendText('è½¬æ¢æ ‡é¢˜è¯­æ³•ã€ŒCtrl+ 1-6ã€âˆ¶æŒ‡å®šæˆ–å–æ¶ˆå½“å‰è¡Œæ–‡æœ¬ä¸ºNçº§æ ‡é¢˜');
        mdText.appendChild(document.createElement('br'));
        mdText.appendText('è°ƒé«˜æ ‡é¢˜çº§åˆ«ã€Œæœªè®¾ç½®ã€âˆ¶å°†å½“å‰æ ‡é¢˜çº§åˆ«è°ƒé«˜ä¸€çº§ï¼ˆæœ€é«˜ä¸ºä¸€çº§ï¼‰');
        mdText.appendChild(document.createElement('br'));
        mdText.appendText('è°ƒä½æ ‡é¢˜çº§åˆ«ã€Œæœªè®¾ç½®ã€âˆ¶å°†å½“å‰æ ‡é¢˜çº§åˆ«è°ƒä½ä¸€çº§ï¼ˆæœ€ä½ä¸ºå…­çº§ï¼‰');
        mdText.appendChild(document.createElement('br'));
        mdText.appendText('è½¬æ¢æ ‡ç­¾è¯­æ³•ã€ŒAlt+Shift+3ã€âˆ¶å°†é€‰æ–‡è½¬ä¸ºæˆ–å»é™¤ #æ ‡ç­¾ æ•ˆæœ');
        mdText.appendChild(document.createElement('br'));
        mdText.appendText('è½¬æ¢ç²—ä½“è¯­æ³•ã€ŒAlt+Cã€âˆ¶å°†é€‰æ–‡è½¬ä¸ºæˆ–å»é™¤ **ç²—ä½“** æ•ˆæœ');
        mdText.appendChild(document.createElement('br'));
        mdText.appendText('è½¬æ¢æ–œä½“è¯­æ³•ã€ŒAlt+Xã€âˆ¶å°†é€‰æ–‡è½¬ä¸ºæˆ–å»é™¤ *æ–œä½“* æ•ˆæœ');
        mdText.appendChild(document.createElement('br'));
        //mdText.appendText('è½¬æ¢è¡Œå†…ä»£ç ã€ŒAlt+Dã€âˆ¶å°†é€‰æ–‡è½¬ä¸ºæˆ–å»é™¤ `è¡Œå†…ä»£ç ` æ•ˆæœ');
        //mdText.appendChild(document.createElement('br'));
        mdText.appendText('è½¬æ¢åˆ é™¤çº¿ã€ŒAlt+Sã€âˆ¶å°†é€‰æ–‡è½¬ä¸ºæˆ–å»é™¤ ~~åˆ é™¤çº¿~~ æ•ˆæœ');
        mdText.appendChild(document.createElement('br'));
        mdText.appendText('è½¬æ¢ä¸‹åˆ’çº¿ã€ŒAlt+Hã€âˆ¶å°†é€‰æ–‡è½¬ä¸ºæˆ–å»é™¤ <u>ä¸‹åˆ’çº¿</u> æ•ˆæœ');
        mdText.appendChild(document.createElement('br'));
        mdText.appendText('è½¬æ¢ä»£ç å—ã€Œæœªè®¾ç½®ã€âˆ¶å°†é€‰æ–‡è½¬ä¸ºæˆ–å»é™¤ ```ä»£ç å—``` æ•ˆæœ');
        mdText.appendChild(document.createElement('br'));
        mdText.appendText('è½¬æ¢ä¸Šæ ‡è¯­æ³•ã€Œæœªè®¾ç½®ã€âˆ¶å°†é€‰æ–‡è½¬ä¸ºæˆ–å»é™¤ <sup>ä¸Šæ ‡</sup> æ•ˆæœ');
        mdText.appendChild(document.createElement('br'));
        mdText.appendText('è½¬æ¢ä¸‹æ ‡è¯­æ³•ã€Œæœªè®¾ç½®ã€âˆ¶å°†é€‰æ–‡è½¬ä¸ºæˆ–å»é™¤ <sub>ä¸‹æ ‡</sub> æ•ˆæœ');
        mdText.appendChild(document.createElement('br'));
        mdText.appendText('[[]]è½¬ä¸º[]()è¯­æ³•ã€Œæœªè®¾ç½®ã€âˆ¶å°†åˆ’é€‰æ–‡æœ¬ä¸­çš„[[å†…éƒ¨é“¾æ¥]]è¯­æ³•è½¬ä¸º[è¶…](é“¾æ¥)è¯­æ³•');
        mdText.appendChild(document.createElement('br'));
        mdText.appendText('[]()è½¬ä¸º[[]]è¯­æ³•ã€Œæœªè®¾ç½®ã€âˆ¶å°†åˆ’é€‰æ–‡æœ¬ä¸­çš„[è¶…](é“¾æ¥)è¯­æ³•è½¬ä¸º[[å†…éƒ¨é“¾æ¥]]è¯­æ³•');
        mdText.appendChild(document.createElement('br'));
        mdText.appendText('å»é™¤è¶…é“¾æ¥è¯­æ³•ã€Œæœªè®¾ç½®ã€âˆ¶å°†åˆ’é€‰æ–‡æœ¬ä¸­çš„[]()è¶…é“¾æ¥æ ·å¼æ¢å¤ä¸ºæ™®é€šæ–‡æœ¬ï¼Œå³åªä¿ç•™[]å†…çš„å†…å®¹');
        mdText.appendChild(document.createElement('br'));
        mdText.appendText('è½¬æ¢æ— è¯­æ³•æ–‡æœ¬ã€ŒCtrl+Alt+Zã€âˆ¶é¼ æ ‡ç‚¹å‡»æˆ–åˆ’é€‰æ–‡æœ¬çš„è¯­æ³•éƒ¨åˆ†ï¼Œå¯å»é™¤ç›¸åº”çš„MarkDownè¯­æ³•å­—ç¬¦');
        mdText.appendChild(document.createElement('br'));
        mdText.appendText('è·å–æ— è¯­æ³•æ–‡æœ¬ã€ŒCtrl+Alt+Cã€âˆ¶å»é™¤åˆ’é€‰æ–‡æœ¬ä¸­çš„æ‰€æœ‰MarkDownè¯­æ³•å­—ç¬¦ï¼Œå¹¶å†™å…¥å‰ªè´´æ¿');
        mdText.appendChild(document.createElement('br'));
        div1.appendChild(mdText);

        new obsidian.Setting(containerEl)
        .setName("ğŸ¥‘ æ˜¯å¦å¯ç”¨Blut topaz ä¸»é¢˜é«˜äº®é…è‰²æ”¯æŒ")
        .setDesc("å¯ç”¨æ­¤é¡¹åï¼Œå¯ä»¥ä½¿ç”¨MDè¯­æ³•çš„å¤šå½©é«˜äº®åˆ·ä»¥åŠä¸»é¢˜è‡ªå¸¦çš„æ¶‚é»‘å¡«ç©ºæ•ˆæœã€‚")
        .addToggle(toggle => toggle.setValue(this.plugin.settings?.isBT)
        .onChange((value) => {
        this.plugin.settings.isBT = value;
        this.plugin.saveSettings();
    }));

        new obsidian.Setting(containerEl)
            .setName('ğŸ“£ è®¾ç½®å½©è‰²æ–‡å­—æ•ˆæœï¼ˆHtmlè¯­æ³•ï¼‰åŠŸèƒ½ã€‚')
            .setDesc('ç‚¹å‡»é¢œè‰²å—è°ƒèŠ‚é¢œè‰²ï¼Œåœ¨ç¬”è®°ç¼–è¾‘åŒºåˆ’é€‰æ–‡æœ¬åæŒ‰ä¸‹ã€ŒCtrl+Shift+ 1-5ã€å¿«æ·é”®ï¼Œå³å¯è½¬ä¸ºç›¸åº”é¢œè‰²çš„æ–‡æœ¬ã€‚')

        const textColourPicker1 = containerEl.createEl("input", {
            type: "color",
        });
        textColourPicker1.value = this.plugin.settings?.hColor1;
        textColourPicker1.addEventListener("change", async () => {
            this.plugin.settings.hColor1 = textColourPicker1.value;
            await this.plugin.saveSettings();
        });

        const textColourPicker2 = containerEl.createEl("input", {
            type: "color",
        });
        textColourPicker2.value = this.plugin.settings?.hColor2;
        textColourPicker2.addEventListener("change", async () => {
            this.plugin.settings.hColor2 = textColourPicker2.value;
            await this.plugin.saveSettings();
        });
        
        const textColourPicker3 = containerEl.createEl("input", {
            type: "color",
        });
        textColourPicker3.value = this.plugin.settings?.hColor3;
        textColourPicker3.addEventListener("change", async () => {
            this.plugin.settings.hColor3 = textColourPicker3.value;
            await this.plugin.saveSettings();
        });

        const textColourPicker4 = containerEl.createEl("input", {
            type: "color",
        });
        textColourPicker4.value = this.plugin.settings?.hColor4;
        textColourPicker4.addEventListener("change", async () => {
            this.plugin.settings.hColor4 = textColourPicker4.value;
            await this.plugin.saveSettings();
        });

        const textColourPicker5 = containerEl.createEl("input", {
            type: "color",
        });
        textColourPicker5.value = this.plugin.settings?.hColor5;
        textColourPicker5.addEventListener("change", async () => {
            this.plugin.settings.hColor5 = textColourPicker5.value;
            await this.plugin.saveSettings();
        });

        /*
        new obsidian.Setting(containerEl)
        .setName('è½¬æ¢æ–‡å­—é¢œè‰²ã€ŒCtrl+Shift+1ã€')
        .setDesc('è®¾ç½®æ–‡å­—é¢œè‰²å€¼ï¼ˆ#000000ï¼‰')
        .addText(text => {
            text
                .setValue(this.plugin.settings.hColor1)
                .onChange((value) => {
                this.plugin.settings.hColor1 = value;
                this.plugin.saveSettings();
            });
        });
        */

        new obsidian.Setting(containerEl)
            .setName('ğŸ“£ è®¾ç½®å½©è‰²èƒŒæ™¯æ•ˆæœï¼ˆHtmlè¯­æ³•ï¼‰åŠŸèƒ½ã€‚')
            .setDesc('ç‚¹å‡»é¢œè‰²å—è°ƒèŠ‚é¢œè‰²ï¼Œåœ¨ç¬”è®°ç¼–è¾‘åŒºåˆ’é€‰æ–‡æœ¬åæŒ‰ä¸‹ã€ŒCtrl+Alt+ 1-5ã€å¿«æ·é”®ï¼Œå³å¯è½¬ä¸ºç›¸åº”èƒŒæ™¯é¢œè‰²çš„æ–‡æœ¬ã€‚')

        const heatmapColourPicker1 = containerEl.createEl("input", {
            type: "color",
        });
        heatmapColourPicker1.value = this.plugin.settings?.bColor1;
        heatmapColourPicker1.addEventListener("change", async () => {
            this.plugin.settings.bColor1 = heatmapColourPicker1.value;
            await this.plugin.saveSettings();
        });

        const heatmapColourPicker2 = containerEl.createEl("input", {
            type: "color",
        });
        heatmapColourPicker2.value = this.plugin.settings?.bColor2;
        heatmapColourPicker2.addEventListener("change", async () => {
            this.plugin.settings.bColor2 = heatmapColourPicker2.value;
            await this.plugin.saveSettings();
        });
        
        const heatmapColourPicker3 = containerEl.createEl("input", {
            type: "color",
        });
        heatmapColourPicker3.value = this.plugin.settings?.bColor3;
        heatmapColourPicker3.addEventListener("change", async () => {
            this.plugin.settings.bColor3 = heatmapColourPicker3.value;
            await this.plugin.saveSettings();
        });

        const heatmapColourPicker4 = containerEl.createEl("input", {
            type: "color",
        });
        heatmapColourPicker4.value = this.plugin.settings?.bColor4;
        heatmapColourPicker4.addEventListener("change", async () => {
            this.plugin.settings.bColor4 = heatmapColourPicker4.value;
            await this.plugin.saveSettings();
        });

        const heatmapColourPicker5 = containerEl.createEl("input", {
            type: "color",
        });
        heatmapColourPicker5.value= this.plugin.settings?.bColor5;
        heatmapColourPicker5.addEventListener("change", async () => {
            this.plugin.settings.bColor5 = heatmapColourPicker5.value;
            await this.plugin.saveSettings();
        });

        /*
        new obsidian.Setting(containerEl)
            .setName('è½¬æ¢èƒŒæ™¯é¢œè‰²ã€ŒCtrl+Alt+2ã€')
            .setDesc('è®¾ç½®èƒŒæ™¯é¢œè‰²å€¼ï¼ˆ#000000ï¼‰')
            .addText(text => {
                text
                    .setValue(this.plugin.settings.bColor2)
                    .onChange((value) => {
                    this.plugin.settings.bColor2 = value;
                    this.plugin.saveSettings();
                });
            });
        */
        new obsidian.Setting(containerEl)
            .setName('ğŸ“£ å·¦ä¾§çª—å£æ»šå±å¹…åº¦')
            .setDesc('æŒ‰ä¸‹ Alt+Shift+I +K å¿«æ·é”®å¯ä¸Šä¸‹æ»šåŠ¨å·¦ä¾§çª—å£ã€‚æ‹–åŠ¨æ»‘æ¡å¯è°ƒèŠ‚æ»šå±å¹…åº¦ï¼ˆåƒç´ å€¼ï¼‰ï¼š')
            .addSlider(slider => slider
                .setLimits(25, 900, 25)
                .setValue(this.plugin.settings?.maxScroll)
                .setDynamicTooltip()
                .onChange((value) => {
                this.plugin.settings.maxScroll = value;
                this.plugin.saveSettings();
            }));
        /*
        new obsidian.Setting(containerEl)
            .setName("ğŸ“£ åœ¨çŠ¶æ€æ æ˜¾ç¤º å†™ä½œè¿›åº¦ â†’ ç›®æ ‡å­—æ•°")
            .setDesc("å¯ç”¨æ­¤é¡¹åï¼Œåœ¨çŠ¶æ€æ æ˜¾ç¤ºå†™ä½œè¿›åº¦ã€‚æ‹–åŠ¨æ»‘æ¡å¯è°ƒèŠ‚ç›®æ ‡å­—æ•°ï¼š")
            .addToggle(toggle => toggle.setValue(this.plugin.settings.isShowNum)
                .onChange((value) => {
                this.plugin.settings.isShowNum = value;
                this.plugin.saveSettings();
            }))
            .addSlider(slider => slider
                .setLimits(100, 10000, 100)
                .setValue(this.plugin.settings.maxTry)
                .setDynamicTooltip()
                .onChange((value) => {
                this.plugin.settings.maxTry = value;
                this.plugin.saveSettings();
            }));

        */
        new obsidian.Setting(containerEl)
            .setName('ğŸ“£ è®¾ç½®å­—ç¬¦ã€æ ‡ç‚¹ã€çŠ¶æ€ç­‰è½¬æ¢åŠŸèƒ½ã€‚')

        var div3 = containerEl.createEl('p', {
            cls: 'recent-files-donation',
        });
        var charText = document.createDocumentFragment();
        charText.appendText('ä¿®å¤é”™è¯¯æ ‡ç‚¹ã€Œæœªè®¾ç½®ã€âˆ¶å°†ç¬”è®°ä¸­çš„æ±‰å­—ä¸­é—´çš„è‹±æ–‡æ ‡ç‚¹ä¿®å¤ä¸ºä¸­æ–‡æ ‡ç‚¹');
        charText.appendChild(document.createElement('br'));
        charText.appendText('ä¿®å¤é”™è¯¯è¯­æ³•ã€Œæœªè®¾ç½®ã€âˆ¶ä¿®å¤é”™è¯¯çš„MDè¯­æ³•ï¼Œå¦‚1ã€‚åˆ—è¡¨ã€ã€ã€‘ï¼ˆï¼‰é“¾æ¥ã€[[]]()å›é“¾ç­‰');
        charText.appendChild(document.createElement('br'));
        charText.appendText('è½¬æ¢è·¯å¾„è¯­æ³•ã€Œæœªè®¾ç½®ã€âˆ¶å°† c:\\windows ä¸ [](file:///c:\/windows) è·¯å¾„è¯­æ³•ç›¸äº’è½¬æ¢');
        charText.appendChild(document.createElement('br'));
        charText.appendText('ç®€ä½“è½¬ä¸ºç¹ä½“ã€Œæœªè®¾ç½®ã€ï¼šå°†ç¬”è®°ä¸­çš„ç®€ä½“æ±‰å­—è½¬æ¢ä¸ºç¹ä½“æ±‰å­—');
        charText.appendChild(document.createElement('br'));
        charText.appendText('ç¹ä½“è½¬ä¸ºç®€ä½“ã€Œæœªè®¾ç½®ã€ï¼šå°†ç¬”è®°ä¸­çš„ç¹ä½“æ±‰å­—è½¬æ¢ä¸ºç®€ä½“æ±‰å­—');
        charText.appendChild(document.createElement('br'));
        charText.appendText('åˆ—è¡¨è½¬ä¸ºå›¾ç¤ºã€Œæœªè®¾ç½®ã€ï¼šé€‰ä¸­åˆ—è¡¨æ–‡æœ¬ï¼Œè½¬æ¢ä¸ºç›¸åº”å±‚çº§çš„MerMaidè¯­æ³•å›¾ç¤ºï¼Œæ”¯æŒä¿®æ”¹åˆ—è¡¨åæ›´æ–°å›¾ç¤ºã€‚');
        charText.appendChild(document.createElement('br'));
        charText.appendText('è½¬æ¢å¾…åŠçŠ¶æ€ã€Œæœªè®¾ç½®ã€ï¼šè½¬æ¢é€‰æ–‡è¡Œé¦–çš„å¾…åŠçŠ¶æ€ï¼Œé¡ºåºä¸º -[ x-!?><+] æ•ˆæœ');
        charText.appendChild(document.createElement('br'));
        charText.appendText('è½¬æ¢å¡«ç©ºã€Œæœªè®¾ç½®ã€ï¼šå°†é€‰æ–‡è½¬ä¸ºæˆ–å»é™¤ {{c1::é€‰æ–‡}} æ•ˆæœ');
        charText.appendChild(document.createElement('br'));
        charText.appendText('ã€é€‰æ–‡ã€‘ã€Œæœªè®¾ç½®ã€ï¼šåœ¨é€‰æ–‡ä¸¤ç«¯æ·»åŠ æˆ–å»é™¤ ã€ã€‘ç¬¦å·');
        charText.appendChild(document.createElement('br'));
        charText.appendText('ï¼ˆé€‰æ–‡ï¼‰ã€Œæœªè®¾ç½®ã€ï¼šåœ¨é€‰æ–‡ä¸¤ç«¯æ·»åŠ æˆ–å»é™¤ ï¼ˆï¼‰ç¬¦å·');
        charText.appendChild(document.createElement('br'));
        charText.appendText('ã€Œé€‰æ–‡ã€ã€Œæœªè®¾ç½®ã€ï¼šåœ¨é€‰æ–‡ä¸¤ç«¯æ·»åŠ æˆ–å»é™¤ ã€Œã€ç¬¦å·');
        charText.appendChild(document.createElement('br'));
        charText.appendText('ã€Šé€‰æ–‡ã€‹ã€Œæœªè®¾ç½®ã€ï¼šåœ¨é€‰æ–‡ä¸¤ç«¯æ·»åŠ æˆ–å»é™¤ ã€Šã€‹ç¬¦å·');
        div3.appendChild(charText);

        new obsidian.Setting(containerEl)
            .setName('ğŸ“£ è®¾ç½®ä¿®å¤æ–­è¡Œã€é€‰æ‹©æ®µå¥ã€åµŒå…¥ç½‘é¡µç­‰åŠŸèƒ½ã€‚')

        var div4 = containerEl.createEl('p', {
            cls: 'recent-files-donation',
        });
        var toolText = document.createDocumentFragment();
        toolText.appendText('è®¡ç®—æ‰€é€‰ç»“æœã€ŒF9ã€âˆ¶è®¡ç®—æ‰€é€‰çš„å››åˆ™è¿ç®—å¼çš„ç»“æœï¼Œå¹¶å†™å…¥å‰ªè´´æ¿ä»¥å¤‡ç²˜è´´ã€‚');
        toolText.appendChild(document.createElement('br'));
        toolText.appendText('ä¿®å¤æ„å¤–æ–­è¡Œã€Œæœªè®¾ç½®ã€âˆ¶ä¿®å¤ç¬”è®°ä¸­çš„æ„å¤–æ–­è¡Œï¼ˆåˆ é™¤ç»“å°¾ä¸æ˜¯å¥å¼æ ‡ç‚¹çš„æ¢è¡Œç¬¦ï¼‰');
        toolText.appendChild(document.createElement('br'));
        toolText.appendText('æœç´¢å½“å‰æ–‡æœ¬ã€Œæœªè®¾ç½®ã€ï¼šé€šè¿‡æœç´¢é¢æ¿åœ¨å½“å‰æ–‡æ¡£ä¸­æœç´¢åˆ’é€‰å†…å®¹ã€‚');
        toolText.appendChild(document.createElement('br'));
        toolText.appendText('é€‰æ‹©å½“å‰æ•´æ®µã€Œæœªè®¾ç½®ã€ï¼šé€‰æ‹©å…‰æ ‡æ‰€åœ¨çš„å½“å‰æ•´æ®µæ–‡æœ¬ã€‚');
        toolText.appendChild(document.createElement('br'));
        toolText.appendText('é€‰æ‹©å½“å‰æ•´å¥ã€Œæœªè®¾ç½®ã€ï¼šé€‰æ‹©å…‰æ ‡æ‰€åœ¨çš„å½“å‰æ•´å¥ï¼ˆä¸­æ–‡ï¼‰æ–‡æœ¬ã€‚');
        toolText.appendChild(document.createElement('br'));
        toolText.appendText('é€‰æ‹©å½“å‰è¯­æ³•ã€ŒAlt+Shift+Kã€ï¼šé€‰æ‹©å…‰æ ‡æ‰€åœ¨çš„å½“å‰MrakDownè¯­æ³•ï¼ˆå¦‚åŠ ç²—ã€é«˜äº®ã€åˆ é™¤ã€é“¾æ¥ç­‰æ•ˆæœï¼‰æ–‡æœ¬ã€‚');
        toolText.appendChild(document.createElement('br'));
        toolText.appendText('è·å–æ ‡æ³¨æ–‡æœ¬ã€Œæœªè®¾ç½®ã€âˆ¶è·å–æ ‡é¢˜ã€é«˜äº®ã€æ³¨é‡ŠåŠå‰ç¼€(#æ ‡æ³¨\æ‰¹æ³¨\åæ€)ç­‰æ–‡æœ¬å†…å®¹');
        toolText.appendChild(document.createElement('br'));
        toolText.appendText('è·å–å½“å‰å­—ç¬¦æ•°ã€Œæœªè®¾ç½®ã€âˆ¶è®¡ç®—å½“å‰ç¬”è®°ä¸­å¯è§å­—ç¬¦ï¼ˆæ±‰å­—ã€å­—æ¯ã€æ•°å­—ã€æ ‡ç‚¹ï¼‰ä¸ªæ•°å’Œä¸å¯è§å­—ç¬¦ï¼ˆç©ºæ ¼ã€æ¢è¡Œç¬¦ï¼‰ä¸ªæ•°');
        toolText.appendChild(document.createElement('br'));
        toolText.appendText('è‡ªåŠ¨è®¾ç½®æ ‡é¢˜ã€Œæœªè®¾ç½®ã€âˆ¶å°†é€‰æ–‡ä¸­çš„å•è¡Œæ–‡æœ¬ï¼ˆæœ«å°¾éæ ‡ç‚¹æˆ–æ•°å­—ï¼‰è½¬ä¸ºæ ‡é¢˜');
        toolText.appendChild(document.createElement('br'));
        toolText.appendText('æŒ‡å®šå½“å‰æ–‡ä»¶åã€Œæœªè®¾ç½®ã€ï¼šåˆ’é€‰æ–‡å­—åæŒ‡å®šä¸ºå½“å‰ç¬”è®°çš„æ–‡ä»¶åã€‚');
        toolText.appendChild(document.createElement('br'));
        toolText.appendText('åµŒå…¥å½“å‰ç½‘å€é¡µé¢ã€Œæœªè®¾ç½®ã€âˆ¶åœ¨è¡Œæœ«æ’å…¥iframeä»£ç æ¥åµŒå…¥æ‰€é€‰ç½‘å€é¡µé¢');
        toolText.appendChild(document.createElement('br'));
        toolText.appendText('è·å–ç›¸å¯¹è·¯å¾„ã€Œæœªè®¾ç½®ã€ï¼šè·å–å½“å‰ç¬”è®°åœ¨åº“ç›®å½•å†…çš„ç›¸å¯¹è·¯å¾„ã€‚');
        toolText.appendChild(document.createElement('br'));
        div4.appendChild(toolText);


        new obsidian.Setting(containerEl)
            .setName('ğŸ“£ è®¾ç½®æŠ˜å æ ‡é¢˜ã€å¢å‡ç©ºè¡Œæˆ–ç©ºæ ¼ç­‰åŠŸèƒ½ã€‚')

        var div5 = containerEl.createEl('p', {
            cls: 'recent-files-donation',
        });
        var lineText = document.createDocumentFragment();
        lineText.appendText('æŠ˜å åŒçº§æ ‡é¢˜ã€ŒCtrl+Shift+Alt+Dã€âˆ¶åˆ¤æ–­å½“å‰è¡Œçš„æ ‡é¢˜å±‚çº§ï¼Œå°†æ­£æ–‡ä¸­åŒçº§æ ‡é¢˜ä¸€æ¬¡æ€§æŠ˜å èµ·æ¥ã€‚');
        lineText.appendChild(document.createElement('br'));
        lineText.appendText('åˆ é™¤å½“å‰æ®µè½ã€ŒCtrl+Dã€âˆ¶å»é™¤å½“å‰æ®µè½æ–‡æœ¬;è‹¥åœ¨[[]]å†…ä¼šå…ˆåˆ é™¤é“¾æ¥å†…å®¹;å½“é‡æœ‰åºåˆ—è¡¨é¡¹æ—¶ä¼šæ­£å¸¸è°ƒå°åé¢åºå·ã€‚');
        lineText.appendChild(document.createElement('br'));
        lineText.appendText('æ’å…¥æœ‰æ•ˆç©ºè¡Œã€ŒCtrl+Shift+Alt+Enterã€âˆ¶æ’å…¥å¸¦æœ‰å…¨è§’ç©ºæ ¼çš„ç©ºç™½è¡Œï¼Œä¿è¯æ¸²æŸ“æ—¶å æ®ä¸€è¡Œã€‚');
        lineText.appendChild(document.createElement('br'));
        lineText.appendText('ç©ºæ ¼è½¬ä¸ºç©ºè¡Œã€Œæœªè®¾ç½®ã€âˆ¶å°†ä¸¤ä¸ªæ±‰å­—ä¸­é—´çš„ç©ºæ ¼æˆ–åˆ¶è¡¨ç¬¦è½¬ä¸ºç©ºç™½è¡Œ');
        lineText.appendChild(document.createElement('br'));
        lineText.appendText('æ‰¹é‡æ’å…¥ç©ºè¡Œã€ŒCtrl+Shift+Lã€âˆ¶åœ¨åˆ’é€‰çš„æ–‡æœ¬è¡Œæˆ–å…¨æ–‡ä¸­é—´æ‰¹é‡æ’å…¥ç©ºç™½è¡Œ');
        lineText.appendChild(document.createElement('br'));
        lineText.appendText('æ‰¹é‡å»é™¤ç©ºè¡Œã€ŒCtrl+Alt+Lã€âˆ¶æ‰¹é‡å»é™¤åˆ’é€‰æ–‡æœ¬æˆ–å…¨æ–‡ä¸­çš„ç©ºç™½è¡Œ');
        lineText.appendChild(document.createElement('br'));
        lineText.appendText('ä¸Šæ–¹æ’å…¥ç©ºè¡Œã€Œæœªè®¾ç½®ã€âˆ¶åœ¨å½“å‰æ–‡æœ¬è¡Œçš„ä¸Šè¡Œæ’å…¥ç©ºç™½è¡Œ');
        lineText.appendChild(document.createElement('br'));
        lineText.appendText('ä¸‹æ–¹æ’å…¥ç©ºè¡Œã€Œæœªè®¾ç½®ã€âˆ¶åœ¨å½“å‰æ–‡æœ¬è¡Œçš„ä¸‹è¡Œæ’å…¥ç©ºç™½è¡Œ');
        lineText.appendChild(document.createElement('br'));
        lineText.appendText('è¡Œé¦–ç¼©è¿›ä¸¤å­—ç¬¦ã€Œæœªè®¾ç½®ã€âˆ¶åœ¨æ¯è¡Œæ–‡æœ¬çš„è¡Œé¦–æ·»åŠ ä¸¤ä¸ªå…¨è§’ç©ºæ ¼ï¼Œäº§ç”Ÿç¼©è¿›æ•ˆæœã€‚');
        lineText.appendChild(document.createElement('br'));
        lineText.appendText('è¡Œé¦–æ·»åŠ ç©ºæ ¼ã€Œæœªè®¾ç½®ã€âˆ¶åœ¨æ¯è¡Œæ–‡æœ¬çš„è¡Œé¦–æ·»åŠ ä¸¤ä¸ªç©ºæ ¼');
        lineText.appendChild(document.createElement('br'));
        lineText.appendText('å»é™¤è¡Œé¦–ç©ºæ ¼ã€Œæœªè®¾ç½®ã€âˆ¶æ‰¹é‡å»é™¤æ¯è¡Œæ–‡æœ¬çš„è¡Œé¦–ç©ºæ ¼å­—ç¬¦');
        lineText.appendChild(document.createElement('br'));
        lineText.appendText('æœ«å°¾è¿½åŠ ç©ºæ ¼ã€Œæœªè®¾ç½®ã€âˆ¶åœ¨æ¯è¡Œæ–‡æœ¬çš„æœ«å°¾è¿½åŠ ä¸¤ä¸ªç©ºæ ¼');
        lineText.appendChild(document.createElement('br'));
        lineText.appendText('å»é™¤æœ«å°¾ç©ºæ ¼ã€Œæœªè®¾ç½®ã€âˆ¶æ‰¹é‡å»é™¤æ¯è¡Œæ–‡æœ¬çš„æœ«å°¾ç©ºæ ¼å­—ç¬¦');
        lineText.appendChild(document.createElement('br'));
        lineText.appendText('æ·»åŠ é—´éš”ç©ºæ ¼ã€Œæœªè®¾ç½®ã€ï¼šåœ¨æ­£æ–‡çš„æ±‰å­—ä¸å­—æ¯ä¹‹é—´æ‰¹é‡æ·»åŠ ç©ºæ ¼ï¼Œå¦‚ china ä¸­å›½ã€‚');
        lineText.appendChild(document.createElement('br'));
        lineText.appendText('å»é™¤æ‰€æœ‰ç©ºæ ¼ã€Œæœªè®¾ç½®ã€ï¼šå»é™¤æ­£æ–‡ä¸­æ‰€æœ‰çš„å…¨ã€åŠè§’ç©ºæ ¼');
        lineText.appendChild(document.createElement('br'));
        div5.appendChild(lineText);

        var div6 = containerEl.createEl('p', {
            cls: 'recent-files-donation',
        });
        var qqText = document.createDocumentFragment();
        qqText.appendChild(document.createElement('br'));
        qqText.appendText('ğŸ†— æ¬¢è¿å¤§å®¶å‘èš•å­(QQ:312815311) æå‡ºæ“ä½œéœ€æ±‚å’Œå»ºè®®ï¼Œæˆ‘ä»¬æ¥å…±åŒå¢å¼ºç¼–è¾‘åŠŸèƒ½ï¼');
        qqText.appendChild(document.createElement('br'));
        qqText.appendText('ğŸ†— æ„Ÿè°¢Cuman(QQ:35669852)çš„æŒ‡å¯¼ä¸è°ƒè¯•ã€‚');
        div6.appendChild(qqText);
    };
};

module.exports = MyPlugin;
